==================== 2026-02-09T11:31:02.307834Z | 019c422b-5605-7971-a7d3-b57c726e163f ====================
11:31:02.313221 [info ]: Installing dbt project and profile setup
11:31:02.352881 [info ]: Info Created .vscode/extensions.json with dbt extension recommendation
11:31:02.354728 [info ]: Success Project created successfully!
11:31:02.354906 [info ]: Info Project name: jaffle_shop
11:31:02.354946 [info ]: Info Project directory: jaffle_shop
11:31:02.354975 [info ]: Info Setting up your profile...
11:31:02.357193 [info ]: Loading ~/.dbt/profiles.yml
11:31:02.359652 [info ]: Info Creating new profile...
11:32:21.829894 [info ]: Found dbt_cloud.yml configuration
11:32:27.171165 [error]: dbt1001: Failed to get project selection: IO error: read interrupted
11:32:27.274734 [info ]: 
==================== Execution Summary =====================
Finished 'init' with 1 error [1m 25s]
[0m13:11:27.293289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3f0ac6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3f2380cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3efaffc50>]}


============================== 13:11:27.299384 | 0112383c-0731-4bb0-9143-55612c7c86a1 ==============================
[0m13:11:27.299384 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:11:27.301512 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'use_colors': 'True', 'debug': 'False', 'log_path': 'logs', 'indirect_selection': 'eager', 'printer_width': '80', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'quiet': 'False', 'empty': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'target_path': 'None', 'warn_error': 'None'}
[0m13:11:27.320126 [info ] [MainThread]: dbt version: 1.11.3
[0m13:11:27.320959 [info ] [MainThread]: python version: 3.13.12
[0m13:11:27.321756 [info ] [MainThread]: python path: /home/bihitche/Desktop/crypto_pipeline_sprint/.venv/bin/python
[0m13:11:27.322490 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m13:11:27.535220 [info ] [MainThread]: Using profiles dir at /home/bihitche/.dbt
[0m13:11:27.535911 [info ] [MainThread]: Using profiles.yml file at /home/bihitche/.dbt/profiles.yml
[0m13:11:27.536522 [info ] [MainThread]: Using dbt_project.yml file at /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/dbt_project.yml
[0m13:11:27.538589 [info ] [MainThread]: adapter type: duckdb
[0m13:11:27.539166 [info ] [MainThread]: adapter version: 1.10.0
[0m13:11:27.539911 [info ] [MainThread]: Configuration:
[0m13:11:27.540767 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:11:27.541604 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m13:11:27.542346 [info ] [MainThread]: Required dependencies:
[0m13:11:27.543242 [debug] [MainThread]: Executing "git --help"
[0m13:11:27.549623 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:11:27.550569 [debug] [MainThread]: STDERR: "b''"
[0m13:11:27.551354 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:11:27.552139 [info ] [MainThread]: Connection:
[0m13:11:27.552948 [info ] [MainThread]:   database: crypto_db
[0m13:11:27.553898 [info ] [MainThread]:   schema: main
[0m13:11:27.554668 [info ] [MainThread]:   path: md:crypto_db
[0m13:11:27.555420 [info ] [MainThread]:   config_options: None
[0m13:11:27.556350 [info ] [MainThread]:   extensions: None
[0m13:11:27.557103 [info ] [MainThread]:   settings: {}
[0m13:11:27.557847 [info ] [MainThread]:   external_root: .
[0m13:11:27.558589 [info ] [MainThread]:   use_credential_provider: None
[0m13:11:27.560170 [info ] [MainThread]:   attach: None
[0m13:11:27.560976 [info ] [MainThread]:   filesystems: None
[0m13:11:27.562595 [info ] [MainThread]:   remote: None
[0m13:11:27.563416 [info ] [MainThread]:   plugins: [{'module': 'motherduck', 'alias': None, 'config': None}]
[0m13:11:27.564201 [info ] [MainThread]:   disable_transactions: False
[0m13:11:27.565234 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:11:27.722525 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m13:11:27.767276 [debug] [MainThread]: Using duckdb connection "debug"
[0m13:11:27.768463 [debug] [MainThread]: On debug: select 1 as id
[0m13:11:27.769390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:40.777783 [debug] [MainThread]: SQL status: OK in 13.008 seconds
[0m13:11:40.779990 [debug] [MainThread]: On debug: Close
[0m13:11:40.780947 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:11:40.781962 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:11:40.782789 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/bihitche/Desktop/crypto_pipeline_sprint/analytics/dbt_project.yml> not found

[0m13:11:40.784690 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 13.668881, "process_in_blocks": "464", "process_kernel_time": 0.46262, "process_mem_max_rss": "176860", "process_out_blocks": "16", "process_user_time": 4.121981}
[0m13:11:40.786239 [debug] [MainThread]: Command `dbt debug` failed at 13:11:40.786043 after 13.67 seconds
[0m13:11:40.786995 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:11:40.788119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3ef90b360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3ef8e7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b3ef921150>]}
[0m13:11:40.789508 [debug] [MainThread]: Flushing usage events
[0m13:11:41.530497 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:02.107655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb355ed2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb357780e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb354f0bb10>]}


============================== 13:13:02.111611 | 64520fea-4ca5-4970-9de8-86d50a5f76c7 ==============================
[0m13:13:02.111611 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:13:02.112778 [debug] [MainThread]: running dbt with arguments {'log_path': 'logs', 'invocation_command': 'dbt debug', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'empty': 'None', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'target_path': 'None', 'indirect_selection': 'eager'}
[0m13:13:02.124170 [info ] [MainThread]: dbt version: 1.11.3
[0m13:13:02.124841 [info ] [MainThread]: python version: 3.13.12
[0m13:13:02.125373 [info ] [MainThread]: python path: /home/bihitche/Desktop/crypto_pipeline_sprint/.venv/bin/python
[0m13:13:02.126005 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m13:13:02.324801 [info ] [MainThread]: Using profiles dir at /home/bihitche/.dbt
[0m13:13:02.325797 [info ] [MainThread]: Using profiles.yml file at /home/bihitche/.dbt/profiles.yml
[0m13:13:02.326857 [info ] [MainThread]: Using dbt_project.yml file at /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/dbt_project.yml
[0m13:13:02.329618 [info ] [MainThread]: adapter type: duckdb
[0m13:13:02.330535 [info ] [MainThread]: adapter version: 1.10.0
[0m13:13:02.331546 [info ] [MainThread]: Configuration:
[0m13:13:02.332896 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:13:02.333667 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m13:13:02.334364 [info ] [MainThread]: Required dependencies:
[0m13:13:02.334991 [debug] [MainThread]: Executing "git --help"
[0m13:13:02.339180 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:13:02.340263 [debug] [MainThread]: STDERR: "b''"
[0m13:13:02.341047 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:13:02.341829 [info ] [MainThread]: Connection:
[0m13:13:02.342626 [info ] [MainThread]:   database: crypto_db
[0m13:13:02.343505 [info ] [MainThread]:   schema: main
[0m13:13:02.344465 [info ] [MainThread]:   path: md:crypto_db
[0m13:13:02.345390 [info ] [MainThread]:   config_options: None
[0m13:13:02.346193 [info ] [MainThread]:   extensions: None
[0m13:13:02.347097 [info ] [MainThread]:   settings: {}
[0m13:13:02.347959 [info ] [MainThread]:   external_root: .
[0m13:13:02.348876 [info ] [MainThread]:   use_credential_provider: None
[0m13:13:02.349594 [info ] [MainThread]:   attach: None
[0m13:13:02.350254 [info ] [MainThread]:   filesystems: None
[0m13:13:02.350950 [info ] [MainThread]:   remote: None
[0m13:13:02.351645 [info ] [MainThread]:   plugins: [{'module': 'motherduck', 'alias': None, 'config': None}]
[0m13:13:02.352479 [info ] [MainThread]:   disable_transactions: False
[0m13:13:02.353438 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:13:02.518959 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m13:13:02.549641 [debug] [MainThread]: Using duckdb connection "debug"
[0m13:13:02.550177 [debug] [MainThread]: On debug: select 1 as id
[0m13:13:02.550648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:30.026217 [debug] [MainThread]: SQL status: OK in 27.475 seconds
[0m13:13:30.028806 [debug] [MainThread]: On debug: Close
[0m13:13:30.030174 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:13:30.030971 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:13:30.032156 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/bihitche/Desktop/crypto_pipeline_sprint/analytics/dbt_project.yml> not found

[0m13:13:30.034613 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 28.011574, "process_in_blocks": "1800", "process_kernel_time": 0.435567, "process_mem_max_rss": "176684", "process_out_blocks": "24", "process_user_time": 3.479569}
[0m13:13:30.036150 [debug] [MainThread]: Command `dbt debug` failed at 13:13:30.035884 after 28.01 seconds
[0m13:13:30.037372 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:13:30.038782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb354d23230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb354cf7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb354b35150>]}
[0m13:13:30.040231 [debug] [MainThread]: Flushing usage events
[0m13:13:30.788850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:14:47.583039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216803bacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721681cc4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72167f3f3c50>]}


============================== 13:14:47.587714 | ce840437-426a-49f3-b56a-fcbdb24816b8 ==============================
[0m13:14:47.587714 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:14:47.588818 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'quiet': 'False', 'invocation_command': 'dbt debug', 'empty': 'None', 'version_check': 'True', 'warn_error': 'None', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'target_path': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'printer_width': '80'}
[0m13:14:47.602673 [info ] [MainThread]: dbt version: 1.11.3
[0m13:14:47.603638 [info ] [MainThread]: python version: 3.13.12
[0m13:14:47.604526 [info ] [MainThread]: python path: /home/bihitche/Desktop/crypto_pipeline_sprint/.venv/bin/python
[0m13:14:47.605373 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m13:14:47.877089 [info ] [MainThread]: Using profiles dir at /home/bihitche/.dbt
[0m13:14:47.878027 [info ] [MainThread]: Using profiles.yml file at /home/bihitche/.dbt/profiles.yml
[0m13:14:47.878871 [info ] [MainThread]: Using dbt_project.yml file at /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/dbt_project.yml
[0m13:14:47.881545 [info ] [MainThread]: adapter type: duckdb
[0m13:14:47.882415 [info ] [MainThread]: adapter version: 1.10.0
[0m13:14:48.124710 [info ] [MainThread]: Configuration:
[0m13:14:48.125393 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:14:48.126183 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:14:48.126913 [info ] [MainThread]: Required dependencies:
[0m13:14:48.127654 [debug] [MainThread]: Executing "git --help"
[0m13:14:48.131043 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:14:48.132091 [debug] [MainThread]: STDERR: "b''"
[0m13:14:48.132928 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:14:48.133834 [info ] [MainThread]: Connection:
[0m13:14:48.134635 [info ] [MainThread]:   database: crypto_db
[0m13:14:48.135453 [info ] [MainThread]:   schema: main
[0m13:14:48.136346 [info ] [MainThread]:   path: md:crypto_db
[0m13:14:48.137184 [info ] [MainThread]:   config_options: None
[0m13:14:48.137997 [info ] [MainThread]:   extensions: None
[0m13:14:48.138871 [info ] [MainThread]:   settings: {}
[0m13:14:48.139743 [info ] [MainThread]:   external_root: .
[0m13:14:48.140562 [info ] [MainThread]:   use_credential_provider: None
[0m13:14:48.141444 [info ] [MainThread]:   attach: None
[0m13:14:48.142303 [info ] [MainThread]:   filesystems: None
[0m13:14:48.143154 [info ] [MainThread]:   remote: None
[0m13:14:48.144013 [info ] [MainThread]:   plugins: [{'module': 'motherduck', 'alias': None, 'config': None}]
[0m13:14:48.144935 [info ] [MainThread]:   disable_transactions: False
[0m13:14:48.146039 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:14:48.344831 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m13:14:48.381191 [debug] [MainThread]: Using duckdb connection "debug"
[0m13:14:48.381684 [debug] [MainThread]: On debug: select 1 as id
[0m13:14:48.382151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:15:01.471494 [debug] [MainThread]: SQL status: OK in 13.089 seconds
[0m13:15:01.476747 [debug] [MainThread]: On debug: Close
[0m13:15:01.479211 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:15:01.481408 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:15:01.485151 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 14.006659, "process_in_blocks": "0", "process_kernel_time": 0.38339, "process_mem_max_rss": "178636", "process_out_blocks": "24", "process_user_time": 3.625777}
[0m13:15:01.488951 [debug] [MainThread]: Command `dbt debug` succeeded at 13:15:01.488220 after 14.01 seconds
[0m13:15:01.492062 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:15:01.495224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72167979a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216804eb2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7216797a9480>]}
[0m13:15:01.497577 [debug] [MainThread]: Flushing usage events
[0m13:15:02.233345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:46.628381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7072041b6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707205ac0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7072031f3c50>]}


============================== 13:18:46.635003 | c99842dc-3160-4695-a635-a4c81f1f3bfa ==============================
[0m13:18:46.635003 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:18:46.635839 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt run', 'debug': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'warn_error': 'None', 'log_cache_events': 'False'}
[0m13:18:46.995936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c99842dc-3160-4695-a635-a4c81f1f3bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707203ed75c0>]}
[0m13:18:47.115053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c99842dc-3160-4695-a635-a4c81f1f3bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7072032ad260>]}
[0m13:18:47.117072 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:18:47.256559 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m13:18:47.257556 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:18:47.258239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c99842dc-3160-4695-a635-a4c81f1f3bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707203103850>]}
[0m13:18:49.074128 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.crypto_analytics.products' (models/marts/products.sql) depends on a node named 'stg_products' which was not found
[0m13:18:49.075564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5327182, "process_in_blocks": "5984", "process_kernel_time": 0.304427, "process_mem_max_rss": "149156", "process_out_blocks": "16", "process_user_time": 3.98151}
[0m13:18:49.076339 [debug] [MainThread]: Command `dbt run` failed at 13:18:49.076185 after 2.53 seconds
[0m13:18:49.077183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7071efe0da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7071efe0e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707203207e70>]}
[0m13:18:49.077965 [debug] [MainThread]: Flushing usage events
[0m13:18:49.927272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:19:02.141902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34fdedaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34ff870e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34fcf1bb10>]}


============================== 23:19:02.145911 | 20ae88ee-ed7d-4b2a-9fbc-e36cca75311d ==============================
[0m23:19:02.145911 [info ] [MainThread]: Running with dbt=1.11.3
[0m23:19:02.147115 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'profiles_dir': '/home/bihitche/.dbt', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'no_print': 'None', 'introspect': 'True', 'empty': 'None', 'target_path': 'None', 'invocation_command': 'dbt ', 'warn_error': 'None', 'log_format': 'default'}
[0m23:19:02.323958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20ae88ee-ed7d-4b2a-9fbc-e36cca75311d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34fdbfb490>]}
[0m23:19:02.355744 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:19:02.356790 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:19:02.358449 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.30958802, "process_in_blocks": "520", "process_kernel_time": 0.258733, "process_mem_max_rss": "106176", "process_out_blocks": "192", "process_user_time": 2.014139}
[0m23:19:02.359677 [debug] [MainThread]: Command `cli deps` succeeded at 23:19:02.359445 after 0.31 seconds
[0m23:19:02.360626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34fcb64d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34fcb65150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a34fcf96f50>]}
[0m23:19:02.361539 [debug] [MainThread]: Flushing usage events
[0m23:19:03.215800 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:58.179567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc1fe2c6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc1ffbd8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc1fd303c50>]}


============================== 23:38:58.183879 | f9adbdd4-c47e-40ab-84e0-c586959c5278 ==============================
[0m23:38:58.183879 [info ] [MainThread]: Running with dbt=1.11.3
[0m23:38:58.184779 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'quiet': 'False', 'no_print': 'None', 'empty': 'None', 'partial_parse': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'version_check': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m23:38:58.373043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9adbdd4-c47e-40ab-84e0-c586959c5278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc1fdfe75c0>]}
[0m23:38:58.387795 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:38:58.389009 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:38:58.390574 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.30025378, "process_in_blocks": "0", "process_kernel_time": 0.228483, "process_mem_max_rss": "106192", "process_out_blocks": "8", "process_user_time": 1.899708}
[0m23:38:58.391708 [debug] [MainThread]: Command `cli deps` succeeded at 23:38:58.391543 after 0.30 seconds
[0m23:38:58.392568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc1fd0fc9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc1fd0fd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc1fd37fe50>]}
[0m23:38:58.393428 [debug] [MainThread]: Flushing usage events
[0m23:38:59.251210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:39:32.137761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5d2cbaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5d4618cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5d1cf7c50>]}


============================== 23:39:32.141765 | 402fce9a-bf8e-498f-afca-6d130d3e9ec6 ==============================
[0m23:39:32.141765 [info ] [MainThread]: Running with dbt=1.11.3
[0m23:39:32.142809 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'empty': 'None', 'static_parser': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'version_check': 'True', 'warn_error': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'introspect': 'True', 'no_print': 'None', 'target_path': 'None', 'invocation_command': 'dbt '}
[0m23:39:32.319421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '402fce9a-bf8e-498f-afca-6d130d3e9ec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5d29db5c0>]}
[0m23:39:32.332903 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:39:32.334160 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:39:32.335622 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.30723625, "process_in_blocks": "0", "process_kernel_time": 0.218487, "process_mem_max_rss": "106304", "process_out_blocks": "8", "process_user_time": 1.937459}
[0m23:39:32.336557 [debug] [MainThread]: Command `cli deps` succeeded at 23:39:32.336341 after 0.31 seconds
[0m23:39:32.337372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5d1b049e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5d1b05040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5d1d73e50>]}
[0m23:39:32.338441 [debug] [MainThread]: Flushing usage events
[0m23:39:33.168286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:50:40.721387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a43cdacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a4565ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a42d1bc50>]}


============================== 23:50:40.726160 | 8089f3d5-5f14-488b-be3f-248097aeacec ==============================
[0m23:50:40.726160 [info ] [MainThread]: Running with dbt=1.11.3
[0m23:50:40.727486 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'write_json': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'partial_parse': 'True', 'target_path': 'None', 'profiles_dir': '/home/bihitche/.dbt', 'version_check': 'True', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'debug': 'False'}
[0m23:50:41.173627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8089f3d5-5f14-488b-be3f-248097aeacec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a439f76f0>]}
[0m23:50:41.311151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8089f3d5-5f14-488b-be3f-248097aeacec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a42dcd260>]}
[0m23:50:41.313239 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:50:41.501972 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m23:50:41.605821 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:50:41.606529 [debug] [MainThread]: previous checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, current checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9
[0m23:50:41.607215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8089f3d5-5f14-488b-be3f-248097aeacec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a42c22e50>]}
[0m23:50:43.469016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_analytics.marts
- seeds.crypto_analytics
[0m23:50:43.484921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8089f3d5-5f14-488b-be3f-248097aeacec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a3c70aa80>]}
[0m23:50:43.647005 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m23:50:43.650492 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m23:50:43.717214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8089f3d5-5f14-488b-be3f-248097aeacec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a3c1e98d0>]}
[0m23:50:43.718490 [info ] [MainThread]: Found 1 model, 1 source, 472 macros
[0m23:50:43.719542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8089f3d5-5f14-488b-be3f-248097aeacec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a3c6da4e0>]}
[0m23:50:43.723334 [info ] [MainThread]: 
[0m23:50:43.724538 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m23:50:43.725694 [info ] [MainThread]: 
[0m23:50:43.727012 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:50:43.730417 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_db'
[0m23:50:43.829918 [debug] [ThreadPool]: Using duckdb connection "list_crypto_db"
[0m23:50:43.830751 [debug] [ThreadPool]: On list_crypto_db: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_db"'
    
  
  
[0m23:50:43.831766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:08.846859 [debug] [ThreadPool]: SQL status: OK in 25.015 seconds
[0m23:51:08.849191 [debug] [ThreadPool]: On list_crypto_db: Close
[0m23:51:08.850377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_db, now create_crypto_db_main)
[0m23:51:08.851182 [debug] [ThreadPool]: Creating schema "database: "crypto_db"
schema: "main"
"
[0m23:51:08.859697 [debug] [ThreadPool]: Using duckdb connection "create_crypto_db_main"
[0m23:51:08.860326 [debug] [ThreadPool]: On create_crypto_db_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_db'
        and type='sqlite'
    
  
[0m23:51:08.860959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:08.863493 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:51:08.865488 [debug] [ThreadPool]: Using duckdb connection "create_crypto_db_main"
[0m23:51:08.866151 [debug] [ThreadPool]: On create_crypto_db_main: BEGIN
[0m23:51:08.867878 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:51:08.868494 [debug] [ThreadPool]: Using duckdb connection "create_crypto_db_main"
[0m23:51:08.869067 [debug] [ThreadPool]: On create_crypto_db_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_db_main"} */

    
    
        create schema if not exists "crypto_db"."main"
    
[0m23:51:08.901583 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m23:51:08.902997 [debug] [ThreadPool]: On create_crypto_db_main: COMMIT
[0m23:51:08.903671 [debug] [ThreadPool]: Using duckdb connection "create_crypto_db_main"
[0m23:51:08.904239 [debug] [ThreadPool]: On create_crypto_db_main: COMMIT
[0m23:51:08.936341 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m23:51:08.937047 [debug] [ThreadPool]: On create_crypto_db_main: Close
[0m23:51:08.939052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_db_main, now list_crypto_db_main)
[0m23:51:08.946958 [debug] [ThreadPool]: Using duckdb connection "list_crypto_db_main"
[0m23:51:08.947614 [debug] [ThreadPool]: On list_crypto_db_main: BEGIN
[0m23:51:08.948211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:08.950248 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:51:08.950965 [debug] [ThreadPool]: Using duckdb connection "list_crypto_db_main"
[0m23:51:08.951555 [debug] [ThreadPool]: On list_crypto_db_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_db_main"} */
select
      'crypto_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_db'
  
[0m23:51:08.987122 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m23:51:08.990082 [debug] [ThreadPool]: On list_crypto_db_main: ROLLBACK
[0m23:51:08.993217 [debug] [ThreadPool]: Failed to rollback 'list_crypto_db_main'
[0m23:51:08.994556 [debug] [ThreadPool]: On list_crypto_db_main: Close
[0m23:51:08.996898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8089f3d5-5f14-488b-be3f-248097aeacec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a2ee6c350>]}
[0m23:51:08.998196 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:08.999132 [debug] [MainThread]: On master: BEGIN
[0m23:51:09.000322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:09.003355 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:51:09.005283 [debug] [MainThread]: On master: COMMIT
[0m23:51:09.007593 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:09.008721 [debug] [MainThread]: On master: COMMIT
[0m23:51:09.011945 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:51:09.012847 [debug] [MainThread]: On master: Close
[0m23:51:09.019539 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m23:51:09.020835 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg__prices ................................... [RUN]
[0m23:51:09.021974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_db_main, now model.crypto_analytics.stg__prices)
[0m23:51:09.022890 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m23:51:09.032571 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m23:51:09.033748 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m23:51:09.102021 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m23:51:09.103998 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m23:51:09.105223 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m23:51:09.106379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:09.109695 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:51:09.111366 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m23:51:09.113117 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_db"."main"."stg__prices__dbt_tmp" as (
    with source as (
    select * from "crypto_db"."staging"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        name,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h,
        _dlt_load_id as load_id, -- Keep audit columns!
        current_timestamp as ingested_at
    from source
)

select * from renamed
  );

[0m23:51:09.170351 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_db"."main"."stg__prices__dbt_tmp" as (
    with source as (
    select * from "crypto_db"."staging"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        name,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h,
        _dlt_load_id as load_id, -- Keep audit columns!
        current_timestamp as ingested_at
    from source
)

select * from renamed
  );

[0m23:51:09.171634 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:51:09.173224 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: ROLLBACK
[0m23:51:09.187323 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_analytics.stg__prices'
[0m23:51:09.188364 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m23:51:09.197487 [debug] [Thread-1 (]: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Catalog Error: Table with name raw_prices does not exist!
  Did you mean "crypto_raw.raw_prices"?
  
  LINE 6:     select * from "crypto_db"."staging"."raw_prices"
                            ^
[0m23:51:09.201305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8089f3d5-5f14-488b-be3f-248097aeacec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a2ed2c5d0>]}
[0m23:51:09.202683 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg__prices .......................... [[31mERROR[0m in 0.18s]
[0m23:51:09.204200 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m23:51:09.205587 [debug] [Thread-7 (]: Marking all children of 'model.crypto_analytics.stg__prices' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Catalog Error: Table with name raw_prices does not exist!
  Did you mean "crypto_raw.raw_prices"?
  
  LINE 6:     select * from "crypto_db"."staging"."raw_prices"
                            ^.
[0m23:51:09.209341 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:09.210390 [debug] [MainThread]: On master: BEGIN
[0m23:51:09.211369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:09.214042 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:51:09.215009 [debug] [MainThread]: On master: COMMIT
[0m23:51:09.215916 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:09.216822 [debug] [MainThread]: On master: COMMIT
[0m23:51:09.218405 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:51:09.219061 [debug] [MainThread]: On master: Close
[0m23:51:09.219970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:09.220614 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m23:51:09.221318 [info ] [MainThread]: 
[0m23:51:09.222098 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 25.49 seconds (25.49s).
[0m23:51:09.223289 [debug] [MainThread]: Command end result
[0m23:51:09.270061 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m23:51:09.273633 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m23:51:09.284937 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m23:51:09.285837 [info ] [MainThread]: 
[0m23:51:09.286887 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:51:09.287856 [info ] [MainThread]: 
[0m23:51:09.289035 [error] [MainThread]: [31mFailure in model stg__prices (models/staging/stg__prices.sql)[0m
[0m23:51:09.290163 [error] [MainThread]:   Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Catalog Error: Table with name raw_prices does not exist!
  Did you mean "crypto_raw.raw_prices"?
  
  LINE 6:     select * from "crypto_db"."staging"."raw_prices"
                            ^
[0m23:51:09.291113 [info ] [MainThread]: 
[0m23:51:09.292138 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics/models/staging/stg__prices.sql
[0m23:51:09.293100 [info ] [MainThread]: 
[0m23:51:09.294076 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:51:09.295755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 28.679047, "process_in_blocks": "8160", "process_kernel_time": 0.439094, "process_mem_max_rss": "195852", "process_out_blocks": "3112", "process_user_time": 6.430101}
[0m23:51:09.296914 [debug] [MainThread]: Command `dbt run` failed at 23:51:09.296686 after 28.68 seconds
[0m23:51:09.297890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a2f956a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a2ed188c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795a3c482250>]}
[0m23:51:09.298972 [debug] [MainThread]: Flushing usage events
[0m23:51:10.185876 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:58:11.657630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e1e03dacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e1e1c58cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e1df41bc50>]}


============================== 23:58:11.664141 | 0c997308-d277-464f-80d5-7d3929a67162 ==============================
[0m23:58:11.664141 [info ] [MainThread]: Running with dbt=1.11.3
[0m23:58:11.665349 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'None', 'version_check': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'write_json': 'True', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt debug --config-dir', 'use_colors': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'profiles_dir': '/home/bihitche/.dbt', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False'}
[0m23:58:11.681798 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/bihitche/.dbt
[0m23:58:11.683331 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.12952091, "process_in_blocks": "56", "process_kernel_time": 0.187392, "process_mem_max_rss": "103172", "process_out_blocks": "16", "process_user_time": 1.725408}
[0m23:58:11.684477 [debug] [MainThread]: Command `dbt debug` succeeded at 23:58:11.684260 after 0.13 seconds
[0m23:58:11.685204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e1df2949d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e1df4d3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e1df4cf460>]}
[0m23:58:11.686267 [debug] [MainThread]: Flushing usage events
[0m23:58:12.492027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:02:45.416672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760991cbacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760993604cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760990cfbc50>]}


============================== 00:02:45.421045 | 699523d6-c07b-48e3-9637-dbf294b6c567 ==============================
[0m00:02:45.421045 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:02:45.422153 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'profiles_dir': '/home/bihitche/.dbt', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'invocation_command': 'dbt debug'}
[0m00:02:45.434655 [info ] [MainThread]: dbt version: 1.11.3
[0m00:02:45.435395 [info ] [MainThread]: python version: 3.13.12
[0m00:02:45.436208 [info ] [MainThread]: python path: /home/bihitche/Desktop/crypto_pipeline_sprint/.venv/bin/python
[0m00:02:45.437090 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m00:02:45.682506 [info ] [MainThread]: Using profiles dir at /home/bihitche/.dbt
[0m00:02:45.683228 [info ] [MainThread]: Using profiles.yml file at /home/bihitche/.dbt/profiles.yml
[0m00:02:45.683878 [info ] [MainThread]: Using dbt_project.yml file at /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/dbt_project.yml
[0m00:02:45.685736 [info ] [MainThread]: adapter type: duckdb
[0m00:02:45.686343 [info ] [MainThread]: adapter version: 1.10.0
[0m00:02:45.928571 [info ] [MainThread]: Configuration:
[0m00:02:45.930163 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:02:45.931579 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:02:45.933092 [info ] [MainThread]: Required dependencies:
[0m00:02:45.934553 [debug] [MainThread]: Executing "git --help"
[0m00:02:45.941941 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:02:45.942967 [debug] [MainThread]: STDERR: "b''"
[0m00:02:45.943742 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:02:45.946755 [info ] [MainThread]: Connection:
[0m00:02:45.950978 [info ] [MainThread]:   database: crypto_db
[0m00:02:45.951782 [info ] [MainThread]:   schema: main
[0m00:02:45.953645 [info ] [MainThread]:   path: md:crypto_db
[0m00:02:45.957947 [info ] [MainThread]:   config_options: None
[0m00:02:45.958742 [info ] [MainThread]:   extensions: None
[0m00:02:45.960930 [info ] [MainThread]:   settings: {}
[0m00:02:45.965227 [info ] [MainThread]:   external_root: .
[0m00:02:45.967092 [info ] [MainThread]:   use_credential_provider: None
[0m00:02:45.968017 [info ] [MainThread]:   attach: None
[0m00:02:45.971983 [info ] [MainThread]:   filesystems: None
[0m00:02:45.972879 [info ] [MainThread]:   remote: None
[0m00:02:45.974304 [info ] [MainThread]:   plugins: [{'module': 'motherduck', 'alias': None, 'config': None}]
[0m00:02:45.976325 [info ] [MainThread]:   disable_transactions: False
[0m00:02:45.977961 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:02:46.230142 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m00:02:46.285147 [debug] [MainThread]: Using duckdb connection "debug"
[0m00:02:46.285842 [debug] [MainThread]: On debug: select 1 as id
[0m00:02:46.286448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:05.429137 [debug] [MainThread]: SQL status: OK in 19.143 seconds
[0m00:03:05.431369 [debug] [MainThread]: On debug: Close
[0m00:03:05.432430 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:03:05.433310 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:03:05.434967 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 20.120869, "process_in_blocks": "40", "process_kernel_time": 0.440196, "process_mem_max_rss": "178032", "process_out_blocks": "32", "process_user_time": 3.637363}
[0m00:03:05.435991 [debug] [MainThread]: Command `dbt debug` succeeded at 00:03:05.435807 after 20.12 seconds
[0m00:03:05.436723 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:03:05.437482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7609909be520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760991ddb2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7609909d9480>]}
[0m00:03:05.438476 [debug] [MainThread]: Flushing usage events
[0m00:03:06.279253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:05:20.516692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fd7ace2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fd7c558cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fd79d23c50>]}


============================== 00:05:20.521527 | dfc5a38b-3337-476f-ab11-94d9dab3a3ce ==============================
[0m00:05:20.521527 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:05:20.522639 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'static_parser': 'True', 'empty': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'quiet': 'False', 'log_format': 'default', 'fail_fast': 'False', 'debug': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'indirect_selection': 'eager', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'use_colors': 'True'}
[0m00:05:20.538659 [info ] [MainThread]: dbt version: 1.11.3
[0m00:05:20.539499 [info ] [MainThread]: python version: 3.13.12
[0m00:05:20.540199 [info ] [MainThread]: python path: /home/bihitche/Desktop/crypto_pipeline_sprint/.venv/bin/python
[0m00:05:20.540890 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m00:05:20.758413 [info ] [MainThread]: Using profiles dir at /home/bihitche/.dbt
[0m00:05:20.759108 [info ] [MainThread]: Using profiles.yml file at /home/bihitche/.dbt/profiles.yml
[0m00:05:20.759753 [info ] [MainThread]: Using dbt_project.yml file at /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/dbt_project.yml
[0m00:05:20.761564 [info ] [MainThread]: adapter type: duckdb
[0m00:05:20.762193 [info ] [MainThread]: adapter version: 1.10.0
[0m00:05:20.955565 [info ] [MainThread]: Configuration:
[0m00:05:20.956234 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:05:20.956961 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:05:20.957513 [info ] [MainThread]: Required dependencies:
[0m00:05:20.958117 [debug] [MainThread]: Executing "git --help"
[0m00:05:20.961217 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:05:20.962106 [debug] [MainThread]: STDERR: "b''"
[0m00:05:20.962952 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:05:20.963849 [info ] [MainThread]: Connection:
[0m00:05:20.964748 [info ] [MainThread]:   database: crypto_db
[0m00:05:20.965519 [info ] [MainThread]:   schema: main
[0m00:05:20.966205 [info ] [MainThread]:   path: md:crypto_db
[0m00:05:20.967038 [info ] [MainThread]:   config_options: None
[0m00:05:20.967795 [info ] [MainThread]:   extensions: None
[0m00:05:20.968555 [info ] [MainThread]:   settings: {}
[0m00:05:20.969295 [info ] [MainThread]:   external_root: .
[0m00:05:20.969921 [info ] [MainThread]:   use_credential_provider: None
[0m00:05:20.970774 [info ] [MainThread]:   attach: None
[0m00:05:20.971655 [info ] [MainThread]:   filesystems: None
[0m00:05:20.972442 [info ] [MainThread]:   remote: None
[0m00:05:20.973338 [info ] [MainThread]:   plugins: [{'module': 'motherduck', 'alias': None, 'config': None}]
[0m00:05:20.974109 [info ] [MainThread]:   disable_transactions: False
[0m00:05:20.975102 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:05:21.139189 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m00:05:21.182270 [debug] [MainThread]: Using duckdb connection "debug"
[0m00:05:21.182813 [debug] [MainThread]: On debug: select 1 as id
[0m00:05:21.183274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:05:22.416365 [debug] [MainThread]: SQL status: OK in 1.233 seconds
[0m00:05:22.418916 [debug] [MainThread]: On debug: Close
[0m00:05:22.420242 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:05:22.421686 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:05:22.425283 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.020814, "process_in_blocks": "1736", "process_kernel_time": 0.402905, "process_mem_max_rss": "177660", "process_out_blocks": "16", "process_user_time": 3.699945}
[0m00:05:22.427496 [debug] [MainThread]: Command `dbt debug` succeeded at 00:05:22.427005 after 2.02 seconds
[0m00:05:22.429112 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:05:22.430978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fd799ea520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fd7ae172f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fd79a01480>]}
[0m00:05:22.432792 [debug] [MainThread]: Flushing usage events
[0m00:05:23.288726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:37:45.457255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71edac3d6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71edadc54e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71edab413b10>]}


============================== 00:37:45.462082 | 5d082a16-7a33-4729-85c8-e38413c5fd86 ==============================
[0m00:37:45.462082 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:37:45.463023 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'empty': 'False', 'introspect': 'True', 'target_path': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'profiles_dir': '/home/bihitche/.dbt', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'invocation_command': 'dbt run', 'version_check': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default'}
[0m00:37:45.952196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d082a16-7a33-4729-85c8-e38413c5fd86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71edac0f35c0>]}
[0m00:37:46.085275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d082a16-7a33-4729-85c8-e38413c5fd86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71edab4c9260>]}
[0m00:37:46.087546 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:37:46.280282 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m00:37:46.431238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:37:46.431873 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:37:46.432349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:37:46.440297 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_analytics.marts
- seeds.crypto_analytics
[0m00:37:46.501302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d082a16-7a33-4729-85c8-e38413c5fd86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eda55d1450>]}
[0m00:37:46.655021 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m00:37:46.658422 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m00:37:46.676508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d082a16-7a33-4729-85c8-e38413c5fd86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71edab416f30>]}
[0m00:37:46.677306 [info ] [MainThread]: Found 1 model, 1 source, 472 macros
[0m00:37:46.677927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d082a16-7a33-4729-85c8-e38413c5fd86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eda4c989f0>]}
[0m00:37:46.680817 [info ] [MainThread]: 
[0m00:37:46.681674 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m00:37:46.682234 [info ] [MainThread]: 
[0m00:37:46.683195 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:37:46.685042 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_db'
[0m00:37:46.768236 [debug] [ThreadPool]: Using duckdb connection "list_crypto_db"
[0m00:37:46.772242 [debug] [ThreadPool]: On list_crypto_db: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_db"'
    
  
  
[0m00:37:46.774364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:48.141375 [debug] [ThreadPool]: SQL status: OK in 1.367 seconds
[0m00:37:48.148343 [debug] [ThreadPool]: On list_crypto_db: Close
[0m00:37:48.151891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_db, now create_crypto_db_main)
[0m00:37:48.154521 [debug] [ThreadPool]: Creating schema "database: "crypto_db"
schema: "main"
"
[0m00:37:48.182681 [debug] [ThreadPool]: Using duckdb connection "create_crypto_db_main"
[0m00:37:48.184653 [debug] [ThreadPool]: On create_crypto_db_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_db'
        and type='sqlite'
    
  
[0m00:37:48.187234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:37:48.192283 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m00:37:48.196499 [debug] [ThreadPool]: Using duckdb connection "create_crypto_db_main"
[0m00:37:48.197607 [debug] [ThreadPool]: On create_crypto_db_main: BEGIN
[0m00:37:48.201156 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:37:48.202771 [debug] [ThreadPool]: Using duckdb connection "create_crypto_db_main"
[0m00:37:48.204655 [debug] [ThreadPool]: On create_crypto_db_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_db_main"} */

    
    
        create schema if not exists "crypto_db"."main"
    
[0m00:37:48.242164 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m00:37:48.243749 [debug] [ThreadPool]: On create_crypto_db_main: COMMIT
[0m00:37:48.244445 [debug] [ThreadPool]: Using duckdb connection "create_crypto_db_main"
[0m00:37:48.245072 [debug] [ThreadPool]: On create_crypto_db_main: COMMIT
[0m00:37:48.278440 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m00:37:48.279213 [debug] [ThreadPool]: On create_crypto_db_main: Close
[0m00:37:48.281391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_db_main, now list_crypto_db_main)
[0m00:37:48.296071 [debug] [ThreadPool]: Using duckdb connection "list_crypto_db_main"
[0m00:37:48.296682 [debug] [ThreadPool]: On list_crypto_db_main: BEGIN
[0m00:37:48.297190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:37:48.299139 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:37:48.299773 [debug] [ThreadPool]: Using duckdb connection "list_crypto_db_main"
[0m00:37:48.300303 [debug] [ThreadPool]: On list_crypto_db_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_db_main"} */
select
      'crypto_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_db'
  
[0m00:37:48.326729 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m00:37:48.328393 [debug] [ThreadPool]: On list_crypto_db_main: ROLLBACK
[0m00:37:48.332361 [debug] [ThreadPool]: Failed to rollback 'list_crypto_db_main'
[0m00:37:48.332992 [debug] [ThreadPool]: On list_crypto_db_main: Close
[0m00:37:48.334266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d082a16-7a33-4729-85c8-e38413c5fd86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ed97f218b0>]}
[0m00:37:48.335120 [debug] [MainThread]: Using duckdb connection "master"
[0m00:37:48.335647 [debug] [MainThread]: On master: BEGIN
[0m00:37:48.336222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:37:48.338188 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:37:48.338957 [debug] [MainThread]: On master: COMMIT
[0m00:37:48.339502 [debug] [MainThread]: Using duckdb connection "master"
[0m00:37:48.339986 [debug] [MainThread]: On master: COMMIT
[0m00:37:48.340976 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:37:48.341538 [debug] [MainThread]: On master: Close
[0m00:37:48.345683 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m00:37:48.346641 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg__prices ................................... [RUN]
[0m00:37:48.347479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_db_main, now model.crypto_analytics.stg__prices)
[0m00:37:48.348490 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m00:37:48.359160 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m00:37:48.360167 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m00:37:48.505205 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m00:37:48.506308 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m00:37:48.506932 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m00:37:48.507498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:48.509202 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:37:48.509837 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m00:37:48.510427 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_db"."main"."stg__prices__dbt_tmp" as (
    with source as (
    select * from "crypto_db"."staging"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        name,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h,
        _dlt_load_id as load_id, -- Keep audit columns!
        current_timestamp as ingested_at
    from source
)

select * from renamed
  );

[0m00:37:48.545385 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_db"."main"."stg__prices__dbt_tmp" as (
    with source as (
    select * from "crypto_db"."staging"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        name,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h,
        _dlt_load_id as load_id, -- Keep audit columns!
        current_timestamp as ingested_at
    from source
)

select * from renamed
  );

[0m00:37:48.546051 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:37:48.546769 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: ROLLBACK
[0m00:37:48.557135 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_analytics.stg__prices'
[0m00:37:48.558748 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m00:37:48.570520 [debug] [Thread-1 (]: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Catalog Error: Table with name raw_prices does not exist!
  Did you mean "crypto_raw.raw_prices"?
  
  LINE 6:     select * from "crypto_db"."staging"."raw_prices"
                            ^
[0m00:37:48.573280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d082a16-7a33-4729-85c8-e38413c5fd86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eda5798f50>]}
[0m00:37:48.574286 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg__prices .......................... [[31mERROR[0m in 0.22s]
[0m00:37:48.575307 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m00:37:48.576153 [debug] [Thread-7 (]: Marking all children of 'model.crypto_analytics.stg__prices' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Catalog Error: Table with name raw_prices does not exist!
  Did you mean "crypto_raw.raw_prices"?
  
  LINE 6:     select * from "crypto_db"."staging"."raw_prices"
                            ^.
[0m00:37:48.578668 [debug] [MainThread]: Using duckdb connection "master"
[0m00:37:48.579193 [debug] [MainThread]: On master: BEGIN
[0m00:37:48.579736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:37:48.581907 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:37:48.582726 [debug] [MainThread]: On master: COMMIT
[0m00:37:48.583394 [debug] [MainThread]: Using duckdb connection "master"
[0m00:37:48.584054 [debug] [MainThread]: On master: COMMIT
[0m00:37:48.585362 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:37:48.586138 [debug] [MainThread]: On master: Close
[0m00:37:48.586980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:48.587617 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m00:37:48.588275 [info ] [MainThread]: 
[0m00:37:48.589017 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m00:37:48.590343 [debug] [MainThread]: Command end result
[0m00:37:48.633552 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m00:37:48.636630 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m00:37:48.647114 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m00:37:48.648019 [info ] [MainThread]: 
[0m00:37:48.649007 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:37:48.649910 [info ] [MainThread]: 
[0m00:37:48.650911 [error] [MainThread]: [31mFailure in model stg__prices (models/staging/stg__prices.sql)[0m
[0m00:37:48.651896 [error] [MainThread]:   Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Catalog Error: Table with name raw_prices does not exist!
  Did you mean "crypto_raw.raw_prices"?
  
  LINE 6:     select * from "crypto_db"."staging"."raw_prices"
                            ^
[0m00:37:48.652706 [info ] [MainThread]: 
[0m00:37:48.653599 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics/models/staging/stg__prices.sql
[0m00:37:48.654420 [info ] [MainThread]: 
[0m00:37:48.655524 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:37:48.656989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3350198, "process_in_blocks": "73646", "process_kernel_time": 0.503006, "process_mem_max_rss": "188708", "process_out_blocks": "1984", "process_user_time": 5.072985}
[0m00:37:48.658047 [debug] [MainThread]: Command `dbt run` failed at 00:37:48.657844 after 3.34 seconds
[0m00:37:48.658879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eda4cb73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eda57f6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71eda57f5db0>]}
[0m00:37:48.659774 [debug] [MainThread]: Flushing usage events
[0m00:37:49.208849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:45:42.714452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f206adecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f208464cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f205b1bc50>]}


============================== 00:45:42.718813 | 14714f95-7f78-4557-852b-fd6f03da92ca ==============================
[0m00:45:42.718813 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:45:42.719994 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'invocation_command': 'dbt build', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'fail_fast': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'warn_error': 'None', 'no_print': 'None', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False'}
[0m00:45:43.082881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14714f95-7f78-4557-852b-fd6f03da92ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f2067fb6f0>]}
[0m00:45:43.195234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14714f95-7f78-4557-852b-fd6f03da92ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f205bd1260>]}
[0m00:45:43.197349 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:45:43.352607 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m00:45:43.445863 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:45:43.446603 [debug] [MainThread]: previous checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, current checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9
[0m00:45:43.447209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '14714f95-7f78-4557-852b-fd6f03da92ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f205a26e50>]}
[0m00:45:45.208208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_analytics.marts
- seeds.crypto_analytics
[0m00:45:45.227794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14714f95-7f78-4557-852b-fd6f03da92ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f1ff5135c0>]}
[0m00:45:45.414328 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m00:45:45.417417 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m00:45:45.638598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14714f95-7f78-4557-852b-fd6f03da92ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f1fe3de350>]}
[0m00:45:45.639724 [info ] [MainThread]: Found 1 model, 1 source, 472 macros
[0m00:45:45.643686 [info ] [MainThread]: 
[0m00:45:45.644696 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m00:45:45.645631 [info ] [MainThread]: 
[0m00:45:45.646994 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:45:45.650047 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_db'
[0m00:45:45.740188 [debug] [ThreadPool]: Using duckdb connection "list_crypto_db"
[0m00:45:45.742446 [debug] [ThreadPool]: On list_crypto_db: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_db"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_db"'
    
  
  
[0m00:45:45.744806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:45:46.926698 [debug] [ThreadPool]: SQL status: OK in 1.182 seconds
[0m00:45:46.929663 [debug] [ThreadPool]: On list_crypto_db: Close
[0m00:45:46.931080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_db, now create_crypto_db_main)
[0m00:45:46.932162 [debug] [ThreadPool]: Creating schema "database: "crypto_db"
schema: "main"
"
[0m00:45:46.944924 [debug] [ThreadPool]: Using duckdb connection "create_crypto_db_main"
[0m00:45:46.945821 [debug] [ThreadPool]: On create_crypto_db_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_db_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_db'
        and type='sqlite'
    
  
[0m00:45:46.946617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:45:46.949746 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:45:46.952687 [debug] [ThreadPool]: Using duckdb connection "create_crypto_db_main"
[0m00:45:46.953507 [debug] [ThreadPool]: On create_crypto_db_main: BEGIN
[0m00:45:46.955582 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:45:46.956408 [debug] [ThreadPool]: Using duckdb connection "create_crypto_db_main"
[0m00:45:46.957210 [debug] [ThreadPool]: On create_crypto_db_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_db_main"} */

    
    
        create schema if not exists "crypto_db"."main"
    
[0m00:45:46.991036 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m00:45:46.992948 [debug] [ThreadPool]: On create_crypto_db_main: COMMIT
[0m00:45:46.993819 [debug] [ThreadPool]: Using duckdb connection "create_crypto_db_main"
[0m00:45:46.994626 [debug] [ThreadPool]: On create_crypto_db_main: COMMIT
[0m00:45:47.026448 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m00:45:47.027407 [debug] [ThreadPool]: On create_crypto_db_main: Close
[0m00:45:47.029947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_db_main, now list_crypto_db_main)
[0m00:45:47.040946 [debug] [ThreadPool]: Using duckdb connection "list_crypto_db_main"
[0m00:45:47.041799 [debug] [ThreadPool]: On list_crypto_db_main: BEGIN
[0m00:45:47.043803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:45:47.046252 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:45:47.047181 [debug] [ThreadPool]: Using duckdb connection "list_crypto_db_main"
[0m00:45:47.048052 [debug] [ThreadPool]: On list_crypto_db_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_db_main"} */
select
      'crypto_db' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_db'
  
[0m00:45:47.083974 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m00:45:47.086748 [debug] [ThreadPool]: On list_crypto_db_main: ROLLBACK
[0m00:45:47.088754 [debug] [ThreadPool]: Failed to rollback 'list_crypto_db_main'
[0m00:45:47.089709 [debug] [ThreadPool]: On list_crypto_db_main: Close
[0m00:45:47.091518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14714f95-7f78-4557-852b-fd6f03da92ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f1ff2e8530>]}
[0m00:45:47.092294 [debug] [MainThread]: Using duckdb connection "master"
[0m00:45:47.093159 [debug] [MainThread]: On master: BEGIN
[0m00:45:47.094079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:45:47.099857 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m00:45:47.100822 [debug] [MainThread]: On master: COMMIT
[0m00:45:47.101706 [debug] [MainThread]: Using duckdb connection "master"
[0m00:45:47.102203 [debug] [MainThread]: On master: COMMIT
[0m00:45:47.103689 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:45:47.104561 [debug] [MainThread]: On master: Close
[0m00:45:47.107861 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m00:45:47.109119 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg__prices ................................... [RUN]
[0m00:45:47.110084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_db_main, now model.crypto_analytics.stg__prices)
[0m00:45:47.111153 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m00:45:47.121266 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m00:45:47.122200 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m00:45:47.185404 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m00:45:47.187044 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m00:45:47.188111 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m00:45:47.189183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:45:47.194895 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:45:47.195925 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m00:45:47.196995 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_db"."main"."stg__prices__dbt_tmp" as (
    select
    id as coin_id,
    symbol,
    current_price as usd_price,
    price_change_percentage_24h as daily_change,
    updated_at as ingested_at
from "crypto_db"."crypto_raw"."fetch_coins" 
-- referencing the source we defined above
  );

[0m00:45:47.238092 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_db"."main"."stg__prices__dbt_tmp" as (
    select
    id as coin_id,
    symbol,
    current_price as usd_price,
    price_change_percentage_24h as daily_change,
    updated_at as ingested_at
from "crypto_db"."crypto_raw"."fetch_coins" 
-- referencing the source we defined above
  );

[0m00:45:47.239550 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:45:47.240895 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: ROLLBACK
[0m00:45:47.253778 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_analytics.stg__prices'
[0m00:45:47.255061 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m00:45:47.264416 [debug] [Thread-1 (]: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Catalog Error: Table with name fetch_coins does not exist!
  Did you mean "_dlt_version"?
  
  LINE 11: from "crypto_db"."crypto_raw"."fetch_coins" 
                ^
[0m00:45:47.267429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14714f95-7f78-4557-852b-fd6f03da92ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f1fe2bdb50>]}
[0m00:45:47.268884 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg__prices .......................... [[31mERROR[0m in 0.16s]
[0m00:45:47.270758 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m00:45:47.272101 [debug] [Thread-7 (]: Marking all children of 'model.crypto_analytics.stg__prices' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Catalog Error: Table with name fetch_coins does not exist!
  Did you mean "_dlt_version"?
  
  LINE 11: from "crypto_db"."crypto_raw"."fetch_coins" 
                ^.
[0m00:45:47.275023 [debug] [MainThread]: Using duckdb connection "master"
[0m00:45:47.276005 [debug] [MainThread]: On master: BEGIN
[0m00:45:47.276995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:45:47.279606 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:45:47.280540 [debug] [MainThread]: On master: COMMIT
[0m00:45:47.281472 [debug] [MainThread]: Using duckdb connection "master"
[0m00:45:47.282419 [debug] [MainThread]: On master: COMMIT
[0m00:45:47.284070 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:45:47.285014 [debug] [MainThread]: On master: Close
[0m00:45:47.285965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:45:47.286761 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m00:45:47.287561 [info ] [MainThread]: 
[0m00:45:47.288407 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m00:45:47.290003 [debug] [MainThread]: Command end result
[0m00:45:47.345527 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m00:45:47.349230 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m00:45:47.361021 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m00:45:47.362347 [info ] [MainThread]: 
[0m00:45:47.363360 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:45:47.364901 [info ] [MainThread]: 
[0m00:45:47.366509 [error] [MainThread]: [31mFailure in model stg__prices (models/staging/stg__prices.sql)[0m
[0m00:45:47.368430 [error] [MainThread]:   Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Catalog Error: Table with name fetch_coins does not exist!
  Did you mean "_dlt_version"?
  
  LINE 11: from "crypto_db"."crypto_raw"."fetch_coins" 
                ^
[0m00:45:47.371529 [info ] [MainThread]: 
[0m00:45:47.373154 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics/models/staging/stg__prices.sql
[0m00:45:47.374573 [info ] [MainThread]: 
[0m00:45:47.376067 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:45:47.379366 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.7594495, "process_in_blocks": "2264", "process_kernel_time": 0.438647, "process_mem_max_rss": "213308", "process_out_blocks": "4192", "process_user_time": 5.862924}
[0m00:45:47.380559 [debug] [MainThread]: Command `dbt build` failed at 00:45:47.380310 after 4.76 seconds
[0m00:45:47.381615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f1fe28dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f1fe2f9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71f1fe2fba70>]}
[0m00:45:47.383934 [debug] [MainThread]: Flushing usage events
[0m00:45:48.191441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:48:43.041505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c2620c6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c2639c8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c2610ffb10>]}


============================== 00:48:43.046567 | 1273af31-bc43-470a-ad7e-0285ae2ce5c9 ==============================
[0m00:48:43.046567 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:48:43.047599 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'fail_fast': 'False', 'quiet': 'False', 'use_colors': 'True', 'static_parser': 'True', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'partial_parse': 'True', 'profiles_dir': '/home/bihitche/.dbt'}
[0m00:48:43.624139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1273af31-bc43-470a-ad7e-0285ae2ce5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c261de35c0>]}
[0m00:48:43.774153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1273af31-bc43-470a-ad7e-0285ae2ce5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c2611b9260>]}
[0m00:48:43.777728 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:48:43.979222 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m00:48:44.108443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:48:44.109480 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg__prices.sql
[0m00:48:44.490334 [error] [MainThread]: Encountered an error:
Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  source() takes exactly two arguments (1 given)
[0m00:48:44.492055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.618643, "process_in_blocks": "1096", "process_kernel_time": 0.433664, "process_mem_max_rss": "144684", "process_out_blocks": "8", "process_user_time": 4.330772}
[0m00:48:44.503397 [debug] [MainThread]: Command `dbt run` failed at 00:48:44.503121 after 1.63 seconds
[0m00:48:44.504515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c25abc5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c25abc5c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c25a9a58b0>]}
[0m00:48:44.505231 [debug] [MainThread]: Flushing usage events
[0m00:48:45.189911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:48:56.565141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739bf33dacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739bf4c50cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739bf241bc50>]}


============================== 00:48:56.569145 | 02f14534-fb70-4552-9b9d-fd7d19687407 ==============================
[0m00:48:56.569145 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:48:56.570190 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'invocation_command': 'dbt build', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'log_format': 'default', 'profiles_dir': '/home/bihitche/.dbt', 'introspect': 'True', 'empty': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'use_colors': 'True'}
[0m00:48:56.921645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02f14534-fb70-4552-9b9d-fd7d19687407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739bf30f76f0>]}
[0m00:48:57.039962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02f14534-fb70-4552-9b9d-fd7d19687407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739bf24cd260>]}
[0m00:48:57.042099 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m00:48:57.187476 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m00:48:57.299525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:48:57.300378 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg__prices.sql
[0m00:48:57.612546 [error] [MainThread]: Encountered an error:
Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  source() takes exactly two arguments (1 given)
[0m00:48:57.613759 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.1372801, "process_in_blocks": "0", "process_kernel_time": 0.311132, "process_mem_max_rss": "144756", "process_out_blocks": "8", "process_user_time": 2.716427}
[0m00:48:57.622420 [debug] [MainThread]: Command `dbt build` failed at 00:48:57.622210 after 1.15 seconds
[0m00:48:57.623246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739bec5d1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739bec5d1c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739bec0c17c0>]}
[0m00:48:57.624054 [debug] [MainThread]: Flushing usage events
[0m00:48:58.395183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:20:19.527698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770b8efdeba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770b90860cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770b8e01bc50>]}


============================== 05:20:19.532286 | fe0b663a-9fcd-47a1-906e-20fe640b7c47 ==============================
[0m05:20:19.532286 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:20:19.533594 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'debug': 'False', 'printer_width': '80', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'write_json': 'True', 'no_print': 'None', 'empty': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs'}
[0m05:20:19.733015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe0b663a-9fcd-47a1-906e-20fe640b7c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770b8ecfb5c0>]}
[0m05:20:19.749447 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:20:19.751253 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:20:19.752743 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.32079777, "process_in_blocks": "432", "process_kernel_time": 0.219208, "process_mem_max_rss": "106304", "process_out_blocks": "16", "process_user_time": 2.111381}
[0m05:20:19.753799 [debug] [MainThread]: Command `cli deps` succeeded at 05:20:19.753594 after 0.32 seconds
[0m05:20:19.754542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770b8dc4c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770b8dc4d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770b8e097e50>]}
[0m05:20:19.755285 [debug] [MainThread]: Flushing usage events
[0m05:20:20.600760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:21:10.024681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73c46d6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73c5f84e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73c370bb10>]}


============================== 05:21:10.030627 | 437c8f28-9301-4b4a-83e8-19d7acf430ea ==============================
[0m05:21:10.030627 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:21:10.031862 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'invocation_command': 'dbt build', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'no_print': 'None', 'target_path': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'printer_width': '80', 'empty': 'False', 'version_check': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True'}
[0m05:21:10.455960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '437c8f28-9301-4b4a-83e8-19d7acf430ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73c43f3490>]}
[0m05:21:10.598707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '437c8f28-9301-4b4a-83e8-19d7acf430ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73c37c9260>]}
[0m05:21:10.600968 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:21:10.830259 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m05:21:10.976280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:21:10.977060 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m05:21:10.977599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:21:10.992013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m05:21:11.050680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '437c8f28-9301-4b4a-83e8-19d7acf430ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73bd1c5450>]}
[0m05:21:11.190785 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m05:21:11.194924 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m05:21:11.238286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '437c8f28-9301-4b4a-83e8-19d7acf430ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73c370ef30>]}
[0m05:21:11.239504 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m05:21:11.243594 [info ] [MainThread]: 
[0m05:21:11.244508 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m05:21:11.245286 [info ] [MainThread]: 
[0m05:21:11.246368 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:21:11.248139 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m05:21:11.486286 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m05:21:11.488820 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m05:21:11.490139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:21:30.086011 [debug] [ThreadPool]: SQL status: OK in 18.596 seconds
[0m05:21:30.088713 [debug] [ThreadPool]: On list_crypto_database: Close
[0m05:21:30.089835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m05:21:30.090697 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m05:21:30.101953 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m05:21:30.102958 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m05:21:30.103813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:21:30.108071 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m05:21:30.110058 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m05:21:30.110620 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m05:21:30.112548 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m05:21:30.113168 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m05:21:30.114197 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m05:21:30.146927 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m05:21:30.148353 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m05:21:30.149274 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m05:21:30.149892 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m05:21:30.182578 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m05:21:30.183202 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m05:21:30.191069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m05:21:30.198661 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m05:21:30.199228 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m05:21:30.199907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:21:30.202174 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m05:21:30.203150 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m05:21:30.204116 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m05:21:30.247977 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m05:21:30.251227 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m05:21:30.260893 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m05:21:30.261987 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m05:21:30.267535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '437c8f28-9301-4b4a-83e8-19d7acf430ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73bce273f0>]}
[0m05:21:30.269958 [debug] [MainThread]: Using duckdb connection "master"
[0m05:21:30.272901 [debug] [MainThread]: On master: BEGIN
[0m05:21:30.273572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:21:30.278443 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m05:21:30.281668 [debug] [MainThread]: On master: COMMIT
[0m05:21:30.282444 [debug] [MainThread]: Using duckdb connection "master"
[0m05:21:30.283102 [debug] [MainThread]: On master: COMMIT
[0m05:21:30.288568 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m05:21:30.289585 [debug] [MainThread]: On master: Close
[0m05:21:30.297985 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m05:21:30.301126 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg__prices ................................... [RUN]
[0m05:21:30.303048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m05:21:30.304290 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m05:21:30.327737 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m05:21:30.329246 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m05:21:30.405099 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m05:21:30.407335 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m05:21:30.408788 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m05:21:30.409728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:30.415087 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m05:21:30.416306 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m05:21:30.418167 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_database"."main"."stg__prices__dbt_tmp" as (
    select
    id as coin_id,
    symbol,
    current_price as usd_price,
    price_change_percentage_24h as daily_change,
    updated_at as ingested_at
from "crypto_database"."crypto_database"."raw_prices" 
--                                ^^^^^^^^^^^^
-- Critical: This must match the table name in sources.yml
  );

[0m05:21:30.466744 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_database"."main"."stg__prices__dbt_tmp" as (
    select
    id as coin_id,
    symbol,
    current_price as usd_price,
    price_change_percentage_24h as daily_change,
    updated_at as ingested_at
from "crypto_database"."crypto_database"."raw_prices" 
--                                ^^^^^^^^^^^^
-- Critical: This must match the table name in sources.yml
  );

[0m05:21:30.467828 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m05:21:30.469028 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: ROLLBACK
[0m05:21:30.486737 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_analytics.stg__prices'
[0m05:21:30.487907 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m05:21:30.494119 [debug] [Thread-1 (]: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Catalog Error: Table with name raw_prices does not exist!
  Did you mean "crypto_db.crypto_raw.raw_prices or crypto_raw.raw_prices"?
  
  LINE 11: from "crypto_database"."crypto_database"."raw_prices" 
                ^
[0m05:21:30.496622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '437c8f28-9301-4b4a-83e8-19d7acf430ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73bc4a4390>]}
[0m05:21:30.498014 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg__prices .......................... [[31mERROR[0m in 0.19s]
[0m05:21:30.499291 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m05:21:30.500968 [debug] [Thread-7 (]: Marking all children of 'model.crypto_analytics.stg__prices' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Catalog Error: Table with name raw_prices does not exist!
  Did you mean "crypto_db.crypto_raw.raw_prices or crypto_raw.raw_prices"?
  
  LINE 11: from "crypto_database"."crypto_database"."raw_prices" 
                ^.
[0m05:21:30.509475 [debug] [MainThread]: Using duckdb connection "master"
[0m05:21:30.510415 [debug] [MainThread]: On master: BEGIN
[0m05:21:30.514878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:21:30.519816 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m05:21:30.521048 [debug] [MainThread]: On master: COMMIT
[0m05:21:30.522906 [debug] [MainThread]: Using duckdb connection "master"
[0m05:21:30.523892 [debug] [MainThread]: On master: COMMIT
[0m05:21:30.526003 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m05:21:30.527205 [debug] [MainThread]: On master: Close
[0m05:21:30.528579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:21:30.529747 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m05:21:30.530911 [info ] [MainThread]: 
[0m05:21:30.532283 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 19.28 seconds (19.28s).
[0m05:21:30.534477 [debug] [MainThread]: Command end result
[0m05:21:30.585885 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m05:21:30.591037 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m05:21:30.603204 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m05:21:30.605130 [info ] [MainThread]: 
[0m05:21:30.606655 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:21:30.608261 [info ] [MainThread]: 
[0m05:21:30.609375 [error] [MainThread]: [31mFailure in model stg__prices (models/staging/stg__prices.sql)[0m
[0m05:21:30.610400 [error] [MainThread]:   Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Catalog Error: Table with name raw_prices does not exist!
  Did you mean "crypto_db.crypto_raw.raw_prices or crypto_raw.raw_prices"?
  
  LINE 11: from "crypto_database"."crypto_database"."raw_prices" 
                ^
[0m05:21:30.611384 [info ] [MainThread]: 
[0m05:21:30.612406 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics/models/staging/stg__prices.sql
[0m05:21:30.613199 [info ] [MainThread]: 
[0m05:21:30.614141 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m05:21:30.615738 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 20.700333, "process_in_blocks": "37016", "process_kernel_time": 0.469086, "process_mem_max_rss": "190452", "process_out_blocks": "2000", "process_user_time": 4.680929}
[0m05:21:30.617112 [debug] [MainThread]: Command `dbt build` failed at 05:21:30.616831 after 20.70 seconds
[0m05:21:30.620346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73c379ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73bce420a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73bce42200>]}
[0m05:21:30.621332 [debug] [MainThread]: Flushing usage events
[0m05:21:31.368674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:23:04.302518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78adaa0c2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78adaba54e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ada90ffb10>]}


============================== 05:23:04.310992 | 33785e54-c533-4e0a-badc-9077f9237fa8 ==============================
[0m05:23:04.310992 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:23:04.313196 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'debug': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'invocation_command': 'dbt '}
[0m05:23:04.981652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33785e54-c533-4e0a-badc-9077f9237fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ada9ddf490>]}
[0m05:23:05.198741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33785e54-c533-4e0a-badc-9077f9237fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ada91b9150>]}
[0m05:23:05.202841 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:23:05.478068 [debug] [MainThread]: checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9, vars: {}, profile: , target: duck, version: 1.11.3
[0m05:23:05.629744 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m05:23:05.633073 [debug] [MainThread]: previous checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9, current checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6
[0m05:23:05.635059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33785e54-c533-4e0a-badc-9077f9237fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ada917b150>]}
[0m05:23:08.410648 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m05:23:08.429511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33785e54-c533-4e0a-badc-9077f9237fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ada33e99a0>]}
[0m05:23:08.590304 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m05:23:08.594051 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m05:23:08.872064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33785e54-c533-4e0a-badc-9077f9237fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ada1eb8d70>]}
[0m05:23:08.873258 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m05:23:08.877172 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:23:08.878757 [debug] [MainThread]: Command end result
[0m05:23:08.925136 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m05:23:08.928576 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m05:23:08.935442 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m05:23:08.936969 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.82103, "process_in_blocks": "1080", "process_kernel_time": 0.523767, "process_mem_max_rss": "183932", "process_out_blocks": "4032", "process_user_time": 6.87199}
[0m05:23:08.938321 [debug] [MainThread]: Command `cli build` succeeded at 05:23:08.938083 after 4.82 seconds
[0m05:23:08.939386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ada1e442c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ada918ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ada1edc350>]}
[0m05:23:08.941272 [debug] [MainThread]: Flushing usage events
[0m05:23:09.666144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:25:11.876681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72658debacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72658f7c0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72658cefbc50>]}


============================== 05:25:11.881502 | cfec0467-d8b2-4018-9dcf-9a2550c57af9 ==============================
[0m05:25:11.881502 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:25:11.882672 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build', 'write_json': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/bihitche/.dbt'}
[0m05:25:12.380852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfec0467-d8b2-4018-9dcf-9a2550c57af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72658dbdb5c0>]}
[0m05:25:12.548816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfec0467-d8b2-4018-9dcf-9a2550c57af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72658cfb1260>]}
[0m05:25:12.551062 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:25:12.747637 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m05:25:12.909075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:25:12.909951 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m05:25:12.910866 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:25:12.922905 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m05:25:12.992994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfec0467-d8b2-4018-9dcf-9a2550c57af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265869b1450>]}
[0m05:25:13.118098 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m05:25:13.123790 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m05:25:13.172747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfec0467-d8b2-4018-9dcf-9a2550c57af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72658cef6f30>]}
[0m05:25:13.173584 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m05:25:13.176785 [info ] [MainThread]: 
[0m05:25:13.177600 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m05:25:13.178343 [info ] [MainThread]: 
[0m05:25:13.179524 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:25:13.181537 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m05:25:13.369721 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m05:25:13.370338 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m05:25:13.370889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:27.871452 [debug] [ThreadPool]: SQL status: OK in 14.500 seconds
[0m05:25:27.876811 [debug] [ThreadPool]: On list_crypto_database: Close
[0m05:25:27.879297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m05:25:27.881207 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m05:25:27.907718 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m05:25:27.909300 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m05:25:27.910589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:27.915697 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m05:25:27.920185 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m05:25:27.921267 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m05:25:27.923863 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m05:25:27.924915 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m05:25:27.926117 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m05:25:27.962632 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m05:25:27.964552 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m05:25:27.965298 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m05:25:27.965972 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m05:25:28.000243 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m05:25:28.001139 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m05:25:28.010895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m05:25:28.021247 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m05:25:28.022003 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m05:25:28.022647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:28.024911 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m05:25:28.025674 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m05:25:28.026335 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m05:25:28.055700 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m05:25:28.057418 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m05:25:28.058586 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m05:25:28.059064 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m05:25:28.060270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfec0467-d8b2-4018-9dcf-9a2550c57af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72658667f3f0>]}
[0m05:25:28.060972 [debug] [MainThread]: Using duckdb connection "master"
[0m05:25:28.061439 [debug] [MainThread]: On master: BEGIN
[0m05:25:28.061892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:25:28.063605 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m05:25:28.064158 [debug] [MainThread]: On master: COMMIT
[0m05:25:28.064674 [debug] [MainThread]: Using duckdb connection "master"
[0m05:25:28.065142 [debug] [MainThread]: On master: COMMIT
[0m05:25:28.066105 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m05:25:28.066653 [debug] [MainThread]: On master: Close
[0m05:25:28.069916 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m05:25:28.071023 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg__prices ................................... [RUN]
[0m05:25:28.071940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m05:25:28.072486 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m05:25:28.082069 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m05:25:28.083321 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m05:25:28.139991 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m05:25:28.141324 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m05:25:28.142190 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m05:25:28.142831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:25:28.146449 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m05:25:28.147508 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m05:25:28.148549 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_database"."main"."stg__prices__dbt_tmp" as (
    select
    id as coin_id,
    symbol,
    current_price as usd_price,
    price_change_percentage_24h as daily_change,
    last_updated as ingested_at  -- <--- TRY CHANGING 'updated_at' TO 'last_updated'
from "crypto_database"."crypto_raw"."raw_prices"
  );

[0m05:25:28.182518 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_database"."main"."stg__prices__dbt_tmp" as (
    select
    id as coin_id,
    symbol,
    current_price as usd_price,
    price_change_percentage_24h as daily_change,
    last_updated as ingested_at  -- <--- TRY CHANGING 'updated_at' TO 'last_updated'
from "crypto_database"."crypto_raw"."raw_prices"
  );

[0m05:25:28.183339 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m05:25:28.184567 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: ROLLBACK
[0m05:25:28.193305 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_analytics.stg__prices'
[0m05:25:28.193944 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m05:25:28.199671 [debug] [Thread-1 (]: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Binder Error: Referenced column "last_updated" not found in FROM clause!
  Candidate bindings: "total_volume", "market_cap", "_dlt_load_id", "_dlt_id", "current_price"
  
  LINE 10:     last_updated as ingested_at  -- <--- TRY CHANGING 'updated_at...
               ^
[0m05:25:28.202211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfec0467-d8b2-4018-9dcf-9a2550c57af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726585b9e4e0>]}
[0m05:25:28.203731 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.stg__prices .......................... [[31mERROR[0m in 0.13s]
[0m05:25:28.205282 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m05:25:28.206414 [debug] [Thread-7 (]: Marking all children of 'model.crypto_analytics.stg__prices' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Binder Error: Referenced column "last_updated" not found in FROM clause!
  Candidate bindings: "total_volume", "market_cap", "_dlt_load_id", "_dlt_id", "current_price"
  
  LINE 10:     last_updated as ingested_at  -- <--- TRY CHANGING 'updated_at...
               ^.
[0m05:25:28.210110 [debug] [MainThread]: Using duckdb connection "master"
[0m05:25:28.211138 [debug] [MainThread]: On master: BEGIN
[0m05:25:28.212062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:25:28.214785 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m05:25:28.215768 [debug] [MainThread]: On master: COMMIT
[0m05:25:28.216701 [debug] [MainThread]: Using duckdb connection "master"
[0m05:25:28.217588 [debug] [MainThread]: On master: COMMIT
[0m05:25:28.219269 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m05:25:28.220230 [debug] [MainThread]: On master: Close
[0m05:25:28.224603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:25:28.225490 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m05:25:28.226439 [info ] [MainThread]: 
[0m05:25:28.229839 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.05 seconds (15.05s).
[0m05:25:28.233178 [debug] [MainThread]: Command end result
[0m05:25:28.301385 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m05:25:28.305011 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m05:25:28.316047 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m05:25:28.316826 [info ] [MainThread]: 
[0m05:25:28.317620 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:25:28.318375 [info ] [MainThread]: 
[0m05:25:28.319233 [error] [MainThread]: [31mFailure in model stg__prices (models/staging/stg__prices.sql)[0m
[0m05:25:28.320138 [error] [MainThread]:   Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Binder Error: Referenced column "last_updated" not found in FROM clause!
  Candidate bindings: "total_volume", "market_cap", "_dlt_load_id", "_dlt_id", "current_price"
  
  LINE 10:     last_updated as ingested_at  -- <--- TRY CHANGING 'updated_at...
               ^
[0m05:25:28.321010 [info ] [MainThread]: 
[0m05:25:28.322115 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics/models/staging/stg__prices.sql
[0m05:25:28.323248 [info ] [MainThread]: 
[0m05:25:28.324564 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m05:25:28.326716 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 16.565222, "process_in_blocks": "8", "process_kernel_time": 0.476412, "process_mem_max_rss": "190684", "process_out_blocks": "2000", "process_user_time": 4.615623}
[0m05:25:28.327717 [debug] [MainThread]: Command `dbt build` failed at 05:25:28.327521 after 16.57 seconds
[0m05:25:28.328563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72658cf86d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72658669e0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72658669e200>]}
[0m05:25:28.329496 [debug] [MainThread]: Flushing usage events
[0m05:25:29.031049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:52:26.449132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9f97bacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9fb0c8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9f87f7c50>]}


============================== 05:52:26.458339 | c9377197-e660-43b9-8462-b5b5be333e62 ==============================
[0m05:52:26.458339 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:52:26.460351 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'warn_error': 'None', 'profiles_dir': '/home/bihitche/.dbt', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'fail_fast': 'False', 'target_path': 'None', 'invocation_command': 'dbt build', 'introspect': 'True', 'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'write_json': 'True'}
[0m05:52:27.161782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9377197-e660-43b9-8462-b5b5be333e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9f94d75c0>]}
[0m05:52:27.439938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9377197-e660-43b9-8462-b5b5be333e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9f88ad260>]}
[0m05:52:27.445088 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:52:27.682370 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m05:52:27.972166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:52:27.973766 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/coin_trends_trends.sql
[0m05:52:29.253548 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.crypto_analytics.coin_trends_trends' (models/marts/coin_trends_trends.sql) depends on a node named 'stg_prices' which was not found
[0m05:52:29.254851 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.9963894, "process_in_blocks": "0", "process_kernel_time": 0.49916, "process_mem_max_rss": "144596", "process_out_blocks": "16", "process_user_time": 4.752916}
[0m05:52:29.255624 [debug] [MainThread]: Command `dbt build` failed at 05:52:29.255469 after 3.00 seconds
[0m05:52:29.256542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9f8703550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9f8701e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9f1f0c230>]}
[0m05:52:29.257425 [debug] [MainThread]: Flushing usage events
[0m05:52:30.137352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:53:24.880086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563c39e6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563c536ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563c2a27c50>]}


============================== 05:53:24.884254 | f0e958d0-33c6-47b0-9391-3a8ac13461ac ==============================
[0m05:53:24.884254 [info ] [MainThread]: Running with dbt=1.11.3
[0m05:53:24.885933 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'empty': 'False', 'partial_parse': 'True', 'no_print': 'None', 'fail_fast': 'False', 'quiet': 'False', 'invocation_command': 'dbt build', 'profiles_dir': '/home/bihitche/.dbt', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_colors': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs'}
[0m05:53:25.463686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0e958d0-33c6-47b0-9391-3a8ac13461ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563c37075c0>]}
[0m05:53:25.642389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0e958d0-33c6-47b0-9391-3a8ac13461ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563c2add260>]}
[0m05:53:25.644924 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m05:53:25.886941 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m05:53:26.065282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:53:26.065910 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m05:53:26.066329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:53:26.077157 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.crypto_analytics.marts
- seeds.crypto_analytics
[0m05:53:26.136041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0e958d0-33c6-47b0-9391-3a8ac13461ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563bcbe5450>]}
[0m05:53:26.309547 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m05:53:26.313988 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m05:53:26.362333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0e958d0-33c6-47b0-9391-3a8ac13461ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563c2a22f30>]}
[0m05:53:26.363612 [info ] [MainThread]: Found 1 model, 1 source, 472 macros
[0m05:53:26.366886 [info ] [MainThread]: 
[0m05:53:26.367533 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m05:53:26.368198 [info ] [MainThread]: 
[0m05:53:26.370002 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:53:26.372164 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m05:53:26.618009 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m05:53:26.619018 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m05:53:26.620097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:53:46.698079 [debug] [ThreadPool]: SQL status: OK in 20.078 seconds
[0m05:53:46.709705 [debug] [ThreadPool]: On list_crypto_database: Close
[0m05:53:46.716148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m05:53:46.720120 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m05:53:46.746669 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m05:53:46.748047 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m05:53:46.749797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:53:46.754092 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m05:53:46.758126 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m05:53:46.759239 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m05:53:46.762660 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m05:53:46.763671 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m05:53:46.764719 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m05:53:46.803177 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m05:53:46.805408 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m05:53:46.806544 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m05:53:46.807705 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m05:53:46.839339 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m05:53:46.839941 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m05:53:46.841816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m05:53:46.848985 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m05:53:46.849705 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m05:53:46.850198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:53:46.851993 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m05:53:46.852587 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m05:53:46.853046 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m05:53:46.879550 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m05:53:46.881197 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m05:53:46.882399 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m05:53:46.882892 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m05:53:46.884274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0e958d0-33c6-47b0-9391-3a8ac13461ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563bc1afd90>]}
[0m05:53:46.885000 [debug] [MainThread]: Using duckdb connection "master"
[0m05:53:46.885482 [debug] [MainThread]: On master: BEGIN
[0m05:53:46.885920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:53:46.887554 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m05:53:46.888084 [debug] [MainThread]: On master: COMMIT
[0m05:53:46.888791 [debug] [MainThread]: Using duckdb connection "master"
[0m05:53:46.889286 [debug] [MainThread]: On master: COMMIT
[0m05:53:46.890346 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m05:53:46.890901 [debug] [MainThread]: On master: Close
[0m05:53:46.893968 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m05:53:46.895084 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg__prices ................................... [RUN]
[0m05:53:46.895995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m05:53:46.896764 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m05:53:46.907770 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m05:53:46.909281 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m05:53:46.982956 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m05:53:46.984344 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m05:53:46.985273 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m05:53:46.986120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:53:46.988596 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m05:53:46.989579 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m05:53:46.990503 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_database"."main"."stg__prices__dbt_tmp" as (
    select
    id as coin_id,
    symbol,
    current_price as usd_price,
    price_change_percentage_24h as daily_change,
    
    now() as ingested_at 
from "crypto_database"."crypto_raw"."raw_prices"
  );

[0m05:53:47.028966 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m05:53:47.041385 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m05:53:47.042064 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */
alter view "crypto_database"."main"."stg__prices__dbt_tmp" rename to "stg__prices"
[0m05:53:47.076792 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m05:53:47.091088 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m05:53:47.091753 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m05:53:47.092316 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m05:53:47.167405 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m05:53:47.182175 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m05:53:47.183511 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop view if exists "crypto_database"."main"."stg__prices__dbt_backup" cascade
    
[0m05:53:47.222798 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m05:53:47.229799 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m05:53:47.234322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e958d0-33c6-47b0-9391-3a8ac13461ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563af513930>]}
[0m05:53:47.236532 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg__prices .............................. [[32mOK[0m in 0.34s]
[0m05:53:47.238817 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m05:53:47.242635 [debug] [MainThread]: Using duckdb connection "master"
[0m05:53:47.244158 [debug] [MainThread]: On master: BEGIN
[0m05:53:47.246144 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:53:47.249741 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m05:53:47.250933 [debug] [MainThread]: On master: COMMIT
[0m05:53:47.251882 [debug] [MainThread]: Using duckdb connection "master"
[0m05:53:47.253056 [debug] [MainThread]: On master: COMMIT
[0m05:53:47.255134 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m05:53:47.256313 [debug] [MainThread]: On master: Close
[0m05:53:47.257282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:53:47.258261 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m05:53:47.259335 [info ] [MainThread]: 
[0m05:53:47.260916 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.89 seconds (20.89s).
[0m05:53:47.263167 [debug] [MainThread]: Command end result
[0m05:53:47.322545 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m05:53:47.325596 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m05:53:47.344439 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m05:53:47.345369 [info ] [MainThread]: 
[0m05:53:47.346535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:53:47.347990 [info ] [MainThread]: 
[0m05:53:47.349089 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m05:53:47.350833 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 22.627462, "process_in_blocks": "128", "process_kernel_time": 0.57325, "process_mem_max_rss": "188932", "process_out_blocks": "1992", "process_user_time": 5.789927}
[0m05:53:47.351908 [debug] [MainThread]: Command `dbt build` succeeded at 05:53:47.351695 after 22.63 seconds
[0m05:53:47.352825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563c2ab2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563bc1cdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7563bc1cd5a0>]}
[0m05:53:47.353715 [debug] [MainThread]: Flushing usage events
[0m05:53:48.169849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:00:13.093750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2af3bacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2b0cc0e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2ae3f7b10>]}


============================== 06:00:13.101790 | 2788a306-b906-45b3-9e9c-3f3aadbeb35f ==============================
[0m06:00:13.101790 [info ] [MainThread]: Running with dbt=1.11.3
[0m06:00:13.103663 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --select dim_coin_trends', 'target_path': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'no_print': 'None', 'profiles_dir': '/home/bihitche/.dbt', 'static_parser': 'True', 'use_colors': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False'}
[0m06:00:13.665046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2788a306-b906-45b3-9e9c-3f3aadbeb35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2af0d7490>]}
[0m06:00:13.902214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2788a306-b906-45b3-9e9c-3f3aadbeb35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2ae4ad260>]}
[0m06:00:13.906572 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:00:14.185376 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m06:00:14.393213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m06:00:14.394032 [debug] [MainThread]: Partial parsing: added file: crypto_analytics://models/marts/coin_trends_trends.sql
[0m06:00:14.903360 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.crypto_analytics.coin_trends_trends' (models/marts/coin_trends_trends.sql) depends on a node named 'stg_prices' which was not found
[0m06:00:14.904570 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.9346102, "process_in_blocks": "0", "process_kernel_time": 0.364517, "process_mem_max_rss": "144560", "process_out_blocks": "16", "process_user_time": 3.704769}
[0m06:00:14.905359 [debug] [MainThread]: Command `dbt build` failed at 06:00:14.905181 after 1.94 seconds
[0m06:00:14.906033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2ae2fde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2ae2ff450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2a3b0c320>]}
[0m06:00:14.906683 [debug] [MainThread]: Flushing usage events
[0m06:00:15.754714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:00:51.035328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287bcfcecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287be888e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287bc00bb10>]}


============================== 06:00:51.040900 | 178e06cb-f153-4773-9d0b-d05065522036 ==============================
[0m06:00:51.040900 [info ] [MainThread]: Running with dbt=1.11.3
[0m06:00:51.041835 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'introspect': 'True', 'debug': 'False', 'empty': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'target_path': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'quiet': 'False', 'printer_width': '80', 'profiles_dir': '/home/bihitche/.dbt', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'fail_fast': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt build --select dim_coin_trends', 'use_colors': 'True', 'log_format': 'default', 'no_print': 'None'}
[0m06:00:51.511569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '178e06cb-f153-4773-9d0b-d05065522036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287bcceb490>]}
[0m06:00:51.708959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '178e06cb-f153-4773-9d0b-d05065522036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287bc0c1260>]}
[0m06:00:51.712980 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:00:51.895730 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m06:00:52.080991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m06:00:52.081822 [debug] [MainThread]: Partial parsing: added file: crypto_analytics://models/marts/coin_trends_trends.sql
[0m06:00:52.564364 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.crypto_analytics.coin_trends_trends' (models/marts/coin_trends_trends.sql) depends on a node named 'stg_prices' which was not found
[0m06:00:52.565527 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.6516078, "process_in_blocks": "0", "process_kernel_time": 0.361038, "process_mem_max_rss": "144528", "process_out_blocks": "16", "process_user_time": 3.648288}
[0m06:00:52.566258 [debug] [MainThread]: Command `dbt build` failed at 06:00:52.566106 after 1.65 seconds
[0m06:00:52.566963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287bbf11e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287bbf13450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287b5724320>]}
[0m06:00:52.567823 [debug] [MainThread]: Flushing usage events
[0m06:00:53.075249 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:03:03.621505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7333828c6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73338417ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7333818ffb10>]}


============================== 06:03:03.626037 | fbced65d-e6f9-4c5a-af02-271c38ab25fb ==============================
[0m06:03:03.626037 [info ] [MainThread]: Running with dbt=1.11.3
[0m06:03:03.627293 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --select dim_coin_trends', 'profiles_dir': '/home/bihitche/.dbt', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'debug': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error': 'None', 'printer_width': '80'}
[0m06:03:04.156059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbced65d-e6f9-4c5a-af02-271c38ab25fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7333825e3490>]}
[0m06:03:04.298441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbced65d-e6f9-4c5a-af02-271c38ab25fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7333819b9260>]}
[0m06:03:04.302552 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:03:04.573438 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m06:03:04.681603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m06:03:04.682376 [debug] [MainThread]: Partial parsing: added file: crypto_analytics://models/marts/coin_trends.sql
[0m06:03:05.112087 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.crypto_analytics.coin_trends' (models/marts/coin_trends.sql) depends on a node named 'stg_prices' which was not found
[0m06:03:05.114139 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.6662217, "process_in_blocks": "0", "process_kernel_time": 0.419528, "process_mem_max_rss": "144552", "process_out_blocks": "8", "process_user_time": 4.096336}
[0m06:03:05.114950 [debug] [MainThread]: Command `dbt build` failed at 06:03:05.114820 after 1.67 seconds
[0m06:03:05.115501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73338180de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73338180f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73337b014320>]}
[0m06:03:05.116035 [debug] [MainThread]: Flushing usage events
[0m06:03:05.945433 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:05:35.715813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae393bc2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae39547ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae392bfbb10>]}


============================== 06:05:35.724498 | 032bff60-ee12-475a-8e21-905e3b6ba7d0 ==============================
[0m06:05:35.724498 [info ] [MainThread]: Running with dbt=1.11.3
[0m06:05:35.726172 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'version_check': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select coin_trends', 'static_parser': 'True', 'partial_parse': 'True', 'empty': 'False', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'introspect': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True'}
[0m06:05:36.155865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '032bff60-ee12-475a-8e21-905e3b6ba7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae3938df490>]}
[0m06:05:36.311699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '032bff60-ee12-475a-8e21-905e3b6ba7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae392cb5260>]}
[0m06:05:36.313850 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:05:36.507519 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m06:05:36.632089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:05:36.632708 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m06:05:36.633169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:05:36.641361 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m06:05:36.704025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '032bff60-ee12-475a-8e21-905e3b6ba7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae38cdb5350>]}
[0m06:05:36.844447 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m06:05:36.847726 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m06:05:36.872089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '032bff60-ee12-475a-8e21-905e3b6ba7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae392c02f30>]}
[0m06:05:36.873154 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m06:05:36.874071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '032bff60-ee12-475a-8e21-905e3b6ba7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae38c320ad0>]}
[0m06:05:36.877223 [info ] [MainThread]: 
[0m06:05:36.878137 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m06:05:36.878961 [info ] [MainThread]: 
[0m06:05:36.880175 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:05:36.882051 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m06:05:37.203785 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m06:05:37.204681 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m06:05:37.205563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:52.126854 [debug] [ThreadPool]: SQL status: OK in 14.921 seconds
[0m06:05:52.134029 [debug] [ThreadPool]: On list_crypto_database: Close
[0m06:05:52.139972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m06:05:52.140958 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m06:05:52.170385 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m06:05:52.171318 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m06:05:52.172192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:05:52.195393 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m06:05:52.204203 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m06:05:52.205446 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m06:05:52.217427 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m06:05:52.218572 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m06:05:52.220234 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m06:05:52.257631 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m06:05:52.261052 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m06:05:52.262324 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m06:05:52.263825 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m06:05:52.298316 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m06:05:52.299625 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m06:05:52.314549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m06:05:52.418914 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m06:05:52.419595 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m06:05:52.420198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:05:52.422488 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m06:05:52.423171 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m06:05:52.423858 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m06:05:52.487557 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m06:05:52.491277 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m06:05:52.493528 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m06:05:52.494537 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m06:05:52.496678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '032bff60-ee12-475a-8e21-905e3b6ba7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae38c1265b0>]}
[0m06:05:52.497755 [debug] [MainThread]: Using duckdb connection "master"
[0m06:05:52.498772 [debug] [MainThread]: On master: BEGIN
[0m06:05:52.499985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:05:52.503483 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m06:05:52.504582 [debug] [MainThread]: On master: COMMIT
[0m06:05:52.505622 [debug] [MainThread]: Using duckdb connection "master"
[0m06:05:52.506547 [debug] [MainThread]: On master: COMMIT
[0m06:05:52.511127 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m06:05:52.512402 [debug] [MainThread]: On master: Close
[0m06:05:52.520303 [debug] [Thread-1 (]: Began running node model.crypto_analytics.coin_trends
[0m06:05:52.521803 [info ] [Thread-1 (]: 1 of 1 START sql table model main.coin_trends .................................. [RUN]
[0m06:05:52.523114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.coin_trends)
[0m06:05:52.524331 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.coin_trends
[0m06:05:52.541615 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.coin_trends"
[0m06:05:52.543101 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.coin_trends
[0m06:05:52.621186 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.coin_trends"
[0m06:05:52.623039 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m06:05:52.625006 [debug] [Thread-1 (]: On model.crypto_analytics.coin_trends: BEGIN
[0m06:05:52.626628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:05:52.633218 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m06:05:52.634431 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m06:05:52.635619 [debug] [Thread-1 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */

  
    
    

    create  table
      "crypto_database"."main"."coin_trends__dbt_tmp"
  
    as (
      

with source as (
    -- 1. Grab the clean data from staging
    select * from "crypto_database"."main"."stg__prices"
)

select
    coin_id,
    symbol,
    usd_price,
    daily_change,
    ingested_at,
    
    -- 2. BUSINESS LOGIC: Categorize Volatility
    case 
        when daily_change > 5.0  then '🚀 Mooning'
        when daily_change < -5.0 then '💀 Crashing'
        else '😴 Stable'
    end as volatility_flag,

    -- 3. BUSINESS LOGIC: High Risk Flag (Simple Boolean)
    case
        when abs(daily_change) > 10 then true
        else false
    end as is_high_risk

from source
where daily_change is not null -- Safety check!
    );
  
  
[0m06:05:52.696181 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m06:05:52.710901 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m06:05:52.712092 [debug] [Thread-1 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */
alter table "crypto_database"."main"."coin_trends__dbt_tmp" rename to "coin_trends"
[0m06:05:52.753255 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m06:05:52.789563 [debug] [Thread-1 (]: On model.crypto_analytics.coin_trends: COMMIT
[0m06:05:52.790575 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m06:05:52.791281 [debug] [Thread-1 (]: On model.crypto_analytics.coin_trends: COMMIT
[0m06:05:52.864948 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m06:05:52.878154 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m06:05:52.879346 [debug] [Thread-1 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */

      drop table if exists "crypto_database"."main"."coin_trends__dbt_backup" cascade
    
[0m06:05:52.916771 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m06:05:52.922922 [debug] [Thread-1 (]: On model.crypto_analytics.coin_trends: Close
[0m06:05:52.929233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '032bff60-ee12-475a-8e21-905e3b6ba7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae38cf7c410>]}
[0m06:05:52.932073 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.coin_trends ............................. [[32mOK[0m in 0.40s]
[0m06:05:52.934080 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.coin_trends
[0m06:05:52.937741 [debug] [MainThread]: Using duckdb connection "master"
[0m06:05:52.939079 [debug] [MainThread]: On master: BEGIN
[0m06:05:52.940046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:05:52.945809 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m06:05:52.947173 [debug] [MainThread]: On master: COMMIT
[0m06:05:52.951489 [debug] [MainThread]: Using duckdb connection "master"
[0m06:05:52.952387 [debug] [MainThread]: On master: COMMIT
[0m06:05:52.959048 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m06:05:52.960128 [debug] [MainThread]: On master: Close
[0m06:05:52.961374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:05:52.962447 [debug] [MainThread]: Connection 'model.crypto_analytics.coin_trends' was properly closed.
[0m06:05:52.964396 [info ] [MainThread]: 
[0m06:05:52.965802 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.08 seconds (16.08s).
[0m06:05:52.967998 [debug] [MainThread]: Command end result
[0m06:05:53.054873 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m06:05:53.059272 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m06:05:53.077018 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m06:05:53.078405 [info ] [MainThread]: 
[0m06:05:53.079851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:05:53.081229 [info ] [MainThread]: 
[0m06:05:53.082267 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m06:05:53.086163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.491108, "process_in_blocks": "736", "process_kernel_time": 0.457619, "process_mem_max_rss": "188796", "process_out_blocks": "1992", "process_user_time": 4.713278}
[0m06:05:53.087366 [debug] [MainThread]: Command `dbt run` succeeded at 06:05:53.087169 after 17.49 seconds
[0m06:05:53.088400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae38c4e71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae38cf6c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae38cf6cf50>]}
[0m06:05:53.089526 [debug] [MainThread]: Flushing usage events
[0m06:05:53.880777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:09.115918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72098c3d6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72098de991d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72098b40fd90>]}


============================== 00:06:09.121816 | e008c976-721e-4318-8cbd-911daefc9972 ==============================
[0m00:06:09.121816 [info ] [MainThread]: Running with dbt=1.11.3
[0m00:06:09.122891 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'empty': 'None', 'profiles_dir': '/home/bihitche/.dbt', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'printer_width': '80', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'target_path': 'None', 'debug': 'False', 'introspect': 'True', 'use_colors': 'True'}
[0m00:06:09.324404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e008c976-721e-4318-8cbd-911daefc9972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72098c0f3490>]}
[0m00:06:09.369531 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:06:09.370967 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:06:09.373627 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35713214, "process_in_blocks": "13712", "process_kernel_time": 0.342282, "process_mem_max_rss": "105932", "process_out_blocks": "184", "process_user_time": 2.815642}
[0m00:06:09.374887 [debug] [MainThread]: Command `cli deps` succeeded at 00:06:09.374683 after 0.36 seconds
[0m00:06:09.375960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72098b05ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72098b05d260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72098b49aa50>]}
[0m00:06:09.377100 [debug] [MainThread]: Flushing usage events
[0m00:06:10.219955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:05:10.467539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722e434d2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722e44f81090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722e4250bb10>]}


============================== 01:05:10.473665 | 352d22f1-99c4-4996-a6b3-ff33bbee34f0 ==============================
[0m01:05:10.473665 [info ] [MainThread]: Running with dbt=1.11.3
[0m01:05:10.474646 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'static_parser': 'True', 'no_print': 'None', 'profiles_dir': '/home/bihitche/.dbt', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_colors': 'True', 'invocation_command': 'dbt test', 'fail_fast': 'False', 'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'None'}
[0m01:05:10.817944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '352d22f1-99c4-4996-a6b3-ff33bbee34f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722e431f35c0>]}
[0m01:05:10.926647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '352d22f1-99c4-4996-a6b3-ff33bbee34f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722e425b9370>]}
[0m01:05:10.931828 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:05:11.071277 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m01:05:11.191093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m01:05:11.191894 [debug] [MainThread]: Partial parsing: added file: crypto_analytics://tests/schema.yml
[0m01:05:11.192445 [debug] [MainThread]: Partial parsing: added file: crypto_analytics://tests/assert_price.sql
[0m01:05:11.422100 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'assert_high_prices' in the 'data_tests' section of file 'tests/schema.yml'
[0m01:05:11.423358 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.assert_price' (tests/assert_price.sql) depends on a node named 'stg_prices' in package '' which was not found
[0m01:05:11.624780 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m01:05:11.652366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '352d22f1-99c4-4996-a6b3-ff33bbee34f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722e4241d550>]}
[0m01:05:11.848417 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m01:05:11.852243 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m01:05:12.066737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '352d22f1-99c4-4996-a6b3-ff33bbee34f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722e3716e990>]}
[0m01:05:12.067890 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m01:05:12.068940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '352d22f1-99c4-4996-a6b3-ff33bbee34f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722e4251b690>]}
[0m01:05:12.072796 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:05:12.074221 [debug] [MainThread]: Command end result
[0m01:05:12.116697 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m01:05:12.119801 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m01:05:12.126113 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m01:05:12.128823 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7563696, "process_in_blocks": "39896", "process_kernel_time": 0.384818, "process_mem_max_rss": "178012", "process_out_blocks": "4216", "process_user_time": 3.277898}
[0m01:05:12.130021 [debug] [MainThread]: Command `dbt test` succeeded at 01:05:12.129756 after 1.76 seconds
[0m01:05:12.131124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722e377b7d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722e4250dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722e377b31d0>]}
[0m01:05:12.132156 [debug] [MainThread]: Flushing usage events
[0m01:05:12.957823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:05:48.005054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a6d3daba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a6ee4d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a6c413b10>]}


============================== 01:05:48.009680 | 3f45ebcf-1c29-41f2-a207-42dd9110e124 ==============================
[0m01:05:48.009680 [info ] [MainThread]: Running with dbt=1.11.3
[0m01:05:48.010736 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'empty': 'None', 'profiles_dir': '/home/bihitche/.dbt', 'printer_width': '80', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt test --select assert_price'}
[0m01:05:48.488402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f45ebcf-1c29-41f2-a207-42dd9110e124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a6d0fb5c0>]}
[0m01:05:48.629215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f45ebcf-1c29-41f2-a207-42dd9110e124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a6c4c1370>]}
[0m01:05:48.631336 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:05:48.796658 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m01:05:48.973778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:05:48.974454 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:05:48.975046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:05:48.983659 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m01:05:49.063060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f45ebcf-1c29-41f2-a207-42dd9110e124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a6c325d50>]}
[0m01:05:49.205204 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m01:05:49.208985 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m01:05:49.241202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f45ebcf-1c29-41f2-a207-42dd9110e124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a65bec5f0>]}
[0m01:05:49.242032 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m01:05:49.242792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f45ebcf-1c29-41f2-a207-42dd9110e124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a65a0c9f0>]}
[0m01:05:49.243879 [warn ] [MainThread]: The selection criterion 'assert_price' does not match any enabled nodes
[0m01:05:49.253490 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:05:49.257937 [debug] [MainThread]: Command end result
[0m01:05:49.412700 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m01:05:49.416682 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m01:05:49.427782 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m01:05:49.430131 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5344045, "process_in_blocks": "0", "process_kernel_time": 0.323773, "process_mem_max_rss": "142492", "process_out_blocks": "1984", "process_user_time": 3.176965}
[0m01:05:49.431535 [debug] [MainThread]: Command `dbt test` succeeded at 01:05:49.431234 after 1.54 seconds
[0m01:05:49.432712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a6f534d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a6c415cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a66610110>]}
[0m01:05:49.434404 [debug] [MainThread]: Flushing usage events
[0m01:05:50.232496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:07:33.946681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9331d2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a934c8d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a932207b10>]}


============================== 01:07:33.951227 | 1a1f35f4-a4a0-46fd-8bea-c98dc1e0f48d ==============================
[0m01:07:33.951227 [info ] [MainThread]: Running with dbt=1.11.3
[0m01:07:33.952598 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'version_check': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/bihitche/.dbt', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test --select assert_price', 'no_print': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'cache_selected_only': 'False', 'warn_error': 'None', 'printer_width': '80', 'fail_fast': 'False', 'log_format': 'default', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'write_json': 'True', 'debug': 'False', 'introspect': 'True'}
[0m01:07:34.357805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a1f35f4-a4a0-46fd-8bea-c98dc1e0f48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a932eef5c0>]}
[0m01:07:34.464886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a1f35f4-a4a0-46fd-8bea-c98dc1e0f48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9322b5370>]}
[0m01:07:34.467036 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:07:34.622747 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m01:07:34.755497 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m01:07:34.756223 [debug] [MainThread]: Partial parsing: deleted file: crypto_analytics://tests/assert_price.sql
[0m01:07:34.831404 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m01:07:34.861047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a1f35f4-a4a0-46fd-8bea-c98dc1e0f48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a92c200d50>]}
[0m01:07:34.999993 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m01:07:35.002572 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m01:07:35.032314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a1f35f4-a4a0-46fd-8bea-c98dc1e0f48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9278005f0>]}
[0m01:07:35.033013 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m01:07:35.033765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a1f35f4-a4a0-46fd-8bea-c98dc1e0f48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a92781d1d0>]}
[0m01:07:35.035059 [warn ] [MainThread]: The selection criterion 'assert_price' does not match any enabled nodes
[0m01:07:35.116205 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:07:35.119249 [debug] [MainThread]: Command end result
[0m01:07:35.163143 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m01:07:35.166645 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m01:07:35.173214 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m01:07:35.175569 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.315829, "process_in_blocks": "0", "process_kernel_time": 0.319182, "process_mem_max_rss": "142544", "process_out_blocks": "2928", "process_user_time": 2.795838}
[0m01:07:35.176673 [debug] [MainThread]: Command `dbt test` succeeded at 01:07:35.176468 after 1.32 seconds
[0m01:07:35.177522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a9279ebd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a932209cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a92c5f4110>]}
[0m01:07:35.178443 [debug] [MainThread]: Flushing usage events
[0m01:07:36.112746 [debug] [MainThread]: An error was encountered while trying to flush usage events
==================== 2026-02-12T00:11:23.833391Z | 019c4f30-2f1c-7300-a2de-ba1c0a2f530f ====================
00:11:23.839001 [info ]: dbt-fusion 2.0.0-preview.110
00:11:23.847086 [info ]: Started loading project
00:11:23.892074 [info ]: Loading ~/.dbt/profiles.yml
00:11:23.903632 [info ]: Finished loading project [  0.06s]
00:11:23.910103 [error]: dbt1005: Failed to parse profiles.yml: unknown variant `duckdb`, expected one of `redshift`, `snowflake`, `postgres`, `bigquery`, `trino`, `datafusion`, `spark`, `databricks`, `salesforce`
00:11:24.167361 [info ]: 
==================== Execution Summary =====================
Finished 'test' with 1 error [333ms]
[0m01:11:44.932827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e16fd6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e18a35090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1600fb10>]}


============================== 01:11:44.936907 | c12bd7eb-2a8b-4a7f-9015-010bc5e579b6 ==============================
[0m01:11:44.936907 [info ] [MainThread]: Running with dbt=1.11.3
[0m01:11:44.937857 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'version_check': 'True', 'cache_selected_only': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'use_colors': 'True', 'no_print': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'introspect': 'True', 'debug': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'empty': 'None'}
[0m01:11:45.285420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c12bd7eb-2a8b-4a7f-9015-010bc5e579b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e16cf75c0>]}
[0m01:11:45.393517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c12bd7eb-2a8b-4a7f-9015-010bc5e579b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e160bd370>]}
[0m01:11:45.395497 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:11:45.534460 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m01:11:45.641789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m01:11:45.642578 [debug] [MainThread]: Partial parsing: added file: crypto_analytics://tests/schema.yml
[0m01:11:45.643112 [debug] [MainThread]: Partial parsing: added file: crypto_analytics://tests/assert_price.sql
[0m01:11:45.841502 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'assert_high_prices' in the 'data_tests' section of file 'tests/schema.yml'
[0m01:11:45.842466 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.assert_price' (tests/assert_price.sql) depends on a node named 'stg_prices' in package '' which was not found
[0m01:11:46.019275 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m01:11:46.043173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c12bd7eb-2a8b-4a7f-9015-010bc5e579b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e15f25550>]}
[0m01:11:46.211986 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m01:11:46.214497 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m01:11:46.243255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c12bd7eb-2a8b-4a7f-9015-010bc5e579b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0f79e210>]}
[0m01:11:46.244186 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m01:11:46.245144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12bd7eb-2a8b-4a7f-9015-010bc5e579b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e15d9fe70>]}
[0m01:11:46.247610 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:11:46.248596 [debug] [MainThread]: Command end result
[0m01:11:46.287049 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m01:11:46.289968 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m01:11:46.295662 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m01:11:46.297395 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4606013, "process_in_blocks": "0", "process_kernel_time": 0.309388, "process_mem_max_rss": "144004", "process_out_blocks": "2944", "process_user_time": 2.956155}
[0m01:11:46.298526 [debug] [MainThread]: Command `dbt test` succeeded at 01:11:46.298336 after 1.46 seconds
[0m01:11:46.299412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0f60fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e16011cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0f6084d0>]}
[0m01:11:46.300286 [debug] [MainThread]: Flushing usage events
[0m01:11:47.199709 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:13:44.135788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f524dbd2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f524f691090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f524cc0bb10>]}


============================== 01:13:44.139941 | 0cd604eb-4aa7-4aeb-b96d-9c55910374ad ==============================
[0m01:13:44.139941 [info ] [MainThread]: Running with dbt=1.11.3
[0m01:13:44.141185 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/bihitche/.dbt', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'printer_width': '80', 'log_format': 'default', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'empty': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'static_parser': 'True'}
[0m01:13:44.531407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cd604eb-4aa7-4aeb-b96d-9c55910374ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f524d8f35c0>]}
[0m01:13:44.695876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cd604eb-4aa7-4aeb-b96d-9c55910374ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f524ccb9370>]}
[0m01:13:44.698360 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:13:44.876325 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m01:13:45.053137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:13:45.054655 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://tests/schema.yml
[0m01:13:45.246168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cd604eb-4aa7-4aeb-b96d-9c55910374ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5246505d50>]}
[0m01:13:45.484550 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m01:13:45.488162 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m01:13:45.522590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cd604eb-4aa7-4aeb-b96d-9c55910374ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52463c05f0>]}
[0m01:13:45.523726 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m01:13:45.524767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cd604eb-4aa7-4aeb-b96d-9c55910374ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f524c999d30>]}
[0m01:13:45.528411 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:13:45.530033 [debug] [MainThread]: Command end result
[0m01:13:45.584193 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m01:13:45.588100 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m01:13:45.595044 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m01:13:45.597056 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5504307, "process_in_blocks": "0", "process_kernel_time": 0.31529, "process_mem_max_rss": "142896", "process_out_blocks": "2960", "process_user_time": 3.052128}
[0m01:13:45.598335 [debug] [MainThread]: Command `dbt test` succeeded at 01:13:45.598145 after 1.55 seconds
[0m01:13:45.599357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f524635fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f524cc0dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f524642ae10>]}
[0m01:13:45.600265 [debug] [MainThread]: Flushing usage events
[0m01:13:46.499148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:02.513426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792e1e7e6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792e20271090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792e1d81fb10>]}


============================== 01:14:02.518245 | 5885cc02-8c19-4572-9c2a-3710666aab6d ==============================
[0m01:14:02.518245 [info ] [MainThread]: Running with dbt=1.11.3
[0m01:14:02.519470 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '/home/bihitche/.dbt', 'indirect_selection': 'eager', 'empty': 'None', 'printer_width': '80', 'warn_error': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'fail_fast': 'False', 'write_json': 'True', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True'}
[0m01:14:02.963933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5885cc02-8c19-4572-9c2a-3710666aab6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792e1e5075c0>]}
[0m01:14:03.137348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5885cc02-8c19-4572-9c2a-3710666aab6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792e1d8cd370>]}
[0m01:14:03.141143 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:14:03.315765 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m01:14:03.479292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:14:03.480082 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:14:03.480690 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:14:03.526810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5885cc02-8c19-4572-9c2a-3710666aab6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792e17119050>]}
[0m01:14:03.680617 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m01:14:03.684901 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m01:14:03.722414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5885cc02-8c19-4572-9c2a-3710666aab6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792e16ffc5f0>]}
[0m01:14:03.723924 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m01:14:03.725380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5885cc02-8c19-4572-9c2a-3710666aab6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792e16e19010>]}
[0m01:14:03.737171 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:14:03.741550 [debug] [MainThread]: Command end result
[0m01:14:03.895458 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m01:14:03.898400 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m01:14:03.904679 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m01:14:03.906461 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5018507, "process_in_blocks": "0", "process_kernel_time": 0.333606, "process_mem_max_rss": "142568", "process_out_blocks": "1968", "process_user_time": 2.962508}
[0m01:14:03.907688 [debug] [MainThread]: Command `dbt test` succeeded at 01:14:03.907452 after 1.50 seconds
[0m01:14:03.908664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792e20948d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792e1d821cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792e17a08110>]}
[0m01:14:03.909758 [debug] [MainThread]: Flushing usage events
[0m01:14:04.828004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:27.495981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79027dadeba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79027f531090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79027cb13b10>]}


============================== 02:04:27.500214 | bd7fab02-85d4-42c0-95e2-0968367bf9a0 ==============================
[0m02:04:27.500214 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:04:27.501518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error': 'None', 'introspect': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'invocation_command': 'dbt test --select assert_price', 'profiles_dir': '/home/bihitche/.dbt', 'debug': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'empty': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False'}
[0m02:04:27.867164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd7fab02-85d4-42c0-95e2-0968367bf9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79027d7fb5c0>]}
[0m02:04:27.976381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd7fab02-85d4-42c0-95e2-0968367bf9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79027cbc1370>]}
[0m02:04:27.978454 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:04:28.120482 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m02:04:28.245105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:04:28.245715 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m02:04:28.246445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:04:28.254036 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m02:04:28.321651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd7fab02-85d4-42c0-95e2-0968367bf9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790276f05d50>]}
[0m02:04:28.444608 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:04:28.447193 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:04:28.473619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd7fab02-85d4-42c0-95e2-0968367bf9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7902762685f0>]}
[0m02:04:28.474313 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m02:04:28.474892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd7fab02-85d4-42c0-95e2-0968367bf9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7902762909f0>]}
[0m02:04:28.475764 [warn ] [MainThread]: The selection criterion 'assert_price' does not match any enabled nodes
[0m02:04:28.477985 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:04:28.481008 [debug] [MainThread]: Command end result
[0m02:04:28.609742 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:04:28.613830 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:04:28.618955 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m02:04:28.620680 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2147466, "process_in_blocks": "1592", "process_kernel_time": 0.335441, "process_mem_max_rss": "141972", "process_out_blocks": "1992", "process_user_time": 2.864231}
[0m02:04:28.621494 [debug] [MainThread]: Command `dbt test` succeeded at 02:04:28.621309 after 1.22 seconds
[0m02:04:28.622133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790276287d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79027cb15cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790276d10110>]}
[0m02:04:28.622784 [debug] [MainThread]: Flushing usage events
[0m02:04:29.630069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:09:02.513668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe7f3daa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe80e951d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe7e40bd90>]}


============================== 02:09:02.518391 | 03950835-2b17-45bb-89c6-84bf5d91940b ==============================
[0m02:09:02.518391 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:09:02.520064 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'cache_selected_only': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'introspect': 'True', 'empty': 'False', 'log_format': 'default', 'version_check': 'True', 'warn_error': 'None', 'printer_width': '80', 'use_colors': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'target_path': 'None', 'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'debug': 'False', 'log_cache_events': 'False'}
[0m02:09:02.989672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03950835-2b17-45bb-89c6-84bf5d91940b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe7f0ef490>]}
[0m02:09:03.119963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03950835-2b17-45bb-89c6-84bf5d91940b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe7e4b5260>]}
[0m02:09:03.122657 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:09:03.308694 [debug] [MainThread]: checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9, vars: {}, profile: , target: duck, version: 1.11.3
[0m02:09:03.490912 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:09:03.491903 [debug] [MainThread]: previous checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9, current checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6
[0m02:09:03.493000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '03950835-2b17-45bb-89c6-84bf5d91940b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe7e31b850>]}
[0m02:09:06.191984 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.assert_price' (tests/assert_price.sql) depends on a node named 'stg_prices' in package '' which was not found
[0m02:09:06.370096 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m02:09:06.394368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03950835-2b17-45bb-89c6-84bf5d91940b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe781f7a70>]}
[0m02:09:06.571882 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:09:06.578361 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:09:06.823572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03950835-2b17-45bb-89c6-84bf5d91940b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe72bf8d70>]}
[0m02:09:06.824727 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m02:09:06.828149 [info ] [MainThread]: 
[0m02:09:06.828992 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m02:09:06.830053 [info ] [MainThread]: 
[0m02:09:06.831666 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:09:06.834160 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m02:09:06.912183 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m02:09:06.913641 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m02:09:06.914932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:22.963712 [debug] [ThreadPool]: SQL status: OK in 16.048 seconds
[0m02:09:22.974652 [debug] [ThreadPool]: On list_crypto_database: Close
[0m02:09:22.981502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m02:09:22.985934 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m02:09:23.039988 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m02:09:23.044074 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m02:09:23.047859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:23.059404 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:09:23.065583 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m02:09:23.066808 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m02:09:23.069646 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m02:09:23.070667 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m02:09:23.072267 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m02:09:23.115719 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m02:09:23.118194 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m02:09:23.119370 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m02:09:23.120829 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m02:09:23.160824 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m02:09:23.162363 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m02:09:23.180902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m02:09:23.197913 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m02:09:23.198780 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m02:09:23.200202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:23.203170 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:09:23.204330 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m02:09:23.205574 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m02:09:23.251318 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m02:09:23.253214 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m02:09:23.255103 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m02:09:23.255820 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m02:09:23.258350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03950835-2b17-45bb-89c6-84bf5d91940b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe72ddf520>]}
[0m02:09:23.259609 [debug] [MainThread]: Using duckdb connection "master"
[0m02:09:23.260290 [debug] [MainThread]: On master: BEGIN
[0m02:09:23.261339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:09:23.264141 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m02:09:23.264751 [debug] [MainThread]: On master: COMMIT
[0m02:09:23.265297 [debug] [MainThread]: Using duckdb connection "master"
[0m02:09:23.265928 [debug] [MainThread]: On master: COMMIT
[0m02:09:23.267137 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:09:23.267755 [debug] [MainThread]: On master: Close
[0m02:09:23.272044 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m02:09:23.273117 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg__prices ................................... [RUN]
[0m02:09:23.274238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m02:09:23.275075 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m02:09:23.285258 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m02:09:23.286540 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m02:09:23.363585 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m02:09:23.365975 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m02:09:23.367653 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m02:09:23.368915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:23.372334 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:09:23.373606 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m02:09:23.374396 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_database"."main"."stg__prices__dbt_tmp" as (
    select
    id as coin_id,
    symbol,
    current_price as usd_price,
    price_change_percentage_24h as daily_change,
    
    now() as ingested_at 
from "crypto_database"."crypto_raw"."raw_prices"
  );

[0m02:09:23.422667 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m02:09:23.438672 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m02:09:23.440023 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */
alter view "crypto_database"."main"."stg__prices" rename to "stg__prices__dbt_backup"
[0m02:09:23.483117 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m02:09:23.487875 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m02:09:23.488575 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */
alter view "crypto_database"."main"."stg__prices__dbt_tmp" rename to "stg__prices"
[0m02:09:23.531100 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m02:09:23.548567 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m02:09:23.549651 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m02:09:23.550917 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m02:09:23.645191 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m02:09:23.681945 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m02:09:23.686740 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop view if exists "crypto_database"."main"."stg__prices__dbt_backup" cascade
    
[0m02:09:23.792155 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m02:09:23.804120 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m02:09:23.813101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03950835-2b17-45bb-89c6-84bf5d91940b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe72e74650>]}
[0m02:09:23.814942 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg__prices .............................. [[32mOK[0m in 0.53s]
[0m02:09:23.817469 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m02:09:23.821559 [debug] [MainThread]: Using duckdb connection "master"
[0m02:09:23.823147 [debug] [MainThread]: On master: BEGIN
[0m02:09:23.824592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:09:23.827622 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m02:09:23.828751 [debug] [MainThread]: On master: COMMIT
[0m02:09:23.830085 [debug] [MainThread]: Using duckdb connection "master"
[0m02:09:23.831327 [debug] [MainThread]: On master: COMMIT
[0m02:09:23.833966 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:09:23.834990 [debug] [MainThread]: On master: Close
[0m02:09:23.835795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:23.836594 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m02:09:23.837311 [info ] [MainThread]: 
[0m02:09:23.838269 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 17.01 seconds (17.01s).
[0m02:09:23.840742 [debug] [MainThread]: Command end result
[0m02:09:23.933743 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:09:23.938008 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:09:23.954947 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m02:09:23.958008 [info ] [MainThread]: 
[0m02:09:23.960712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:09:23.963155 [info ] [MainThread]: 
[0m02:09:23.964313 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:09:23.971532 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 21.610943, "process_in_blocks": "100784", "process_kernel_time": 0.602677, "process_mem_max_rss": "215840", "process_out_blocks": "4208", "process_user_time": 7.619356}
[0m02:09:23.974164 [debug] [MainThread]: Command `cli build` succeeded at 02:09:23.973649 after 21.61 seconds
[0m02:09:23.975935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe72b32c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe72d868f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70fe72d86e90>]}
[0m02:09:23.977452 [debug] [MainThread]: Flushing usage events
[0m02:09:24.849161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:14:31.637673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd28daba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd4331090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd1913b10>]}


============================== 02:14:31.642585 | d3adf763-7a6e-4b5f-866c-4903a5ff2f1c ==============================
[0m02:14:31.642585 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:14:31.644148 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'empty': 'None', 'version_check': 'True', 'warn_error': 'None', 'invocation_command': 'dbt test --select assert_price', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'no_print': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'introspect': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'fail_fast': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m02:14:32.094962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3adf763-7a6e-4b5f-866c-4903a5ff2f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd25fb5c0>]}
[0m02:14:32.230205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3adf763-7a6e-4b5f-866c-4903a5ff2f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd19c1370>]}
[0m02:14:32.232653 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:14:32.412122 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m02:14:32.575931 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:14:32.577130 [debug] [MainThread]: previous checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, current checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9
[0m02:14:32.578261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd3adf763-7a6e-4b5f-866c-4903a5ff2f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd1827b50>]}
[0m02:14:34.330891 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.assert_price' (tests/assert_price.sql) depends on a node named 'stg_prices' in package '' which was not found
[0m02:14:34.460095 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m02:14:34.473326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3adf763-7a6e-4b5f-866c-4903a5ff2f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfcb243200>]}
[0m02:14:34.617913 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:14:34.620356 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:14:34.647175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3adf763-7a6e-4b5f-866c-4903a5ff2f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfca422510>]}
[0m02:14:34.647845 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m02:14:34.648552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3adf763-7a6e-4b5f-866c-4903a5ff2f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfca5e36c0>]}
[0m02:14:34.649783 [warn ] [MainThread]: The selection criterion 'assert_price' does not match any enabled nodes
[0m02:14:34.651495 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:14:34.652394 [debug] [MainThread]: Command end result
[0m02:14:34.693841 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:14:34.696795 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:14:34.702488 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m02:14:34.704302 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.1727, "process_in_blocks": "64", "process_kernel_time": 0.354831, "process_mem_max_rss": "150120", "process_out_blocks": "2960", "process_user_time": 5.110177}
[0m02:14:34.705381 [debug] [MainThread]: Command `dbt test` succeeded at 02:14:34.705193 after 3.17 seconds
[0m02:14:34.706251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd1915cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfca59f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfca59fb70>]}
[0m02:14:34.707120 [debug] [MainThread]: Flushing usage events
[0m02:14:35.635429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:26:44.271447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7292f2dceba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7292f4781090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7292f1e07b10>]}


============================== 02:26:44.277857 | a10f3ce9-0e32-401b-acb4-f78ee216f8da ==============================
[0m02:26:44.277857 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:26:44.279098 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'printer_width': '80', 'debug': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'invocation_command': 'dbt test', 'profiles_dir': '/home/bihitche/.dbt', 'use_colors': 'True', 'write_json': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'empty': 'None', 'introspect': 'True', 'target_path': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_cache_events': 'False'}
[0m02:26:44.635071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a10f3ce9-0e32-401b-acb4-f78ee216f8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7292f2aef5c0>]}
[0m02:26:44.743827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a10f3ce9-0e32-401b-acb4-f78ee216f8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7292f1eb5370>]}
[0m02:26:44.745926 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:26:44.892543 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m02:26:45.034256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:26:45.034896 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m02:26:45.035375 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:26:45.089152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a10f3ce9-0e32-401b-acb4-f78ee216f8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7292f1d1eb50>]}
[0m02:26:45.229460 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:26:45.233399 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:26:45.389422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a10f3ce9-0e32-401b-acb4-f78ee216f8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7292eb5fc5f0>]}
[0m02:26:45.390931 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 472 macros
[0m02:26:45.392124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a10f3ce9-0e32-401b-acb4-f78ee216f8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7292ec130e50>]}
[0m02:26:45.396706 [info ] [MainThread]: 
[0m02:26:45.397810 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m02:26:45.398848 [info ] [MainThread]: 
[0m02:26:45.400210 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:26:45.410318 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database_main'
[0m02:26:45.493901 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m02:26:45.494737 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m02:26:45.495490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:46.859541 [debug] [ThreadPool]: SQL status: OK in 1.364 seconds
[0m02:26:46.861540 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m02:26:46.863774 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m02:26:46.905824 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m02:26:46.907738 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m02:26:46.911886 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m02:26:46.912524 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m02:26:46.914381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a10f3ce9-0e32-401b-acb4-f78ee216f8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7292eab62820>]}
[0m02:26:46.915092 [debug] [MainThread]: Using duckdb connection "master"
[0m02:26:46.915593 [debug] [MainThread]: On master: BEGIN
[0m02:26:46.916041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:26:46.917730 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:26:46.918308 [debug] [MainThread]: On master: COMMIT
[0m02:26:46.918799 [debug] [MainThread]: Using duckdb connection "master"
[0m02:26:46.919238 [debug] [MainThread]: On master: COMMIT
[0m02:26:46.920248 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:26:46.920799 [debug] [MainThread]: On master: Close
[0m02:26:46.924486 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3
[0m02:26:46.925247 [debug] [Thread-2 (]: Began running node test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d
[0m02:26:46.926192 [info ] [Thread-1 (]: 1 of 2 START test not_null_coin_trends_symbol .................................. [RUN]
[0m02:26:46.927012 [info ] [Thread-2 (]: 2 of 2 START test unique_coin_trends_symbol .................................... [RUN]
[0m02:26:46.928214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3)
[0m02:26:46.929477 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d'
[0m02:26:46.930522 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3
[0m02:26:46.931183 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d
[0m02:26:46.976287 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"
[0m02:26:46.984092 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"
[0m02:26:46.986392 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d
[0m02:26:46.993092 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3
[0m02:26:47.043127 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"
[0m02:26:47.044027 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"
[0m02:26:47.045676 [debug] [Thread-1 (]: Using duckdb connection "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"
[0m02:26:47.046874 [debug] [Thread-2 (]: Using duckdb connection "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"
[0m02:26:47.047438 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3: BEGIN
[0m02:26:47.047994 [debug] [Thread-2 (]: On test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d: BEGIN
[0m02:26:47.048573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:26:47.049108 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:26:47.050886 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m02:26:47.051587 [debug] [Thread-2 (]: Using duckdb connection "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"
[0m02:26:47.052173 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:26:47.052729 [debug] [Thread-2 (]: On test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    symbol as unique_field,
    count(*) as n_records

from "crypto_database"."main"."coin_trends"
where symbol is not null
group by symbol
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:26:47.053312 [debug] [Thread-1 (]: Using duckdb connection "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"
[0m02:26:47.054220 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_database"."main"."coin_trends"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m02:26:47.110110 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m02:26:47.110961 [debug] [Thread-2 (]: SQL status: OK in 0.057 seconds
[0m02:26:47.116748 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3: ROLLBACK
[0m02:26:47.118898 [debug] [Thread-2 (]: On test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d: ROLLBACK
[0m02:26:47.119923 [debug] [Thread-1 (]: Failed to rollback 'test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3'
[0m02:26:47.120554 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3: Close
[0m02:26:47.121477 [debug] [Thread-2 (]: Failed to rollback 'test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d'
[0m02:26:47.122541 [info ] [Thread-1 (]: 1 of 2 PASS not_null_coin_trends_symbol ........................................ [[32mPASS[0m in 0.19s]
[0m02:26:47.123350 [debug] [Thread-2 (]: On test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d: Close
[0m02:26:47.124619 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3
[0m02:26:47.126139 [error] [Thread-2 (]: 2 of 2 FAIL 98 unique_coin_trends_symbol ....................................... [[31mFAIL 98[0m in 0.20s]
[0m02:26:47.127209 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d
[0m02:26:47.129664 [debug] [MainThread]: Using duckdb connection "master"
[0m02:26:47.130760 [debug] [MainThread]: On master: BEGIN
[0m02:26:47.131290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:26:47.133691 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:26:47.134798 [debug] [MainThread]: On master: COMMIT
[0m02:26:47.135880 [debug] [MainThread]: Using duckdb connection "master"
[0m02:26:47.136526 [debug] [MainThread]: On master: COMMIT
[0m02:26:47.137867 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:26:47.138599 [debug] [MainThread]: On master: Close
[0m02:26:47.139322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:26:47.139926 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3' was properly closed.
[0m02:26:47.140566 [debug] [MainThread]: Connection 'test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d' was properly closed.
[0m02:26:47.141262 [info ] [MainThread]: 
[0m02:26:47.142163 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m02:26:47.144259 [debug] [MainThread]: Command end result
[0m02:26:47.188636 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:26:47.192026 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:26:47.205595 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m02:26:47.206412 [info ] [MainThread]: 
[0m02:26:47.207325 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:26:47.208163 [info ] [MainThread]: 
[0m02:26:47.209099 [error] [MainThread]: [31mFailure in test unique_coin_trends_symbol (models/marts/schema.yml)[0m
[0m02:26:47.210048 [error] [MainThread]:   Got 98 results, configured to fail if != 0
[0m02:26:47.210822 [info ] [MainThread]: 
[0m02:26:47.215227 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics/models/marts/schema.yml/unique_coin_trends_symbol.sql
[0m02:26:47.216117 [info ] [MainThread]: 
[0m02:26:47.217114 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m02:26:47.218916 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.0374846, "process_in_blocks": "85264", "process_kernel_time": 0.481978, "process_mem_max_rss": "188268", "process_out_blocks": "2072", "process_user_time": 4.308866}
[0m02:26:47.220843 [debug] [MainThread]: Command `dbt test` failed at 02:26:47.220598 after 3.04 seconds
[0m02:26:47.222376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7292f1e09cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7292eabc1440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7292eabc1390>]}
[0m02:26:47.223675 [debug] [MainThread]: Flushing usage events
[0m02:26:48.310736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:27:23.876262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2ed8deba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2ef345090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2ec917b10>]}


============================== 02:27:23.880483 | 2b559bcd-cdc8-4f0c-b110-36eecd57e2a4 ==============================
[0m02:27:23.880483 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:27:23.881379 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'use_colors': 'True', 'invocation_command': 'dbt test', 'fail_fast': 'False', 'empty': 'None', 'write_json': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'version_check': 'True'}
[0m02:27:24.275647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b559bcd-cdc8-4f0c-b110-36eecd57e2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2ed5ff5c0>]}
[0m02:27:24.436727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b559bcd-cdc8-4f0c-b110-36eecd57e2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2ec9c5370>]}
[0m02:27:24.439734 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:27:24.666778 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m02:27:24.896019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:27:24.897176 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m02:27:24.898051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:27:24.975742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b559bcd-cdc8-4f0c-b110-36eecd57e2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2e6d07b50>]}
[0m02:27:25.183628 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:27:25.186682 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:27:25.218233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b559bcd-cdc8-4f0c-b110-36eecd57e2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2e60905f0>]}
[0m02:27:25.219072 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m02:27:25.220139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b559bcd-cdc8-4f0c-b110-36eecd57e2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2e60b51d0>]}
[0m02:27:25.223375 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:27:25.227263 [debug] [MainThread]: Command end result
[0m02:27:25.405196 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:27:25.407961 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:27:25.414743 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m02:27:25.416946 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6383241, "process_in_blocks": "0", "process_kernel_time": 0.32634, "process_mem_max_rss": "142380", "process_out_blocks": "1992", "process_user_time": 3.097247}
[0m02:27:25.418241 [debug] [MainThread]: Command `dbt test` succeeded at 02:27:25.417958 after 1.64 seconds
[0m02:27:25.419278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2e61fb520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2ec919cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2e6b14110>]}
[0m02:27:25.420355 [debug] [MainThread]: Flushing usage events
[0m02:27:26.199096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:29:03.214857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd848acaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd84a585090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd847b03b10>]}


============================== 02:29:03.218953 | 9d6cd84d-357b-432b-97ed-66fe1fbf496e ==============================
[0m02:29:03.218953 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:29:03.220170 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/bihitche/.dbt', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'partial_parse': 'True', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select assert_valid_price_range', 'indirect_selection': 'eager', 'empty': 'None', 'write_json': 'True'}
[0m02:29:03.569254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d6cd84d-357b-432b-97ed-66fe1fbf496e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd8487eb5c0>]}
[0m02:29:03.679963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d6cd84d-357b-432b-97ed-66fe1fbf496e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd847bb1370>]}
[0m02:29:03.682568 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:29:03.823941 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m02:29:03.959577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:29:03.960378 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://tests/schema.yml
[0m02:29:03.988464 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'assert_valid_price_range' in the 'data_tests' section of file 'tests/schema.yml'
[0m02:29:04.127849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d6cd84d-357b-432b-97ed-66fe1fbf496e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd8415f4e50>]}
[0m02:29:04.342766 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:29:04.346001 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:29:04.376179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d6cd84d-357b-432b-97ed-66fe1fbf496e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd8412f45f0>]}
[0m02:29:04.376945 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m02:29:04.377586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d6cd84d-357b-432b-97ed-66fe1fbf496e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd841f67310>]}
[0m02:29:04.378491 [warn ] [MainThread]: The selection criterion 'assert_valid_price_range' does not match any enabled nodes
[0m02:29:04.380338 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:29:04.381490 [debug] [MainThread]: Command end result
[0m02:29:04.422096 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:29:04.425547 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:29:04.432009 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m02:29:04.434028 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3071597, "process_in_blocks": "0", "process_kernel_time": 0.299969, "process_mem_max_rss": "143224", "process_out_blocks": "2976", "process_user_time": 2.851711}
[0m02:29:04.435202 [debug] [MainThread]: Command `dbt test` succeeded at 02:29:04.434998 after 1.31 seconds
[0m02:29:04.436107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd84123fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd847b05cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd841f63350>]}
[0m02:29:04.437259 [debug] [MainThread]: Flushing usage events
[0m02:29:05.327326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:29:54.650100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccfb71caba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccfb8c35090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccfb6203b10>]}


============================== 02:29:54.656589 | 3cbc9256-3540-4dde-869a-a508a1408339 ==============================
[0m02:29:54.656589 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:29:54.658354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'invocation_command': 'dbt test --select assert_valid_price_range', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'profiles_dir': '/home/bihitche/.dbt', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True'}
[0m02:29:55.097266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cbc9256-3540-4dde-869a-a508a1408339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccfb6eeb5c0>]}
[0m02:29:55.237174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cbc9256-3540-4dde-869a-a508a1408339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccfb62b1370>]}
[0m02:29:55.240152 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:29:55.418338 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m02:29:55.590478 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m02:29:55.716569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cbc9256-3540-4dde-869a-a508a1408339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccfb03f4c50>]}
[0m02:29:55.876429 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:29:55.879609 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:29:55.915107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cbc9256-3540-4dde-869a-a508a1408339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccfab9b45f0>]}
[0m02:29:55.915927 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m02:29:55.916798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cbc9256-3540-4dde-869a-a508a1408339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccfab9d5630>]}
[0m02:29:55.918223 [warn ] [MainThread]: The selection criterion 'assert_valid_price_range' does not match any enabled nodes
[0m02:29:55.999058 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:29:56.004315 [debug] [MainThread]: Command end result
[0m02:29:56.056729 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:29:56.061065 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:29:56.069076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m02:29:56.071007 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5449175, "process_in_blocks": "0", "process_kernel_time": 0.374243, "process_mem_max_rss": "142244", "process_out_blocks": "2968", "process_user_time": 3.479664}
[0m02:29:56.072086 [debug] [MainThread]: Command `dbt test` succeeded at 02:29:56.071898 after 1.55 seconds
[0m02:29:56.072980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccfb01d0120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccfb6205cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccfb05ec650>]}
[0m02:29:56.073995 [debug] [MainThread]: Flushing usage events
[0m02:29:56.833677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:31:48.761842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4261bd2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4263585090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4260c0bb10>]}


============================== 02:31:48.766995 | 64c61d0e-72cd-47e0-8f34-8e011b007cf8 ==============================
[0m02:31:48.766995 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:31:48.768616 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select assert_valid_price_range', 'static_parser': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'debug': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'log_format': 'default', 'empty': 'None', 'printer_width': '80'}
[0m02:31:49.177212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64c61d0e-72cd-47e0-8f34-8e011b007cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b42618f35c0>]}
[0m02:31:49.289048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64c61d0e-72cd-47e0-8f34-8e011b007cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4260cb9370>]}
[0m02:31:49.291071 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:31:49.443966 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m02:31:49.579988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:31:49.580549 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m02:31:49.581024 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:31:49.621281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64c61d0e-72cd-47e0-8f34-8e011b007cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4260b1bb50>]}
[0m02:31:49.764398 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:31:49.767247 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:31:49.793787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64c61d0e-72cd-47e0-8f34-8e011b007cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b425a3885f0>]}
[0m02:31:49.794863 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m02:31:49.795757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64c61d0e-72cd-47e0-8f34-8e011b007cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b425a3ad1d0>]}
[0m02:31:49.796947 [warn ] [MainThread]: The selection criterion 'assert_valid_price_range' does not match any enabled nodes
[0m02:31:49.799204 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:31:49.802502 [debug] [MainThread]: Command end result
[0m02:31:49.937594 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:31:49.940759 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:31:49.945231 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m02:31:49.947130 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2763208, "process_in_blocks": "0", "process_kernel_time": 0.307097, "process_mem_max_rss": "142488", "process_out_blocks": "1992", "process_user_time": 2.816725}
[0m02:31:49.947924 [debug] [MainThread]: Command `dbt test` succeeded at 02:31:49.947766 after 1.28 seconds
[0m02:31:49.948515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b425a4f7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4260c0dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b425aff4110>]}
[0m02:31:49.949108 [debug] [MainThread]: Flushing usage events
[0m02:31:50.804389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:34:15.290466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b88cd6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b8a741090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b87d0bb10>]}


============================== 02:34:15.294642 | 891d4e8e-9e1f-4050-a12d-304e81d04c82 ==============================
[0m02:34:15.294642 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:34:15.295637 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'invocation_command': 'dbt test --select assert_valid_price_range', 'warn_error': 'None', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'use_colors': 'True', 'static_parser': 'True', 'empty': 'None', 'profiles_dir': '/home/bihitche/.dbt', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:34:15.659778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '891d4e8e-9e1f-4050-a12d-304e81d04c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b889f35c0>]}
[0m02:34:15.768140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '891d4e8e-9e1f-4050-a12d-304e81d04c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b87db9370>]}
[0m02:34:15.770265 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:34:15.917542 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m02:34:16.053310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:34:16.054230 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://tests/assert_valid_price_range.sql
[0m02:34:16.220867 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.assert_valid_price_range' (tests/assert_valid_price_range.sql) depends on a node named 'stg_prices' in package '' which was not found
[0m02:34:16.346124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '891d4e8e-9e1f-4050-a12d-304e81d04c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b817fda50>]}
[0m02:34:16.572012 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:34:16.574891 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:34:16.602002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '891d4e8e-9e1f-4050-a12d-304e81d04c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b814d5f40>]}
[0m02:34:16.602721 [info ] [MainThread]: Found 2 models, 1 source, 472 macros
[0m02:34:16.603307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '891d4e8e-9e1f-4050-a12d-304e81d04c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b820def90>]}
[0m02:34:16.604252 [warn ] [MainThread]: The selection criterion 'assert_valid_price_range' does not match any enabled nodes
[0m02:34:16.606013 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:34:16.606961 [debug] [MainThread]: Command end result
[0m02:34:16.644203 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:34:16.647728 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:34:16.654735 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m02:34:16.656746 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4532207, "process_in_blocks": "0", "process_kernel_time": 0.298537, "process_mem_max_rss": "143504", "process_out_blocks": "2976", "process_user_time": 3.024315}
[0m02:34:16.657889 [debug] [MainThread]: Command `dbt test` succeeded at 02:34:16.657694 after 1.45 seconds
[0m02:34:16.658824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b814dbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b87d0dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7b87d0cad0>]}
[0m02:34:16.659693 [debug] [MainThread]: Flushing usage events
[0m02:34:17.543549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:34:57.699161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae65fc2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae67a7d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae64ffbb10>]}


============================== 02:34:57.705724 | 05778cd1-ae2f-4a6c-a8a3-986dc7f81e1f ==============================
[0m02:34:57.705724 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:34:57.707009 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_colors': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt test --select assert_valid_price_range', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80'}
[0m02:34:58.089788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05778cd1-ae2f-4a6c-a8a3-986dc7f81e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae65ce35c0>]}
[0m02:34:58.198615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05778cd1-ae2f-4a6c-a8a3-986dc7f81e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae650a9370>]}
[0m02:34:58.200618 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:34:58.348875 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m02:34:58.486902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:34:58.487720 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://tests/assert_valid_price_range.sql
[0m02:34:58.738713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05778cd1-ae2f-4a6c-a8a3-986dc7f81e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5f1f1650>]}
[0m02:34:58.950436 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:34:58.952806 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:34:58.979839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05778cd1-ae2f-4a6c-a8a3-986dc7f81e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5e7c5f40>]}
[0m02:34:58.980946 [info ] [MainThread]: Found 2 models, 1 test, 1 source, 472 macros
[0m02:34:58.981798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05778cd1-ae2f-4a6c-a8a3-986dc7f81e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5f3c74d0>]}
[0m02:34:58.983928 [info ] [MainThread]: 
[0m02:34:58.984696 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m02:34:58.985265 [info ] [MainThread]: 
[0m02:34:58.986116 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:34:58.995001 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database_main'
[0m02:34:59.063183 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m02:34:59.064394 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m02:34:59.065170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:00.367622 [debug] [ThreadPool]: SQL status: OK in 1.302 seconds
[0m02:35:00.371101 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m02:35:00.375040 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m02:35:00.432117 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m02:35:00.434047 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m02:35:00.435272 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m02:35:00.435815 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m02:35:00.437655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05778cd1-ae2f-4a6c-a8a3-986dc7f81e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5dd3f450>]}
[0m02:35:00.438519 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:00.439061 [debug] [MainThread]: On master: BEGIN
[0m02:35:00.439546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:35:00.441189 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:35:00.441792 [debug] [MainThread]: On master: COMMIT
[0m02:35:00.442327 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:00.442882 [debug] [MainThread]: On master: COMMIT
[0m02:35:00.444025 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:00.444647 [debug] [MainThread]: On master: Close
[0m02:35:00.448248 [debug] [Thread-1 (]: Began running node test.crypto_analytics.assert_valid_price_range
[0m02:35:00.449400 [info ] [Thread-1 (]: 1 of 1 START test assert_valid_price_range ..................................... [RUN]
[0m02:35:00.450492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now test.crypto_analytics.assert_valid_price_range)
[0m02:35:00.451595 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.assert_valid_price_range
[0m02:35:00.463320 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.assert_valid_price_range"
[0m02:35:00.465001 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.assert_valid_price_range
[0m02:35:00.506445 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.assert_valid_price_range"
[0m02:35:00.507882 [debug] [Thread-1 (]: Using duckdb connection "test.crypto_analytics.assert_valid_price_range"
[0m02:35:00.508882 [debug] [Thread-1 (]: On test.crypto_analytics.assert_valid_price_range: BEGIN
[0m02:35:00.509775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:00.512223 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:00.513167 [debug] [Thread-1 (]: Using duckdb connection "test.crypto_analytics.assert_valid_price_range"
[0m02:35:00.514077 [debug] [Thread-1 (]: On test.crypto_analytics.assert_valid_price_range: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.assert_valid_price_range"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select 
    symbol,
    high_24h,
    low_24h
from "crypto_database"."main"."stg__prices"
where high_24h < low_24h   -- ❌ No semicolon here!
  
  
      
    ) dbt_internal_test
[0m02:35:00.564278 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.assert_valid_price_range"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select 
    symbol,
    high_24h,
    low_24h
from "crypto_database"."main"."stg__prices"
where high_24h < low_24h   -- ❌ No semicolon here!
  
  
      
    ) dbt_internal_test
[0m02:35:00.565544 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:35:00.566558 [debug] [Thread-1 (]: On test.crypto_analytics.assert_valid_price_range: ROLLBACK
[0m02:35:00.580319 [debug] [Thread-1 (]: Failed to rollback 'test.crypto_analytics.assert_valid_price_range'
[0m02:35:00.581372 [debug] [Thread-1 (]: On test.crypto_analytics.assert_valid_price_range: Close
[0m02:35:00.587422 [debug] [Thread-1 (]: Runtime Error in test assert_valid_price_range (tests/assert_valid_price_range.sql)
  Binder Error: Referenced column "high_24h" not found in FROM clause!
  Candidate bindings: "ingested_at", "coin_id"
  
  LINE 15: where high_24h < low_24h   -- ❌ No semicolon here!
                 ^
[0m02:35:00.588221 [error] [Thread-1 (]: 1 of 1 ERROR assert_valid_price_range .......................................... [[31mERROR[0m in 0.14s]
[0m02:35:00.589124 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.assert_valid_price_range
[0m02:35:00.590162 [debug] [Thread-7 (]: Marking all children of 'test.crypto_analytics.assert_valid_price_range' to be skipped because of status 'error'.  Reason: Runtime Error in test assert_valid_price_range (tests/assert_valid_price_range.sql)
  Binder Error: Referenced column "high_24h" not found in FROM clause!
  Candidate bindings: "ingested_at", "coin_id"
  
  LINE 15: where high_24h < low_24h   -- ❌ No semicolon here!
                 ^.
[0m02:35:00.593654 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:00.594628 [debug] [MainThread]: On master: BEGIN
[0m02:35:00.595649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:35:00.597844 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:35:00.598453 [debug] [MainThread]: On master: COMMIT
[0m02:35:00.599351 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:00.599896 [debug] [MainThread]: On master: COMMIT
[0m02:35:00.601307 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:00.602323 [debug] [MainThread]: On master: Close
[0m02:35:00.603100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:00.603632 [debug] [MainThread]: Connection 'test.crypto_analytics.assert_valid_price_range' was properly closed.
[0m02:35:00.604193 [info ] [MainThread]: 
[0m02:35:00.604782 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m02:35:00.606426 [debug] [MainThread]: Command end result
[0m02:35:00.656017 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m02:35:00.659432 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m02:35:00.671396 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m02:35:00.672321 [info ] [MainThread]: 
[0m02:35:00.673228 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:35:00.674178 [info ] [MainThread]: 
[0m02:35:00.675183 [error] [MainThread]: [31mFailure in test assert_valid_price_range (tests/assert_valid_price_range.sql)[0m
[0m02:35:00.676292 [error] [MainThread]:   Runtime Error in test assert_valid_price_range (tests/assert_valid_price_range.sql)
  Binder Error: Referenced column "high_24h" not found in FROM clause!
  Candidate bindings: "ingested_at", "coin_id"
  
  LINE 15: where high_24h < low_24h   -- ❌ No semicolon here!
                 ^
[0m02:35:00.677429 [info ] [MainThread]: 
[0m02:35:00.678518 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics/tests/assert_valid_price_range.sql
[0m02:35:00.680074 [info ] [MainThread]: 
[0m02:35:00.680945 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m02:35:00.683564 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.1101341, "process_in_blocks": "5616", "process_kernel_time": 0.420045, "process_mem_max_rss": "189536", "process_out_blocks": "3016", "process_user_time": 4.690338}
[0m02:35:00.685624 [debug] [MainThread]: Command `dbt test` failed at 02:35:00.685280 after 3.11 seconds
[0m02:35:00.686597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae64ffdcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5dda9860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5dda9020>]}
[0m02:35:00.687584 [debug] [MainThread]: Flushing usage events
[0m02:35:01.476000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:37:36.581744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750f41fd2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750f43a55090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750f4100bb10>]}


============================== 02:37:36.587072 | 624ad5db-1ce0-40df-ae77-e57a56c6732b ==============================
[0m02:37:36.587072 [info ] [MainThread]: Running with dbt=1.11.3
[0m02:37:36.588454 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/home/bihitche/.dbt', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'empty': 'False', 'debug': 'False', 'invocation_command': 'dbt run', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'log_cache_events': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'fail_fast': 'False', 'printer_width': '80', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'version_check': 'True'}
[0m02:37:37.079788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '624ad5db-1ce0-40df-ae77-e57a56c6732b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750f41cf35c0>]}
[0m02:37:37.217683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '624ad5db-1ce0-40df-ae77-e57a56c6732b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750f410b9370>]}
[0m02:37:37.220018 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:37:37.391721 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m02:37:37.555025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:37:37.555967 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg__prices.sql
[0m02:37:37.932540 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.crypto_analytics.stg__prices' (models/staging/stg__prices.sql) depends on a source named 'crypto_raw.raw_prices' which was not found
[0m02:37:37.934284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4976566, "process_in_blocks": "0", "process_kernel_time": 0.341178, "process_mem_max_rss": "143968", "process_out_blocks": "8", "process_user_time": 3.127466}
[0m02:37:37.935537 [debug] [MainThread]: Command `dbt run` failed at 02:37:37.935310 after 1.50 seconds
[0m02:37:37.936243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750f40f23350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750f40f21950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750f3a8f59a0>]}
[0m02:37:37.937064 [debug] [MainThread]: Flushing usage events
[0m02:37:38.766603 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:59.645678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7304f05eea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7304f209d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7304ef627b10>]}


============================== 12:52:59.650547 | f2cda15f-c9d4-4ce0-8b36-a5e499faedd5 ==============================
[0m12:52:59.650547 [info ] [MainThread]: Running with dbt=1.11.3
[0m12:52:59.651805 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'version_check': 'True', 'fail_fast': 'False', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'write_json': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'log_format': 'default', 'profiles_dir': '/home/bihitche/.dbt', 'invocation_command': 'dbt ', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m12:52:59.924734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2cda15f-c9d4-4ce0-8b36-a5e499faedd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7304f030b5c0>]}
[0m12:52:59.950013 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:52:59.952736 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:52:59.955670 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43965283, "process_in_blocks": "2720", "process_kernel_time": 0.32764, "process_mem_max_rss": "105956", "process_out_blocks": "8", "process_user_time": 3.143173}
[0m12:52:59.957029 [debug] [MainThread]: Command `cli deps` succeeded at 12:52:59.956810 after 0.44 seconds
[0m12:52:59.958016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7304ef24caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7304ef24d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7304ef6bbd50>]}
[0m12:52:59.958731 [debug] [MainThread]: Flushing usage events
[0m12:53:00.826308 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:17.349422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb52ae2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb54585090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb51b17b10>]}


============================== 13:15:17.359010 | e6314170-f85c-4075-a852-93fe647cfad2 ==============================
[0m13:15:17.359010 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:15:17.361035 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'use_experimental_parser': 'False', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'invocation_command': 'dbt ', 'profiles_dir': '/home/bihitche/.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'no_print': 'None', 'introspect': 'True', 'empty': 'None', 'use_colors': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'version_check': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:15:17.602519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6314170-f85c-4075-a852-93fe647cfad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb527fb5c0>]}
[0m13:15:17.619105 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:15:17.620734 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:15:17.623014 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4217398, "process_in_blocks": "9168", "process_kernel_time": 0.316403, "process_mem_max_rss": "106060", "process_out_blocks": "16", "process_user_time": 2.874245}
[0m13:15:17.623742 [debug] [MainThread]: Command `cli deps` succeeded at 13:15:17.623608 after 0.42 seconds
[0m13:15:17.624259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb5174caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb5174d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aeb51babd50>]}
[0m13:15:17.624781 [debug] [MainThread]: Flushing usage events
[0m13:15:18.484639 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:48.439623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d40d8e2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d40f355090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d40c91bb10>]}


============================== 13:16:48.446860 | 538b60c9-3591-4a17-a381-084a7fd123a6 ==============================
[0m13:16:48.446860 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:16:48.448080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'log_format': 'default', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'empty': 'None', 'target_path': 'None', 'use_colors': 'True', 'quiet': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt ', 'cache_selected_only': 'False', 'debug': 'False', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m13:16:48.746539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '538b60c9-3591-4a17-a381-084a7fd123a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d40d5ff5c0>]}
[0m13:16:48.766242 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:16:48.768375 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:16:48.771332 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44890544, "process_in_blocks": "456", "process_kernel_time": 0.247856, "process_mem_max_rss": "105816", "process_out_blocks": "8", "process_user_time": 2.58051}
[0m13:16:48.772826 [debug] [MainThread]: Command `cli deps` succeeded at 13:16:48.772564 after 0.45 seconds
[0m13:16:48.774617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d40c550af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d40c551150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d40c9afd50>]}
[0m13:16:48.775984 [debug] [MainThread]: Flushing usage events
[0m13:16:49.621382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:42.091555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7361a87e6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7361aa249090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7361a781fb10>]}


============================== 13:17:42.099538 | fe760715-80ee-4f99-87f7-378030d20b10 ==============================
[0m13:17:42.099538 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:17:42.101501 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/bihitche/.dbt', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'debug': 'False', 'empty': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'quiet': 'False', 'invocation_command': 'dbt ', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'static_parser': 'True', 'log_format': 'default', 'version_check': 'True'}
[0m13:17:42.402967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe760715-80ee-4f99-87f7-378030d20b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7361a85035c0>]}
[0m13:17:42.430068 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:17:42.434809 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:17:42.437549 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6401949, "process_in_blocks": "46480", "process_kernel_time": 0.464891, "process_mem_max_rss": "105760", "process_out_blocks": "8", "process_user_time": 3.565793}
[0m13:17:42.438392 [debug] [MainThread]: Command `cli deps` succeeded at 13:17:42.438174 after 0.64 seconds
[0m13:17:42.438942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7361a7448af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7361a7449150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7361a78b3d50>]}
[0m13:17:42.439539 [debug] [MainThread]: Flushing usage events
[0m13:17:43.279802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:22:06.700965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce7e13e2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce7e2e11090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce7e041bb10>]}


============================== 13:22:06.705539 | e5a45193-04ae-4cdc-b55c-26cdab93e309 ==============================
[0m13:22:06.705539 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:22:06.706851 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'introspect': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'quiet': 'False', 'empty': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False'}
[0m13:22:07.199177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5a45193-04ae-4cdc-b55c-26cdab93e309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce7e1103490>]}
[0m13:22:07.363950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5a45193-04ae-4cdc-b55c-26cdab93e309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce7e04c9480>]}
[0m13:22:07.370500 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:22:07.603830 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m13:22:07.774252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:22:07.775705 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg__prices.sql
[0m13:22:08.229300 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.crypto_analytics.stg__prices' (models/staging/stg__prices.sql) depends on a source named 'crypto_raw.raw_prices' which was not found
[0m13:22:08.230858 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6264428, "process_in_blocks": "5384", "process_kernel_time": 0.338862, "process_mem_max_rss": "143412", "process_out_blocks": "16", "process_user_time": 3.174347}
[0m13:22:08.231711 [debug] [MainThread]: Command `dbt run` failed at 13:22:08.231529 after 1.63 seconds
[0m13:22:08.232405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce7e0133450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce7e0131a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce7d9b059a0>]}
[0m13:22:08.233079 [debug] [MainThread]: Flushing usage events
[0m13:22:09.119968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:21.208733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf02dd2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf0488d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf01e0bb10>]}


============================== 13:25:21.213493 | 5d5690f6-92c7-4108-aa78-4447d9e1191c ==============================
[0m13:25:21.213493 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:25:21.215617 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'empty': 'False', 'warn_error': 'None', 'printer_width': '80', 'fail_fast': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'partial_parse': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'debug': 'False'}
[0m13:25:21.703288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d5690f6-92c7-4108-aa78-4447d9e1191c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf02af3490>]}
[0m13:25:21.863701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d5690f6-92c7-4108-aa78-4447d9e1191c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf01eb9480>]}
[0m13:25:21.867256 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:25:22.067721 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m13:25:22.250147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:25:22.251576 [debug] [MainThread]: Partial parsing: added file: crypto_analytics://models/marts/schema.yml
[0m13:25:22.252736 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg__prices.sql
[0m13:25:23.252618 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.crypto_analytics.stg__prices' (models/staging/stg__prices.sql) depends on a source named 'crypto_raw.raw_prices' which was not found
[0m13:25:23.254357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.173435, "process_in_blocks": "0", "process_kernel_time": 0.375087, "process_mem_max_rss": "143792", "process_out_blocks": "16", "process_user_time": 4.40852}
[0m13:25:23.255234 [debug] [MainThread]: Command `dbt run` failed at 13:25:23.255027 after 2.17 seconds
[0m13:25:23.255906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74befbff6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74befbff6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74befb57fc50>]}
[0m13:25:23.256621 [debug] [MainThread]: Flushing usage events
[0m13:25:24.079341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:00.643745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c18fd2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c1a985090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c1800bb10>]}


============================== 13:27:00.649175 | fd38df96-723e-402a-830e-2627a674fa60 ==============================
[0m13:27:00.649175 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:27:00.650633 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'empty': 'False', 'write_json': 'True', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m13:27:01.118641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd38df96-723e-402a-830e-2627a674fa60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c18cf3490>]}
[0m13:27:01.265172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd38df96-723e-402a-830e-2627a674fa60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c180b9480>]}
[0m13:27:01.267479 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:27:01.458388 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m13:27:01.638605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m13:27:01.640847 [debug] [MainThread]: Partial parsing: added file: crypto_analytics://models/marts/schema.yml
[0m13:27:01.643520 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/__sources.yml
[0m13:27:01.645326 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg__prices.sql
[0m13:27:03.007623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd38df96-723e-402a-830e-2627a674fa60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c121f7450>]}
[0m13:27:03.198770 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m13:27:03.202982 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m13:27:03.229450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd38df96-723e-402a-830e-2627a674fa60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c1807bf20>]}
[0m13:27:03.230542 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 472 macros
[0m13:27:03.231513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd38df96-723e-402a-830e-2627a674fa60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c123ec210>]}
[0m13:27:03.235316 [info ] [MainThread]: 
[0m13:27:03.236269 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m13:27:03.237177 [info ] [MainThread]: 
[0m13:27:03.238585 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:27:03.247723 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m13:27:03.361295 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m13:27:03.363075 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m13:27:03.364537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:19.687010 [debug] [ThreadPool]: SQL status: OK in 16.323 seconds
[0m13:27:19.689354 [debug] [ThreadPool]: On list_crypto_database: Close
[0m13:27:19.690537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m13:27:19.691405 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m13:27:19.699560 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m13:27:19.700098 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m13:27:19.700552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:19.703032 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:27:19.704848 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m13:27:19.705355 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m13:27:19.706787 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:27:19.707330 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m13:27:19.707786 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m13:27:19.743039 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m13:27:19.744459 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m13:27:19.745060 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m13:27:19.745593 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m13:27:19.778614 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m13:27:19.779196 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m13:27:19.781031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m13:27:19.788604 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m13:27:19.789128 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m13:27:19.789587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:19.791281 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:27:19.791816 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m13:27:19.792308 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m13:27:19.820888 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m13:27:19.822761 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m13:27:19.823997 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m13:27:19.824509 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m13:27:19.826336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd38df96-723e-402a-830e-2627a674fa60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c1029a340>]}
[0m13:27:19.827042 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:19.827552 [debug] [MainThread]: On master: BEGIN
[0m13:27:19.828000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:19.829777 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:27:19.830369 [debug] [MainThread]: On master: COMMIT
[0m13:27:19.830886 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:19.831570 [debug] [MainThread]: On master: COMMIT
[0m13:27:19.832607 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:27:19.833159 [debug] [MainThread]: On master: Close
[0m13:27:19.836795 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m13:27:19.837567 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg__prices ................................... [RUN]
[0m13:27:19.838282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m13:27:19.838867 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m13:27:19.848600 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m13:27:19.849850 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m13:27:19.905671 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m13:27:19.907744 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m13:27:19.909476 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m13:27:19.911133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:19.915746 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:27:19.917023 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m13:27:19.917988 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_database"."main"."stg__prices__dbt_tmp" as (
    with source as (
    select * from "crypto_db"."crypto_raw"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h as daily_change,
        
        -- The fix you made for the timestamp
        now() as ingested_at
    from source
)

select * from renamed
  );

[0m13:27:19.959501 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m13:27:19.967122 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m13:27:19.967746 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */
alter view "crypto_database"."main"."stg__prices" rename to "stg__prices__dbt_backup"
[0m13:27:20.003568 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m13:27:20.007503 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m13:27:20.008503 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */
alter view "crypto_database"."main"."stg__prices__dbt_tmp" rename to "stg__prices"
[0m13:27:20.056319 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m13:27:20.127275 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m13:27:20.128298 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m13:27:20.129255 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m13:27:20.208073 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m13:27:20.215693 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m13:27:20.216312 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop view if exists "crypto_database"."main"."stg__prices__dbt_backup" cascade
    
[0m13:27:20.288734 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m13:27:20.292186 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m13:27:20.297076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd38df96-723e-402a-830e-2627a674fa60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c10cea990>]}
[0m13:27:20.298060 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg__prices .............................. [[32mOK[0m in 0.46s]
[0m13:27:20.299049 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m13:27:20.300186 [debug] [Thread-2 (]: Began running node model.crypto_analytics.coin_trends
[0m13:27:20.301309 [info ] [Thread-2 (]: 2 of 2 START sql table model main.coin_trends .................................. [RUN]
[0m13:27:20.302170 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.crypto_analytics.coin_trends'
[0m13:27:20.302810 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.coin_trends
[0m13:27:20.315456 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.coin_trends"
[0m13:27:20.316943 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.coin_trends
[0m13:27:20.355400 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.coin_trends"
[0m13:27:20.357163 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m13:27:20.360998 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: BEGIN
[0m13:27:20.362118 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:27:20.364784 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:27:20.365739 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m13:27:20.366683 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */

  
    
    

    create  table
      "crypto_database"."main"."coin_trends__dbt_tmp"
  
    as (
      

with source as (
    -- 1. Grab the clean data from staging
    select * from "crypto_database"."main"."stg__prices"
)

select
    coin_id,
    symbol,
    usd_price,
    daily_change,
    ingested_at,
    
    -- 2. BUSINESS LOGIC: Categorize Volatility
    case 
        when daily_change > 5.0  then '🚀 Mooning'
        when daily_change < -5.0 then '💀 Crashing'
        else '😴 Stable'
    end as volatility_flag,

    -- 3. BUSINESS LOGIC: High Risk Flag (Simple Boolean)
    case
        when abs(daily_change) > 10 then true
        else false
    end as is_high_risk

from source
where daily_change is not null -- Safety check!
    );
  
  
[0m13:27:20.492842 [debug] [Thread-2 (]: SQL status: OK in 0.125 seconds
[0m13:27:20.503108 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m13:27:20.503893 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'coin_trends'
  
[0m13:27:20.505960 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:27:20.508633 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m13:27:20.509335 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'coin_trends'
  
[0m13:27:20.514890 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:27:20.519589 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m13:27:20.520198 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */
alter table "crypto_database"."main"."coin_trends" rename to "coin_trends__dbt_backup"
[0m13:27:20.556739 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m13:27:20.562391 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m13:27:20.563365 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */
alter table "crypto_database"."main"."coin_trends__dbt_tmp" rename to "coin_trends"
[0m13:27:20.600593 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m13:27:20.612264 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: COMMIT
[0m13:27:20.613352 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m13:27:20.614372 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: COMMIT
[0m13:27:20.694098 [debug] [Thread-2 (]: SQL status: OK in 0.079 seconds
[0m13:27:20.699720 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m13:27:20.700761 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */

      drop table if exists "crypto_database"."main"."coin_trends__dbt_backup" cascade
    
[0m13:27:20.784091 [debug] [Thread-2 (]: SQL status: OK in 0.082 seconds
[0m13:27:20.786949 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: Close
[0m13:27:20.788159 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd38df96-723e-402a-830e-2627a674fa60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c101f5180>]}
[0m13:27:20.789647 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.coin_trends ............................. [[32mOK[0m in 0.49s]
[0m13:27:20.791146 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.coin_trends
[0m13:27:20.794135 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:20.795126 [debug] [MainThread]: On master: BEGIN
[0m13:27:20.796312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:20.798630 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:27:20.799269 [debug] [MainThread]: On master: COMMIT
[0m13:27:20.799884 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:20.800794 [debug] [MainThread]: On master: COMMIT
[0m13:27:20.803013 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:27:20.803780 [debug] [MainThread]: On master: Close
[0m13:27:20.804549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:20.805091 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m13:27:20.805695 [debug] [MainThread]: Connection 'model.crypto_analytics.coin_trends' was properly closed.
[0m13:27:20.806306 [info ] [MainThread]: 
[0m13:27:20.807016 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 17.57 seconds (17.57s).
[0m13:27:20.808834 [debug] [MainThread]: Command end result
[0m13:27:20.863022 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m13:27:20.866926 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m13:27:20.879150 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m13:27:20.880112 [info ] [MainThread]: 
[0m13:27:20.881072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:20.881988 [info ] [MainThread]: 
[0m13:27:20.882827 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:27:20.884765 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.353569, "process_in_blocks": "145760", "process_kernel_time": 0.583147, "process_mem_max_rss": "197464", "process_out_blocks": "3072", "process_user_time": 6.829596}
[0m13:27:20.885954 [debug] [MainThread]: Command `dbt run` succeeded at 13:27:20.885718 after 20.35 seconds
[0m13:27:20.886893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c10cd2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c101b28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c18f761d0>]}
[0m13:27:20.887952 [debug] [MainThread]: Flushing usage events
[0m13:27:21.652524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:14.847078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7432a57daa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7432a72891d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7432a480fd90>]}


============================== 13:50:14.855027 | eaa3d78a-2946-4426-b984-70468430d891 ==============================
[0m13:50:14.855027 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:50:14.861300 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'use_colors': 'True', 'debug': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'invocation_command': 'dbt ', 'partial_parse': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False'}
[0m13:50:15.274230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaa3d78a-2946-4426-b984-70468430d891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7432a54f3490>]}
[0m13:50:15.322334 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:50:15.329862 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:50:15.335753 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6635606, "process_in_blocks": "32", "process_kernel_time": 0.411816, "process_mem_max_rss": "105844", "process_out_blocks": "16", "process_user_time": 3.500933}
[0m13:50:15.336950 [debug] [MainThread]: Command `cli deps` succeeded at 13:50:15.336713 after 0.67 seconds
[0m13:50:15.337863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7432a443caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7432a443d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7432a489bd50>]}
[0m13:50:15.349925 [debug] [MainThread]: Flushing usage events
[0m13:50:16.351348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:54.918812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab94bcf2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab94d749090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab94ad27b10>]}


============================== 13:50:54.925109 | 73b853cd-c191-461d-a4b4-39402f42779d ==============================
[0m13:50:54.925109 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:50:54.926475 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'profiles_dir': '/home/bihitche/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt ', 'printer_width': '80', 'fail_fast': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'None'}
[0m13:50:55.277825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73b853cd-c191-461d-a4b4-39402f42779d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab94ba0b5c0>]}
[0m13:50:55.329315 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:50:55.332090 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:50:55.336167 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5640159, "process_in_blocks": "0", "process_kernel_time": 0.342156, "process_mem_max_rss": "105708", "process_out_blocks": "16", "process_user_time": 3.293998}
[0m13:50:55.337348 [debug] [MainThread]: Command `cli deps` succeeded at 13:50:55.337106 after 0.57 seconds
[0m13:50:55.341320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab94a948af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab94a949150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab94adb3d50>]}
[0m13:50:55.342399 [debug] [MainThread]: Flushing usage events
[0m13:50:56.121097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:23.778477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3ef10daba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3ef2b7d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3ef0113b10>]}


============================== 13:55:23.782438 | 04e6d59e-8211-42db-8914-16e466db7604 ==============================
[0m13:55:23.782438 [info ] [MainThread]: Running with dbt=1.11.3
[0m13:55:23.783505 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'empty': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'no_print': 'None', 'introspect': 'True', 'log_format': 'default', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_colors': 'True', 'quiet': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'static_parser': 'True'}
[0m13:55:23.993972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04e6d59e-8211-42db-8914-16e466db7604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3ef0dfb490>]}
[0m13:55:24.010490 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:55:24.011830 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:55:24.013526 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.33023253, "process_in_blocks": "80", "process_kernel_time": 0.226542, "process_mem_max_rss": "106020", "process_out_blocks": "8", "process_user_time": 2.052857}
[0m13:55:24.014607 [debug] [MainThread]: Command `dbt deps` succeeded at 13:55:24.014442 after 0.33 seconds
[0m13:55:24.015477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3eeff1cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3eeff1d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3ef01abd50>]}
[0m13:55:24.016352 [debug] [MainThread]: Flushing usage events
[0m13:55:24.877494 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:42.210581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b437fcaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b439a29090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b436fffb10>]}


============================== 14:37:42.215314 | 12363952-fefa-499d-aa66-f4e5f93f78ed ==============================
[0m14:37:42.215314 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:37:42.216581 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'empty': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'partial_parse': 'True'}
[0m14:37:42.477049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12363952-fefa-499d-aa66-f4e5f93f78ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b437ceb490>]}
[0m14:37:42.500272 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:37:42.501478 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:37:42.503306 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40236062, "process_in_blocks": "1096", "process_kernel_time": 0.322625, "process_mem_max_rss": "105956", "process_out_blocks": "16", "process_user_time": 3.009846}
[0m14:37:42.504045 [debug] [MainThread]: Command `dbt deps` succeeded at 14:37:42.503894 after 0.40 seconds
[0m14:37:42.504617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b436df4d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b436df5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76b43709bd50>]}
[0m14:37:42.505156 [debug] [MainThread]: Flushing usage events
[0m14:37:43.192622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:37.197832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680d8ed6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680da989090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680d7f0bb10>]}


============================== 14:38:37.202079 | f332bc83-aab9-4bd0-b432-2224fbee6f43 ==============================
[0m14:38:37.202079 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:38:37.203001 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'None', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'version_check': 'True', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'fail_fast': 'False', 'log_format': 'default', 'profiles_dir': '/home/bihitche/.dbt', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'write_json': 'True'}
[0m14:38:37.416086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f332bc83-aab9-4bd0-b432-2224fbee6f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680d8bf7490>]}
[0m14:38:37.430333 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hu9op_ej'
[0m14:38:37.431118 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:38:37.625552 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:38:37.627601 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m14:38:37.727612 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m14:38:37.733570 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m14:38:37.735009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f332bc83-aab9-4bd0-b432-2224fbee6f43', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680d7d0dbf0>]}
[0m14:38:37.749106 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m14:38:37.858794 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m14:38:37.871298 [info ] [MainThread]: Updating lock file in file path: /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/package-lock.yml
[0m14:38:37.875966 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8v4rqmcb'
[0m14:38:37.881947 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m14:38:38.585847 [info ] [MainThread]: Installed from version 0.8.0
[0m14:38:38.586477 [info ] [MainThread]: Updated version available: 0.10.4
[0m14:38:38.587250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f332bc83-aab9-4bd0-b432-2224fbee6f43', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680d7fa7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680d7b56c50>]}
[0m14:38:38.588133 [info ] [MainThread]: Installing calogica/dbt_date
[0m14:38:38.930301 [info ] [MainThread]: Installed from version 0.7.2
[0m14:38:38.932923 [info ] [MainThread]: Updated version available: 0.10.1
[0m14:38:38.935681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f332bc83-aab9-4bd0-b432-2224fbee6f43', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680d7d7e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680d7a44ad0>]}
[0m14:38:38.938499 [info ] [MainThread]: 
[0m14:38:38.941261 [info ] [MainThread]: Updates available for packages: ['calogica/dbt_expectations', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m14:38:38.950036 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:38:38.955477 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8461864, "process_in_blocks": "0", "process_kernel_time": 0.367317, "process_mem_max_rss": "114252", "process_out_blocks": "20376", "process_user_time": 3.127186}
[0m14:38:38.958490 [debug] [MainThread]: Command `dbt deps` succeeded at 14:38:38.957893 after 1.85 seconds
[0m14:38:38.960959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680d7c275f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680d7f0dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7680d7cd3c50>]}
[0m14:38:38.963552 [debug] [MainThread]: Flushing usage events
[0m14:38:39.581022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:50.947059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4c0cdaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4c2789090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4bfd0fb10>]}


============================== 14:43:50.953072 | 775be367-2b50-49f5-8e8d-a5826f7ea402 ==============================
[0m14:43:50.953072 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:43:50.954418 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'profiles_dir': '/home/bihitche/.dbt', 'warn_error': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'target_path': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'partial_parse': 'True', 'empty': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m14:43:51.402394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '775be367-2b50-49f5-8e8d-a5826f7ea402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4c09fb490>]}
[0m14:43:51.539073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '775be367-2b50-49f5-8e8d-a5826f7ea402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4bfdc16a0>]}
[0m14:43:51.541303 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:43:51.756416 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m14:43:51.910009 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:43:51.910780 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:43:51.911730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '775be367-2b50-49f5-8e8d-a5826f7ea402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4b97ba250>]}
[0m14:43:54.228653 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between` defined on 'stg__prices'
in package 'crypto_analytics' (models/staging/schema.yml). Arguments to generic
tests should be nested under the `arguments` property.
[0m14:43:54.229515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '775be367-2b50-49f5-8e8d-a5826f7ea402', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4b9628d70>]}
[0m14:43:54.585261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m14:43:54.598327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '775be367-2b50-49f5-8e8d-a5826f7ea402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4b8a86c10>]}
[0m14:43:54.776190 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m14:43:54.780807 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m14:43:54.804656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '775be367-2b50-49f5-8e8d-a5826f7ea402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4b8883e10>]}
[0m14:43:54.805485 [info ] [MainThread]: Found 2 models, 12 data tests, 1 source, 690 macros
[0m14:43:54.806162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '775be367-2b50-49f5-8e8d-a5826f7ea402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4b8a5f050>]}
[0m14:43:54.809156 [info ] [MainThread]: 
[0m14:43:54.809906 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m14:43:54.810819 [info ] [MainThread]: 
[0m14:43:54.812145 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:43:54.820696 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m14:43:54.894346 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m14:43:54.894892 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m14:43:54.895446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:09.935721 [debug] [ThreadPool]: SQL status: OK in 15.040 seconds
[0m14:44:09.937734 [debug] [ThreadPool]: On list_crypto_database: Close
[0m14:44:09.938801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m14:44:09.939622 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m14:44:09.947934 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m14:44:09.948564 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m14:44:09.949119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:09.951863 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:44:09.953786 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m14:44:09.954380 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m14:44:09.956238 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:44:09.957122 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m14:44:09.957702 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m14:44:09.996184 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m14:44:09.997458 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m14:44:09.997995 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m14:44:09.998531 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m14:44:10.043082 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m14:44:10.044353 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m14:44:10.046983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m14:44:10.058817 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m14:44:10.059611 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m14:44:10.063348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:10.065604 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:44:10.069445 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m14:44:10.070245 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m14:44:10.127429 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m14:44:10.133383 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m14:44:10.136184 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m14:44:10.137116 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m14:44:10.140033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '775be367-2b50-49f5-8e8d-a5826f7ea402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4b86d0e10>]}
[0m14:44:10.141334 [debug] [MainThread]: Using duckdb connection "master"
[0m14:44:10.142322 [debug] [MainThread]: On master: BEGIN
[0m14:44:10.143257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:10.145292 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m14:44:10.145937 [debug] [MainThread]: On master: COMMIT
[0m14:44:10.146595 [debug] [MainThread]: Using duckdb connection "master"
[0m14:44:10.147326 [debug] [MainThread]: On master: COMMIT
[0m14:44:10.148593 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:44:10.149257 [debug] [MainThread]: On master: Close
[0m14:44:10.153672 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m14:44:10.154855 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg__prices ................................... [RUN]
[0m14:44:10.156061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m14:44:10.157042 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m14:44:10.174873 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m14:44:10.179759 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m14:44:10.263091 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m14:44:10.265551 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m14:44:10.266722 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m14:44:10.267987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:10.272958 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:44:10.274247 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m14:44:10.275328 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
  create view "crypto_database"."main"."stg__prices__dbt_tmp" as (
    with source as (
    select * from "crypto_db"."crypto_raw"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h as daily_change,
        
        -- The fix you made for the timestamp
        now() as ingested_at
    from source
)

select * from renamed
  );

[0m14:44:10.321591 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m14:44:10.351987 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m14:44:10.353032 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */
alter view "crypto_database"."main"."stg__prices" rename to "stg__prices__dbt_backup"
[0m14:44:10.400835 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m14:44:10.416916 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m14:44:10.417980 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */
alter view "crypto_database"."main"."stg__prices__dbt_tmp" rename to "stg__prices"
[0m14:44:10.456759 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m14:44:10.490363 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m14:44:10.491190 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m14:44:10.491953 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m14:44:10.570297 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m14:44:10.577368 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m14:44:10.578069 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop view if exists "crypto_database"."main"."stg__prices__dbt_backup" cascade
    
[0m14:44:10.652656 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m14:44:10.655834 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m14:44:10.660260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775be367-2b50-49f5-8e8d-a5826f7ea402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4c09c5590>]}
[0m14:44:10.661267 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg__prices .............................. [[32mOK[0m in 0.50s]
[0m14:44:10.662594 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m14:44:10.663834 [debug] [Thread-2 (]: Began running node model.crypto_analytics.coin_trends
[0m14:44:10.664739 [info ] [Thread-2 (]: 2 of 2 START sql table model main.coin_trends .................................. [RUN]
[0m14:44:10.665662 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.crypto_analytics.coin_trends'
[0m14:44:10.666429 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.coin_trends
[0m14:44:10.671977 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.coin_trends"
[0m14:44:10.673170 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.coin_trends
[0m14:44:10.713848 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.coin_trends"
[0m14:44:10.715164 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m14:44:10.716012 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: BEGIN
[0m14:44:10.716816 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:44:10.719780 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:44:10.720689 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m14:44:10.721622 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */

  
    
    

    create  table
      "crypto_database"."main"."coin_trends__dbt_tmp"
  
    as (
      

with source as (
    -- 1. Grab the clean data from staging
    select * from "crypto_database"."main"."stg__prices"
)

select
    coin_id,
    symbol,
    usd_price,
    daily_change,
    ingested_at,
    
    -- 2. BUSINESS LOGIC: Categorize Volatility
    case 
        when daily_change > 5.0  then '🚀 Mooning'
        when daily_change < -5.0 then '💀 Crashing'
        else '😴 Stable'
    end as volatility_flag,

    -- 3. BUSINESS LOGIC: High Risk Flag (Simple Boolean)
    case
        when abs(daily_change) > 10 then true
        else false
    end as is_high_risk

from source
where daily_change is not null -- Safety check!
    );
  
  
[0m14:44:10.788936 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m14:44:10.797787 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m14:44:10.798779 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'coin_trends'
  
[0m14:44:10.801150 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:44:10.805880 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m14:44:10.808014 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'coin_trends'
  
[0m14:44:10.810665 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:44:10.816584 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m14:44:10.817325 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */
alter table "crypto_database"."main"."coin_trends" rename to "coin_trends__dbt_backup"
[0m14:44:10.857560 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m14:44:10.861905 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m14:44:10.862580 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */
alter table "crypto_database"."main"."coin_trends__dbt_tmp" rename to "coin_trends"
[0m14:44:10.902007 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m14:44:10.909680 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: COMMIT
[0m14:44:10.910558 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m14:44:10.911506 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: COMMIT
[0m14:44:11.000252 [debug] [Thread-2 (]: SQL status: OK in 0.088 seconds
[0m14:44:11.007290 [debug] [Thread-2 (]: Using duckdb connection "model.crypto_analytics.coin_trends"
[0m14:44:11.008747 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.coin_trends"} */

      drop table if exists "crypto_database"."main"."coin_trends__dbt_backup" cascade
    
[0m14:44:11.085157 [debug] [Thread-2 (]: SQL status: OK in 0.075 seconds
[0m14:44:11.087056 [debug] [Thread-2 (]: On model.crypto_analytics.coin_trends: Close
[0m14:44:11.087929 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775be367-2b50-49f5-8e8d-a5826f7ea402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4b859dd50>]}
[0m14:44:11.089042 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.coin_trends ............................. [[32mOK[0m in 0.42s]
[0m14:44:11.090073 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.coin_trends
[0m14:44:11.092968 [debug] [MainThread]: Using duckdb connection "master"
[0m14:44:11.093828 [debug] [MainThread]: On master: BEGIN
[0m14:44:11.094594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:11.097886 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m14:44:11.098911 [debug] [MainThread]: On master: COMMIT
[0m14:44:11.099807 [debug] [MainThread]: Using duckdb connection "master"
[0m14:44:11.100670 [debug] [MainThread]: On master: COMMIT
[0m14:44:11.102517 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:44:11.103423 [debug] [MainThread]: On master: Close
[0m14:44:11.104442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:11.105220 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m14:44:11.105953 [debug] [MainThread]: Connection 'model.crypto_analytics.coin_trends' was properly closed.
[0m14:44:11.106811 [info ] [MainThread]: 
[0m14:44:11.107847 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 16.29 seconds (16.29s).
[0m14:44:11.111372 [debug] [MainThread]: Command end result
[0m14:44:11.222800 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m14:44:11.226157 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m14:44:11.238483 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m14:44:11.239389 [info ] [MainThread]: 
[0m14:44:11.240442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:11.241411 [info ] [MainThread]: 
[0m14:44:11.242398 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:44:11.243651 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:44:11.245994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.398153, "process_in_blocks": "140216", "process_kernel_time": 0.54606, "process_mem_max_rss": "200936", "process_out_blocks": "4752", "process_user_time": 7.9687}
[0m14:44:11.247236 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:11.246957 after 20.40 seconds
[0m14:44:11.248191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4bfb96270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4c40ef7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4c0ae6c90>]}
[0m14:44:11.249123 [debug] [MainThread]: Flushing usage events
[0m14:44:12.008949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:54:12.134390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7de78daba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7de9359090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7de690fb10>]}


============================== 14:54:12.138817 | c17b5d6b-5804-47da-9c8d-4bfb47b62161 ==============================
[0m14:54:12.138817 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:54:12.139789 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'empty': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'printer_width': '80', 'log_format': 'default', 'profiles_dir': '/home/bihitche/.dbt', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'write_json': 'True', 'debug': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --select stg__prices'}
[0m14:54:12.593331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c17b5d6b-5804-47da-9c8d-4bfb47b62161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7de75fb490>]}
[0m14:54:12.720883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c17b5d6b-5804-47da-9c8d-4bfb47b62161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7de69c16a0>]}
[0m14:54:12.723789 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:54:12.926841 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m14:54:13.130779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:54:13.132038 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/__sources.yml
[0m14:54:13.132769 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg__prices.sql
[0m14:54:14.162103 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.crypto_analytics.stg__prices' (models/staging/stg__prices.sql) depends on a source named 'crypto.raw_prices' which was not found
[0m14:54:14.163733 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1431975, "process_in_blocks": "216", "process_kernel_time": 0.376924, "process_mem_max_rss": "149896", "process_out_blocks": "16", "process_user_time": 4.095316}
[0m14:54:14.165142 [debug] [MainThread]: Command `dbt run` failed at 14:54:14.164972 after 2.14 seconds
[0m14:54:14.166138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7de6827c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7dd36e0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7dd36cb890>]}
[0m14:54:14.166764 [debug] [MainThread]: Flushing usage events
[0m14:54:15.045844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:54:49.489352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b79bbceba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b79d585090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b79ac03b10>]}


============================== 14:54:49.493954 | 6b5abb6b-aab5-4514-ba0e-af5655207b5e ==============================
[0m14:54:49.493954 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:54:49.495273 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'profiles_dir': '/home/bihitche/.dbt', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg__prices', 'empty': 'False'}
[0m14:54:49.900660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b5abb6b-aab5-4514-ba0e-af5655207b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b79b8ef490>]}
[0m14:54:50.012494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b5abb6b-aab5-4514-ba0e-af5655207b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b79acb56a0>]}
[0m14:54:50.014581 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:54:50.165931 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m14:54:50.331145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:54:50.332364 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/__sources.yml
[0m14:54:50.332947 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg__prices.sql
[0m14:54:51.244739 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.crypto_analytics.stg__prices' (models/staging/stg__prices.sql) depends on a source named 'crypto.raw_prices' which was not found
[0m14:54:51.246507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8681542, "process_in_blocks": "0", "process_kernel_time": 0.367207, "process_mem_max_rss": "149916", "process_out_blocks": "16", "process_user_time": 3.742922}
[0m14:54:51.247919 [debug] [MainThread]: Command `dbt run` failed at 14:54:51.247744 after 1.87 seconds
[0m14:54:51.248529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b79ab13c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b7941dc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b7941c7890>]}
[0m14:54:51.249084 [debug] [MainThread]: Flushing usage events
[0m14:54:51.910277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:51.562643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0c29ed2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0c2b985090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0c28f07b10>]}


============================== 14:58:51.569824 | 23e22169-e309-4d1b-ae0f-5fa011ef307d ==============================
[0m14:58:51.569824 [info ] [MainThread]: Running with dbt=1.11.3
[0m14:58:51.571438 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'empty': 'False', 'quiet': 'False', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'invocation_command': 'dbt run --select stg__prices', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m14:58:52.143424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23e22169-e309-4d1b-ae0f-5fa011ef307d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0c29bf3490>]}
[0m14:58:52.290044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23e22169-e309-4d1b-ae0f-5fa011ef307d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0c28fb96a0>]}
[0m14:58:52.293319 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:58:52.498878 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m14:58:52.682467 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading crypto_analytics: staging/__sources.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  |     tables:
    8  |       - name: raw_prices       # <--- The table dlt created
    9  | 
    10 | */
    
    Raw Error:
    ------------------------------
    while scanning an alias
      in "<unicode string>", line 10, column 1
    did not find expected alphabetic or numeric character
      in "<unicode string>", line 10, column 2
[0m14:58:52.684838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2718858, "process_in_blocks": "50536", "process_kernel_time": 0.371014, "process_mem_max_rss": "141612", "process_out_blocks": "16", "process_user_time": 3.05716}
[0m14:58:52.685908 [debug] [MainThread]: Command `dbt run` failed at 14:58:52.685690 after 1.27 seconds
[0m14:58:52.686801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0c229b1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0c229b1c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0c22976d50>]}
[0m14:58:52.687731 [debug] [MainThread]: Flushing usage events
[0m14:58:53.574531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:56.873949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73849eababa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384a0481090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73849daefb10>]}


============================== 15:04:56.878168 | cdb0ec08-0161-41e8-88e9-cb10007ffeed ==============================
[0m15:04:56.878168 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:04:56.879136 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'log_cache_events': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'warn_error': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'invocation_command': 'dbt run --select stg__prices', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'empty': 'False', 'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default'}
[0m15:04:57.285617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdb0ec08-0161-41e8-88e9-cb10007ffeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73849e7db490>]}
[0m15:04:57.397753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdb0ec08-0161-41e8-88e9-cb10007ffeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73849dba16a0>]}
[0m15:04:57.399769 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:04:57.544441 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m15:04:57.704850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:57.705450 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:04:57.705911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:57.713382 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m15:04:57.798178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdb0ec08-0161-41e8-88e9-cb10007ffeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73849d9fe850>]}
[0m15:04:58.046934 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:04:58.052040 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:04:58.078246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdb0ec08-0161-41e8-88e9-cb10007ffeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73849755f6b0>]}
[0m15:04:58.078902 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 690 macros
[0m15:04:58.079478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb0ec08-0161-41e8-88e9-cb10007ffeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738497e28c90>]}
[0m15:04:58.081606 [info ] [MainThread]: 
[0m15:04:58.082302 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m15:04:58.082819 [info ] [MainThread]: 
[0m15:04:58.083880 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:04:58.085637 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m15:04:58.187433 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m15:04:58.193487 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m15:04:58.194474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:11.316511 [debug] [ThreadPool]: SQL status: OK in 13.122 seconds
[0m15:05:11.319438 [debug] [ThreadPool]: On list_crypto_database: Close
[0m15:05:11.320655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m15:05:11.321478 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m15:05:11.331065 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:05:11.331680 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:05:11.332263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:11.334626 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:05:11.337069 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:05:11.337822 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m15:05:11.339612 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:05:11.340497 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:05:11.341057 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m15:05:11.374962 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m15:05:11.376399 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:05:11.377055 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:05:11.377695 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:05:11.411514 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m15:05:11.412620 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m15:05:11.424635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m15:05:11.437263 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:05:11.438002 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m15:05:11.438881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:11.441654 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:05:11.442561 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:05:11.443589 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m15:05:11.488880 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m15:05:11.491381 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m15:05:11.493119 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m15:05:11.493753 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m15:05:11.495738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb0ec08-0161-41e8-88e9-cb10007ffeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384971efa00>]}
[0m15:05:11.496741 [debug] [MainThread]: Using duckdb connection "master"
[0m15:05:11.497302 [debug] [MainThread]: On master: BEGIN
[0m15:05:11.497823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:11.499916 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:05:11.500923 [debug] [MainThread]: On master: COMMIT
[0m15:05:11.501490 [debug] [MainThread]: Using duckdb connection "master"
[0m15:05:11.501963 [debug] [MainThread]: On master: COMMIT
[0m15:05:11.503149 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:05:11.503776 [debug] [MainThread]: On master: Close
[0m15:05:11.507356 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m15:05:11.508542 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg__prices ............................ [RUN]
[0m15:05:11.509617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m15:05:11.510524 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m15:05:11.548983 [debug] [Thread-1 (]: Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:05:11.566244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb0ec08-0161-41e8-88e9-cb10007ffeed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738497352750>]}
[0m15:05:11.567838 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.stg__prices ................... [[31mERROR[0m in 0.05s]
[0m15:05:11.569659 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m15:05:11.571649 [debug] [Thread-7 (]: Marking all children of 'model.crypto_analytics.stg__prices' to be skipped because of status 'error'.  Reason: Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:05:11.576824 [debug] [MainThread]: Using duckdb connection "master"
[0m15:05:11.577569 [debug] [MainThread]: On master: BEGIN
[0m15:05:11.580358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:11.584400 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m15:05:11.585148 [debug] [MainThread]: On master: COMMIT
[0m15:05:11.585898 [debug] [MainThread]: Using duckdb connection "master"
[0m15:05:11.588925 [debug] [MainThread]: On master: COMMIT
[0m15:05:11.595618 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m15:05:11.596398 [debug] [MainThread]: On master: Close
[0m15:05:11.597265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:11.597915 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m15:05:11.601797 [info ] [MainThread]: 
[0m15:05:11.602637 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 13.52 seconds (13.52s).
[0m15:05:11.606603 [debug] [MainThread]: Command end result
[0m15:05:11.710558 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:05:11.714195 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:05:11.730473 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m15:05:11.732607 [info ] [MainThread]: 
[0m15:05:11.734432 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:05:11.736284 [info ] [MainThread]: 
[0m15:05:11.738075 [error] [MainThread]: [31mFailure in model stg__prices (models/staging/stg__prices.sql)[0m
[0m15:05:11.739425 [error] [MainThread]:   Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:05:11.742360 [info ] [MainThread]: 
[0m15:05:11.743451 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:05:11.748509 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.964251, "process_in_blocks": "145848", "process_kernel_time": 0.466242, "process_mem_max_rss": "187844", "process_out_blocks": "3064", "process_user_time": 4.783227}
[0m15:05:11.751408 [debug] [MainThread]: Command `dbt run` failed at 15:05:11.751060 after 14.97 seconds
[0m15:05:11.754524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73849728d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384967c65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384967c5a90>]}
[0m15:05:11.756788 [debug] [MainThread]: Flushing usage events
[0m15:05:12.559014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:03.742245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce92b4e2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce92cf95090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce92a517b10>]}


============================== 15:07:03.746419 | c7eb0fd3-fd6f-4b12-900a-cc86b638938f ==============================
[0m15:07:03.746419 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:07:03.747433 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'target_path': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'log_cache_events': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'printer_width': '80', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'write_json': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'debug': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select stg__prices', 'indirect_selection': 'eager', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True'}
[0m15:07:04.198092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7eb0fd3-fd6f-4b12-900a-cc86b638938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce92b203490>]}
[0m15:07:04.324038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7eb0fd3-fd6f-4b12-900a-cc86b638938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce92a5c96a0>]}
[0m15:07:04.327088 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:07:04.505783 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m15:07:04.666154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:07:04.666928 [debug] [MainThread]: Partial parsing: added file: crypto_analytics://macros/is_incremental_filters.sql
[0m15:07:04.790764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7eb0fd3-fd6f-4b12-900a-cc86b638938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce9241be850>]}
[0m15:07:05.045700 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:07:05.049092 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:07:05.068150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7eb0fd3-fd6f-4b12-900a-cc86b638938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce924182e40>]}
[0m15:07:05.069508 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 691 macros
[0m15:07:05.070314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7eb0fd3-fd6f-4b12-900a-cc86b638938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce92484f770>]}
[0m15:07:05.072470 [info ] [MainThread]: 
[0m15:07:05.073170 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m15:07:05.073780 [info ] [MainThread]: 
[0m15:07:05.074880 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:07:05.076533 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m15:07:05.153688 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m15:07:05.154610 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m15:07:05.155355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:18.191611 [debug] [ThreadPool]: SQL status: OK in 13.036 seconds
[0m15:07:18.194101 [debug] [ThreadPool]: On list_crypto_database: Close
[0m15:07:18.198990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m15:07:18.200416 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m15:07:18.211879 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:07:18.213150 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:07:18.214311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:18.217355 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:07:18.219351 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:07:18.220526 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m15:07:18.223654 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:07:18.224823 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:07:18.225984 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m15:07:18.262123 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m15:07:18.263447 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:07:18.264104 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:07:18.264627 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:07:18.297135 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m15:07:18.297732 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m15:07:18.307595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m15:07:18.314683 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:07:18.315246 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m15:07:18.315757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:18.317531 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:07:18.318123 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:07:18.318725 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m15:07:18.343275 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m15:07:18.345411 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m15:07:18.346851 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m15:07:18.347517 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m15:07:18.349734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7eb0fd3-fd6f-4b12-900a-cc86b638938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce91f17c390>]}
[0m15:07:18.350810 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:18.351639 [debug] [MainThread]: On master: BEGIN
[0m15:07:18.352404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:18.354756 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:07:18.355583 [debug] [MainThread]: On master: COMMIT
[0m15:07:18.356444 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:18.357250 [debug] [MainThread]: On master: COMMIT
[0m15:07:18.358733 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:07:18.359596 [debug] [MainThread]: On master: Close
[0m15:07:18.363757 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m15:07:18.365110 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg__prices ............................ [RUN]
[0m15:07:18.366096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m15:07:18.367034 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m15:07:18.389000 [debug] [Thread-1 (]: Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:07:18.394915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7eb0fd3-fd6f-4b12-900a-cc86b638938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce91fd6ec90>]}
[0m15:07:18.396282 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.stg__prices ................... [[31mERROR[0m in 0.02s]
[0m15:07:18.400618 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m15:07:18.403021 [debug] [Thread-7 (]: Marking all children of 'model.crypto_analytics.stg__prices' to be skipped because of status 'error'.  Reason: Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:07:18.406696 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:18.407902 [debug] [MainThread]: On master: BEGIN
[0m15:07:18.408790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:18.413362 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m15:07:18.414191 [debug] [MainThread]: On master: COMMIT
[0m15:07:18.415050 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:18.415851 [debug] [MainThread]: On master: COMMIT
[0m15:07:18.417647 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:07:18.418580 [debug] [MainThread]: On master: Close
[0m15:07:18.419632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:18.420438 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m15:07:18.421358 [info ] [MainThread]: 
[0m15:07:18.424002 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 13.35 seconds (13.35s).
[0m15:07:18.425727 [debug] [MainThread]: Command end result
[0m15:07:18.543427 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:07:18.547317 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:07:18.559680 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m15:07:18.560652 [info ] [MainThread]: 
[0m15:07:18.561620 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:07:18.562541 [info ] [MainThread]: 
[0m15:07:18.563598 [error] [MainThread]: [31mFailure in model stg__prices (models/staging/stg__prices.sql)[0m
[0m15:07:18.564582 [error] [MainThread]:   Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:07:18.565444 [info ] [MainThread]: 
[0m15:07:18.566331 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:07:18.568373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.9282675, "process_in_blocks": "0", "process_kernel_time": 0.438696, "process_mem_max_rss": "187452", "process_out_blocks": "4608", "process_user_time": 4.629687}
[0m15:07:18.569625 [debug] [MainThread]: Command `dbt run` failed at 15:07:18.569432 after 14.93 seconds
[0m15:07:18.570478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce91fcd3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce9247aff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce92417e350>]}
[0m15:07:18.573855 [debug] [MainThread]: Flushing usage events
[0m15:07:19.437096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:07.092468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78896dad6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78896f585090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78896cb0bb10>]}


============================== 15:09:07.097460 | ab610153-2cdd-4099-8769-74a451ecf212 ==============================
[0m15:09:07.097460 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:09:07.098661 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select stg__prices', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'version_check': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'static_parser': 'True', 'no_print': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:09:07.564818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab610153-2cdd-4099-8769-74a451ecf212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78896d7f7490>]}
[0m15:09:07.700061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab610153-2cdd-4099-8769-74a451ecf212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78896cbbd6a0>]}
[0m15:09:07.702330 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:09:07.918259 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m15:09:08.119148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:08.119830 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:09:08.120362 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:08.190845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab610153-2cdd-4099-8769-74a451ecf212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78896ca1e850>]}
[0m15:09:08.439929 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:09:08.443557 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:09:08.464806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab610153-2cdd-4099-8769-74a451ecf212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78896657b890>]}
[0m15:09:08.465626 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 691 macros
[0m15:09:08.466473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab610153-2cdd-4099-8769-74a451ecf212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788966e49470>]}
[0m15:09:08.468872 [info ] [MainThread]: 
[0m15:09:08.469602 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m15:09:08.470466 [info ] [MainThread]: 
[0m15:09:08.471821 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:09:08.473975 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m15:09:08.553409 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m15:09:08.554552 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m15:09:08.555616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:21.746624 [debug] [ThreadPool]: SQL status: OK in 13.191 seconds
[0m15:09:21.755042 [debug] [ThreadPool]: On list_crypto_database: Close
[0m15:09:21.758155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m15:09:21.760690 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m15:09:21.790057 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:09:21.791253 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:09:21.792259 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:21.796345 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:09:21.799701 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:09:21.800588 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m15:09:21.802764 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:09:21.803684 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:09:21.804311 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m15:09:21.838674 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m15:09:21.840052 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:09:21.840814 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:09:21.841366 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:09:21.873646 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m15:09:21.874515 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m15:09:21.885974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m15:09:21.897057 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:09:21.897828 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m15:09:21.898504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:21.901985 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:09:21.902788 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:09:21.903642 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m15:09:21.928717 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m15:09:21.930565 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m15:09:21.931933 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m15:09:21.932739 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m15:09:21.935137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab610153-2cdd-4099-8769-74a451ecf212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788965807930>]}
[0m15:09:21.936191 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:21.936678 [debug] [MainThread]: On master: BEGIN
[0m15:09:21.937106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:21.938786 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:09:21.939336 [debug] [MainThread]: On master: COMMIT
[0m15:09:21.939794 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:21.940247 [debug] [MainThread]: On master: COMMIT
[0m15:09:21.941243 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:09:21.941940 [debug] [MainThread]: On master: Close
[0m15:09:21.945155 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m15:09:21.945960 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg__prices ............................ [RUN]
[0m15:09:21.946736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m15:09:21.947338 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m15:09:21.963141 [debug] [Thread-1 (]: Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:09:21.965209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab610153-2cdd-4099-8769-74a451ecf212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78896635ed50>]}
[0m15:09:21.966706 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.stg__prices ................... [[31mERROR[0m in 0.02s]
[0m15:09:21.968162 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m15:09:21.969334 [debug] [Thread-7 (]: Marking all children of 'model.crypto_analytics.stg__prices' to be skipped because of status 'error'.  Reason: Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:09:21.972268 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:21.973133 [debug] [MainThread]: On master: BEGIN
[0m15:09:21.974054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:21.976904 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m15:09:21.977668 [debug] [MainThread]: On master: COMMIT
[0m15:09:21.978158 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:21.978614 [debug] [MainThread]: On master: COMMIT
[0m15:09:21.979822 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:09:21.980466 [debug] [MainThread]: On master: Close
[0m15:09:21.981592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:21.985693 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m15:09:21.986460 [info ] [MainThread]: 
[0m15:09:21.987294 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 13.51 seconds (13.51s).
[0m15:09:21.989259 [debug] [MainThread]: Command end result
[0m15:09:22.072189 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:09:22.074641 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:09:22.084004 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m15:09:22.084721 [info ] [MainThread]: 
[0m15:09:22.085729 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:09:22.086724 [info ] [MainThread]: 
[0m15:09:22.087777 [error] [MainThread]: [31mFailure in model stg__prices (models/staging/stg__prices.sql)[0m
[0m15:09:22.088590 [error] [MainThread]:   Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:09:22.089222 [info ] [MainThread]: 
[0m15:09:22.089913 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:09:22.091522 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.115486, "process_in_blocks": "0", "process_kernel_time": 0.492859, "process_mem_max_rss": "187048", "process_out_blocks": "3040", "process_user_time": 4.698059}
[0m15:09:22.092465 [debug] [MainThread]: Command `dbt run` failed at 15:09:22.092294 after 15.12 seconds
[0m15:09:22.093260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7889662ad0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7889657dcc30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7889657dea30>]}
[0m15:09:22.094082 [debug] [MainThread]: Flushing usage events
[0m15:09:22.931297 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:36.254627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b3a0caba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b3bb89090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b390ffb10>]}


============================== 15:09:36.259271 | dfb13184-7f75-463e-b170-8798f7614c80 ==============================
[0m15:09:36.259271 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:09:36.260428 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'log_format': 'default', 'empty': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'profiles_dir': '/home/bihitche/.dbt', 'printer_width': '80', 'introspect': 'True', 'use_colors': 'True', 'no_print': 'None', 'invocation_command': 'dbt deps', 'target_path': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'debug': 'False'}
[0m15:09:36.527330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfb13184-7f75-463e-b170-8798f7614c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b39deb490>]}
[0m15:09:36.550750 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-59q_ewf5'
[0m15:09:36.551548 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:09:36.779367 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:09:36.781642 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m15:09:36.867925 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m15:09:36.870813 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m15:09:36.871646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dfb13184-7f75-463e-b170-8798f7614c80', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38f15bf0>]}
[0m15:09:36.878250 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:09:37.004643 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:09:37.012306 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m15:09:37.110151 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m15:09:37.127091 [info ] [MainThread]: Updating lock file in file path: /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/package-lock.yml
[0m15:09:37.147347 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-av2vf8_i'
[0m15:09:37.162746 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m15:09:37.933157 [info ] [MainThread]: Installed from version 0.8.0
[0m15:09:37.933948 [info ] [MainThread]: Updated version available: 0.10.4
[0m15:09:37.934797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dfb13184-7f75-463e-b170-8798f7614c80', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38d4a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38d4ad50>]}
[0m15:09:37.935403 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:09:38.603375 [info ] [MainThread]: Installed from version 0.9.6
[0m15:09:38.603966 [info ] [MainThread]: Updated version available: 1.3.3
[0m15:09:38.604666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dfb13184-7f75-463e-b170-8798f7614c80', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38f727b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38d375b0>]}
[0m15:09:38.605552 [info ] [MainThread]: Installing calogica/dbt_date
[0m15:09:38.948070 [info ] [MainThread]: Installed from version 0.7.2
[0m15:09:38.950053 [info ] [MainThread]: Updated version available: 0.10.1
[0m15:09:38.951453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dfb13184-7f75-463e-b170-8798f7614c80', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38c5be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38ec7a10>]}
[0m15:09:38.952622 [info ] [MainThread]: 
[0m15:09:38.953749 [info ] [MainThread]: Updates available for packages: ['calogica/dbt_expectations', 'dbt-labs/dbt_utils', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m15:09:38.958328 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:09:38.961108 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.817608, "process_in_blocks": "720", "process_kernel_time": 0.345626, "process_mem_max_rss": "114536", "process_out_blocks": "23080", "process_user_time": 3.274458}
[0m15:09:38.962725 [debug] [MainThread]: Command `dbt deps` succeeded at 15:09:38.962433 after 2.82 seconds
[0m15:09:38.963849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38d660a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38d66150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38dbfbb0>]}
[0m15:09:38.964856 [debug] [MainThread]: Flushing usage events
[0m15:09:39.724552 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:46.247943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768bee9c6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768bf0489090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768bed9fbb10>]}


============================== 15:09:46.254039 | 0df6c37b-ebf4-4979-ae21-efb0639fe5ba ==============================
[0m15:09:46.254039 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:09:46.255435 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'empty': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'invocation_command': 'dbt run --select stg__prices', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'use_colors': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_format': 'default', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'debug': 'False'}
[0m15:09:46.822062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0df6c37b-ebf4-4979-ae21-efb0639fe5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768bee6e7490>]}
[0m15:09:46.968896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0df6c37b-ebf4-4979-ae21-efb0639fe5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768bedaad6a0>]}
[0m15:09:46.971041 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:09:47.184430 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m15:09:47.360763 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:09:47.361622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0df6c37b-ebf4-4979-ae21-efb0639fe5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768be7bade50>]}
[0m15:09:50.155842 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_crypto_prices' in the 'models' section of file 'models/staging/__sources.yml'
[0m15:09:50.473292 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_crypto_symbol.557b2e9363' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:09:50.474105 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_crypto_timestamp.2224d82c9d' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:09:50.474871 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.unique_stg_crypto_prices_crypto_timestamp.e7619144f6' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:09:50.475583 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_price.b5a3d0d20b' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:09:50.675967 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m15:09:50.688816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0df6c37b-ebf4-4979-ae21-efb0639fe5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768be705ec60>]}
[0m15:09:50.876138 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:09:50.879427 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:09:50.897889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0df6c37b-ebf4-4979-ae21-efb0639fe5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768bed790750>]}
[0m15:09:50.898658 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 888 macros
[0m15:09:50.899334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0df6c37b-ebf4-4979-ae21-efb0639fe5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768be7194bb0>]}
[0m15:09:50.901544 [info ] [MainThread]: 
[0m15:09:50.902168 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m15:09:50.902805 [info ] [MainThread]: 
[0m15:09:50.903838 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:09:50.905634 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m15:09:50.970216 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m15:09:50.971099 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m15:09:50.971839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:16.360217 [debug] [ThreadPool]: SQL status: OK in 25.388 seconds
[0m15:10:16.363634 [debug] [ThreadPool]: On list_crypto_database: Close
[0m15:10:16.365239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m15:10:16.366489 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m15:10:16.376139 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:10:16.377088 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:10:16.377765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:16.380622 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:10:16.382686 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:10:16.383219 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m15:10:16.385624 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:10:16.386167 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:10:16.386643 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m15:10:16.420662 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m15:10:16.421921 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:10:16.422670 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:10:16.423138 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:10:16.454428 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m15:10:16.455027 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m15:10:16.463006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m15:10:16.471300 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:10:16.471871 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m15:10:16.472354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:16.474058 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:10:16.474653 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:10:16.475230 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m15:10:16.504303 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m15:10:16.506224 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m15:10:16.507493 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m15:10:16.508017 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m15:10:16.509987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0df6c37b-ebf4-4979-ae21-efb0639fe5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768be5bf0a10>]}
[0m15:10:16.511001 [debug] [MainThread]: Using duckdb connection "master"
[0m15:10:16.511955 [debug] [MainThread]: On master: BEGIN
[0m15:10:16.512780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:16.515223 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:10:16.515764 [debug] [MainThread]: On master: COMMIT
[0m15:10:16.516581 [debug] [MainThread]: Using duckdb connection "master"
[0m15:10:16.517106 [debug] [MainThread]: On master: COMMIT
[0m15:10:16.518747 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:10:16.519644 [debug] [MainThread]: On master: Close
[0m15:10:16.522880 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m15:10:16.524106 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg__prices ............................ [RUN]
[0m15:10:16.525118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m15:10:16.525874 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m15:10:16.548509 [debug] [Thread-1 (]: Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  'dict object' has no attribute 'generate_surrogate_key'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:10:16.551577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0df6c37b-ebf4-4979-ae21-efb0639fe5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768be5bf5bd0>]}
[0m15:10:16.552840 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.stg__prices ................... [[31mERROR[0m in 0.02s]
[0m15:10:16.554249 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m15:10:16.555416 [debug] [Thread-7 (]: Marking all children of 'model.crypto_analytics.stg__prices' to be skipped because of status 'error'.  Reason: Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  'dict object' has no attribute 'generate_surrogate_key'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:10:16.559492 [debug] [MainThread]: Using duckdb connection "master"
[0m15:10:16.561851 [debug] [MainThread]: On master: BEGIN
[0m15:10:16.563726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:16.567765 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m15:10:16.569823 [debug] [MainThread]: On master: COMMIT
[0m15:10:16.571387 [debug] [MainThread]: Using duckdb connection "master"
[0m15:10:16.572848 [debug] [MainThread]: On master: COMMIT
[0m15:10:16.575401 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:10:16.576223 [debug] [MainThread]: On master: Close
[0m15:10:16.577244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:16.577938 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m15:10:16.578683 [info ] [MainThread]: 
[0m15:10:16.580004 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 25.68 seconds (25.68s).
[0m15:10:16.581760 [debug] [MainThread]: Command end result
[0m15:10:16.675227 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:10:16.679020 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:10:16.692370 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m15:10:16.693396 [info ] [MainThread]: 
[0m15:10:16.694434 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:10:16.695273 [info ] [MainThread]: 
[0m15:10:16.696468 [error] [MainThread]: [31mFailure in model stg__prices (models/staging/stg__prices.sql)[0m
[0m15:10:16.697547 [error] [MainThread]:   Compilation Error in model stg__prices (models/staging/stg__prices.sql)
  'dict object' has no attribute 'generate_surrogate_key'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:10:16.698417 [info ] [MainThread]: 
[0m15:10:16.699468 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:10:16.701304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 30.576357, "process_in_blocks": "8", "process_kernel_time": 0.52029, "process_mem_max_rss": "198168", "process_out_blocks": "5768", "process_user_time": 8.557436}
[0m15:10:16.702070 [debug] [MainThread]: Command `dbt run` failed at 15:10:16.701894 after 30.58 seconds
[0m15:10:16.702708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768be59b9770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768be64be7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768be6515550>]}
[0m15:10:16.703277 [debug] [MainThread]: Flushing usage events
[0m15:10:17.507278 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:51.469218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797293aeeba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797295595090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797292b23b10>]}


============================== 15:11:51.475331 | de8f558a-a554-4a94-a101-9d980e40ba2f ==============================
[0m15:11:51.475331 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:11:51.476693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt run --select stg__prices', 'introspect': 'True', 'profiles_dir': '/home/bihitche/.dbt', 'debug': 'False', 'version_check': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs'}
[0m15:11:51.922691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de8f558a-a554-4a94-a101-9d980e40ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79729380f490>]}
[0m15:11:52.107299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de8f558a-a554-4a94-a101-9d980e40ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797292bd56a0>]}
[0m15:11:52.111620 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:11:52.348341 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m15:11:52.519188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:11:52.520015 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg__prices.sql
[0m15:11:53.094538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de8f558a-a554-4a94-a101-9d980e40ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79728c5d3450>]}
[0m15:11:53.301232 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:11:53.304849 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:11:53.323798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de8f558a-a554-4a94-a101-9d980e40ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79728c58f980>]}
[0m15:11:53.324559 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 888 macros
[0m15:11:53.325222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de8f558a-a554-4a94-a101-9d980e40ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79728c1dd630>]}
[0m15:11:53.330460 [info ] [MainThread]: 
[0m15:11:53.331533 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m15:11:53.332506 [info ] [MainThread]: 
[0m15:11:53.333854 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:11:53.335859 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m15:11:53.418234 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m15:11:53.419137 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m15:11:53.419987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:06.360410 [debug] [ThreadPool]: SQL status: OK in 12.940 seconds
[0m15:12:06.362623 [debug] [ThreadPool]: On list_crypto_database: Close
[0m15:12:06.363840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m15:12:06.364818 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m15:12:06.373528 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:12:06.374217 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:12:06.374758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:06.377225 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:12:06.379182 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:12:06.379759 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m15:12:06.381443 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:12:06.382006 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:12:06.382615 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m15:12:06.420285 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m15:12:06.422150 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:12:06.422965 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:12:06.423720 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:12:06.460218 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m15:12:06.460806 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m15:12:06.470910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m15:12:06.479247 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:12:06.479861 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m15:12:06.480445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:06.482416 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:12:06.483001 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:12:06.483701 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m15:12:06.510510 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m15:12:06.513704 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m15:12:06.515657 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m15:12:06.516445 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m15:12:06.518680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de8f558a-a554-4a94-a101-9d980e40ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79727f64e5b0>]}
[0m15:12:06.519483 [debug] [MainThread]: Using duckdb connection "master"
[0m15:12:06.520065 [debug] [MainThread]: On master: BEGIN
[0m15:12:06.520664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:06.522443 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:12:06.523050 [debug] [MainThread]: On master: COMMIT
[0m15:12:06.523683 [debug] [MainThread]: Using duckdb connection "master"
[0m15:12:06.524255 [debug] [MainThread]: On master: COMMIT
[0m15:12:06.525472 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:12:06.526088 [debug] [MainThread]: On master: Close
[0m15:12:06.529391 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m15:12:06.530756 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg__prices ............................ [RUN]
[0m15:12:06.531952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m15:12:06.532725 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m15:12:06.548895 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m15:12:06.550213 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m15:12:06.573672 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:12:06.574891 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__dc32023d3dc9" cascade
    
[0m15:12:06.575930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:06.624821 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m15:12:06.709711 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:12:06.710393 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:12:06.712964 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:12:06.714938 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:12:06.715724 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m15:12:06.717498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:12:06.718111 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:12:06.718689 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    
    
        create schema if not exists "crypto_database"."dbt_temp"
    
[0m15:12:06.759966 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m15:12:06.762173 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:12:06.763242 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    

  
[0m15:12:06.763906 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:12:06.765456 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:12:06.766144 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:12:06.766676 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:12:06.801617 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m15:12:06.814354 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m15:12:06.815297 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:12:06.815829 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m15:12:06.817397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:12:06.817986 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:12:06.818563 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
    
    

    create  table
      "crypto_database"."main"."stg__prices__dbt_tmp"
  
    as (
      /*
 old code before incremented it
with source as (
    select * from "crypto_database"."crypto_raw"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h as daily_change,
        
        -- The fix you made for the timestamp
        now() as ingested_at
    from source
)

select * from renamed

*/



WITH raw_data AS (
    SELECT *
    FROM "crypto_database"."crypto_raw"."raw_prices"
)

SELECT
    -- Creating a composite unique key is safer if you track multiple coins
    md5(cast(coalesce(cast(crypto_symbol as TEXT), '') || '-' || coalesce(cast(timestamp as TEXT), '') as TEXT)) as crypto_id_timestamp,
    crypto_symbol,
    price,
    timestamp AS crypto_timestamp,
    now() as ingested_at  -- Keep this to know when the record hit MotherDuck
FROM raw_data


    );
  
  
  
[0m15:12:06.869033 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
    
    

    create  table
      "crypto_database"."main"."stg__prices__dbt_tmp"
  
    as (
      /*
 old code before incremented it
with source as (
    select * from "crypto_database"."crypto_raw"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h as daily_change,
        
        -- The fix you made for the timestamp
        now() as ingested_at
    from source
)

select * from renamed

*/



WITH raw_data AS (
    SELECT *
    FROM "crypto_database"."crypto_raw"."raw_prices"
)

SELECT
    -- Creating a composite unique key is safer if you track multiple coins
    md5(cast(coalesce(cast(crypto_symbol as TEXT), '') || '-' || coalesce(cast(timestamp as TEXT), '') as TEXT)) as crypto_id_timestamp,
    crypto_symbol,
    price,
    timestamp AS crypto_timestamp,
    now() as ingested_at  -- Keep this to know when the record hit MotherDuck
FROM raw_data


    );
  
  
  
[0m15:12:06.870049 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:12:06.876876 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:12:06.878169 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__dc32023d3dc9" cascade
    
[0m15:12:06.916560 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m15:12:06.919187 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: ROLLBACK
[0m15:12:06.940957 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_analytics.stg__prices'
[0m15:12:06.942732 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m15:12:06.958612 [debug] [Thread-1 (]: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Binder Error: Referenced column "crypto_symbol" not found in FROM clause!
  Candidate bindings: "total_volume", "current_price", "market_cap"
  
  LINE 43:     md5(cast(coalesce(cast(crypto_symbol as TEXT), '') || '-' || coalesce(cast(timestamp...
                                      ^
[0m15:12:06.962381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de8f558a-a554-4a94-a101-9d980e40ba2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79727f66dd90>]}
[0m15:12:06.964104 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.stg__prices ................... [[31mERROR[0m in 0.43s]
[0m15:12:06.965585 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m15:12:06.966836 [debug] [Thread-7 (]: Marking all children of 'model.crypto_analytics.stg__prices' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Binder Error: Referenced column "crypto_symbol" not found in FROM clause!
  Candidate bindings: "total_volume", "current_price", "market_cap"
  
  LINE 43:     md5(cast(coalesce(cast(crypto_symbol as TEXT), '') || '-' || coalesce(cast(timestamp...
                                      ^.
[0m15:12:06.970458 [debug] [MainThread]: Using duckdb connection "master"
[0m15:12:06.971402 [debug] [MainThread]: On master: BEGIN
[0m15:12:06.972422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:12:06.974840 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:12:06.975731 [debug] [MainThread]: On master: COMMIT
[0m15:12:06.976348 [debug] [MainThread]: Using duckdb connection "master"
[0m15:12:06.976876 [debug] [MainThread]: On master: COMMIT
[0m15:12:06.978328 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:12:06.979388 [debug] [MainThread]: On master: Close
[0m15:12:06.980478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:06.981378 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m15:12:06.982286 [info ] [MainThread]: 
[0m15:12:06.983005 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 13.65 seconds (13.65s).
[0m15:12:06.984539 [debug] [MainThread]: Command end result
[0m15:12:07.095790 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:12:07.100966 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:12:07.113426 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m15:12:07.114430 [info ] [MainThread]: 
[0m15:12:07.115609 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:12:07.116630 [info ] [MainThread]: 
[0m15:12:07.117767 [error] [MainThread]: [31mFailure in model stg__prices (models/staging/stg__prices.sql)[0m
[0m15:12:07.118920 [error] [MainThread]:   Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Binder Error: Referenced column "crypto_symbol" not found in FROM clause!
  Candidate bindings: "total_volume", "current_price", "market_cap"
  
  LINE 43:     md5(cast(coalesce(cast(crypto_symbol as TEXT), '') || '-' || coalesce(cast(timestamp...
                                      ^
[0m15:12:07.120080 [info ] [MainThread]: 
[0m15:12:07.121683 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics/models/staging/stg__prices.sql
[0m15:12:07.122942 [info ] [MainThread]: 
[0m15:12:07.124073 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:12:07.126452 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.787482, "process_in_blocks": "5048", "process_kernel_time": 0.491695, "process_mem_max_rss": "195596", "process_out_blocks": "5784", "process_user_time": 5.259652}
[0m15:12:07.128251 [debug] [MainThread]: Command `dbt run` failed at 15:12:07.127946 after 15.79 seconds
[0m15:12:07.129538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79727f6f8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79727f454ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79727f454f50>]}
[0m15:12:07.130873 [debug] [MainThread]: Flushing usage events
[0m15:12:08.004290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:20.437412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa898daba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa8b389090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa8890fb10>]}


============================== 15:13:20.441448 | 42855f18-6342-4eb5-9853-d206eb1e8f7e ==============================
[0m15:13:20.441448 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:13:20.442500 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt run --select stg__prices', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'quiet': 'False', 'empty': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m15:13:20.804943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42855f18-6342-4eb5-9853-d206eb1e8f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa895fb490>]}
[0m15:13:20.914907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42855f18-6342-4eb5-9853-d206eb1e8f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa889c16a0>]}
[0m15:13:20.916922 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:13:21.076803 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m15:13:21.239059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:21.239930 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg__prices.sql
[0m15:13:21.755942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42855f18-6342-4eb5-9853-d206eb1e8f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa823c3450>]}
[0m15:13:21.919076 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:13:21.921408 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:13:21.936564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42855f18-6342-4eb5-9853-d206eb1e8f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa8237f980>]}
[0m15:13:21.937531 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 888 macros
[0m15:13:21.938391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42855f18-6342-4eb5-9853-d206eb1e8f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa81fcd630>]}
[0m15:13:21.941300 [info ] [MainThread]: 
[0m15:13:21.942215 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m15:13:21.942839 [info ] [MainThread]: 
[0m15:13:21.944067 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:13:21.945727 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m15:13:22.013923 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m15:13:22.014913 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m15:13:22.015841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:35.269690 [debug] [ThreadPool]: SQL status: OK in 13.254 seconds
[0m15:13:35.272563 [debug] [ThreadPool]: On list_crypto_database: Close
[0m15:13:35.274006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m15:13:35.275116 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m15:13:35.286561 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:13:35.287120 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:13:35.287631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:35.290080 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:13:35.291990 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:13:35.292531 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m15:13:35.294241 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:13:35.294798 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:13:35.295395 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m15:13:35.330172 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m15:13:35.331393 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:13:35.331900 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:13:35.332368 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:13:35.365993 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m15:13:35.366695 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m15:13:35.376348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m15:13:35.387377 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:13:35.388228 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m15:13:35.388980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:35.391367 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:13:35.392167 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:13:35.393001 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m15:13:35.421612 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m15:13:35.424267 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m15:13:35.425584 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m15:13:35.426184 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m15:13:35.428382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42855f18-6342-4eb5-9853-d206eb1e8f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa8143e5b0>]}
[0m15:13:35.429459 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:35.430330 [debug] [MainThread]: On master: BEGIN
[0m15:13:35.431082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:35.433543 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:13:35.434461 [debug] [MainThread]: On master: COMMIT
[0m15:13:35.435363 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:35.436171 [debug] [MainThread]: On master: COMMIT
[0m15:13:35.437754 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:13:35.438650 [debug] [MainThread]: On master: Close
[0m15:13:35.442857 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m15:13:35.444133 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg__prices ............................ [RUN]
[0m15:13:35.445299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m15:13:35.446249 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m15:13:35.465426 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m15:13:35.466865 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m15:13:35.484343 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:13:35.486954 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__8ad1ffc943fd" cascade
    
[0m15:13:35.488784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:35.534338 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m15:13:35.627228 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:13:35.628162 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:13:35.631273 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:13:35.633341 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:13:35.634025 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m15:13:35.635916 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:13:35.636672 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:13:35.637407 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    
    
        create schema if not exists "crypto_database"."dbt_temp"
    
[0m15:13:35.671271 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m15:13:35.672957 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:13:35.673673 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    

  
[0m15:13:35.674522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:13:35.676118 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:13:35.676791 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:13:35.677354 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:13:35.710447 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m15:13:35.728648 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m15:13:35.730221 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:13:35.731143 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m15:13:35.733454 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:13:35.734091 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:13:35.734723 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
    
    

    create  table
      "crypto_database"."main"."stg__prices__dbt_tmp"
  
    as (
      /*
 old code before incremented it
with source as (
    select * from "crypto_database"."crypto_raw"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h as daily_change,
        
        -- The fix you made for the timestamp
        now() as ingested_at
    from source
)

select * from renamed

*/



WITH raw_data AS (
    SELECT *
    FROM "crypto_database"."crypto_raw"."raw_prices"
)

SELECT
    -- Creating a composite unique key is safer if you track multiple coins
    md5(cast(coalesce(cast(crypto_symbol as TEXT), '') || '-' || coalesce(cast(timestamp as TEXT), '') as TEXT)) as crypto_id_timestamp,
    crypto_symbol,
    price,
    md5(concat(crypto_symbol, timestamp)) as crypto_timestamp ,
    now() as ingested_at  -- Keep this to know when the record hit MotherDuck
FROM raw_data


    );
  
  
  
[0m15:13:35.773362 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
    
    

    create  table
      "crypto_database"."main"."stg__prices__dbt_tmp"
  
    as (
      /*
 old code before incremented it
with source as (
    select * from "crypto_database"."crypto_raw"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h as daily_change,
        
        -- The fix you made for the timestamp
        now() as ingested_at
    from source
)

select * from renamed

*/



WITH raw_data AS (
    SELECT *
    FROM "crypto_database"."crypto_raw"."raw_prices"
)

SELECT
    -- Creating a composite unique key is safer if you track multiple coins
    md5(cast(coalesce(cast(crypto_symbol as TEXT), '') || '-' || coalesce(cast(timestamp as TEXT), '') as TEXT)) as crypto_id_timestamp,
    crypto_symbol,
    price,
    md5(concat(crypto_symbol, timestamp)) as crypto_timestamp ,
    now() as ingested_at  -- Keep this to know when the record hit MotherDuck
FROM raw_data


    );
  
  
  
[0m15:13:35.774122 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:13:35.777926 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:13:35.778648 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__8ad1ffc943fd" cascade
    
[0m15:13:35.811950 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m15:13:35.814485 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: ROLLBACK
[0m15:13:35.825608 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_analytics.stg__prices'
[0m15:13:35.826413 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m15:13:35.833661 [debug] [Thread-1 (]: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Binder Error: Referenced column "crypto_symbol" not found in FROM clause!
  Candidate bindings: "total_volume", "current_price", "market_cap"
  
  LINE 43:     md5(cast(coalesce(cast(crypto_symbol as TEXT), '') || '-' || coalesce(cast(timestamp...
                                      ^
[0m15:13:35.835801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42855f18-6342-4eb5-9853-d206eb1e8f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa81461d90>]}
[0m15:13:35.836824 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.stg__prices ................... [[31mERROR[0m in 0.39s]
[0m15:13:35.837895 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m15:13:35.838876 [debug] [Thread-7 (]: Marking all children of 'model.crypto_analytics.stg__prices' to be skipped because of status 'error'.  Reason: Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Binder Error: Referenced column "crypto_symbol" not found in FROM clause!
  Candidate bindings: "total_volume", "current_price", "market_cap"
  
  LINE 43:     md5(cast(coalesce(cast(crypto_symbol as TEXT), '') || '-' || coalesce(cast(timestamp...
                                      ^.
[0m15:13:35.841922 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:35.842621 [debug] [MainThread]: On master: BEGIN
[0m15:13:35.843675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:35.846465 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m15:13:35.847348 [debug] [MainThread]: On master: COMMIT
[0m15:13:35.848145 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:35.848975 [debug] [MainThread]: On master: COMMIT
[0m15:13:35.850605 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:13:35.851458 [debug] [MainThread]: On master: Close
[0m15:13:35.852437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:35.853168 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m15:13:35.853970 [info ] [MainThread]: 
[0m15:13:35.854897 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 13.91 seconds (13.91s).
[0m15:13:35.857782 [debug] [MainThread]: Command end result
[0m15:13:35.963634 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:13:35.969787 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:13:35.986123 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m15:13:35.986917 [info ] [MainThread]: 
[0m15:13:35.988169 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:13:35.989881 [info ] [MainThread]: 
[0m15:13:35.991151 [error] [MainThread]: [31mFailure in model stg__prices (models/staging/stg__prices.sql)[0m
[0m15:13:35.992815 [error] [MainThread]:   Runtime Error in model stg__prices (models/staging/stg__prices.sql)
  Binder Error: Referenced column "crypto_symbol" not found in FROM clause!
  Candidate bindings: "total_volume", "current_price", "market_cap"
  
  LINE 43:     md5(cast(coalesce(cast(crypto_symbol as TEXT), '') || '-' || coalesce(cast(timestamp...
                                      ^
[0m15:13:35.994581 [info ] [MainThread]: 
[0m15:13:35.997298 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics/models/staging/stg__prices.sql
[0m15:13:35.998779 [info ] [MainThread]: 
[0m15:13:36.000393 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:13:36.003711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.65342, "process_in_blocks": "0", "process_kernel_time": 0.420175, "process_mem_max_rss": "195832", "process_out_blocks": "5784", "process_user_time": 4.956278}
[0m15:13:36.004904 [debug] [MainThread]: Command `dbt run` failed at 15:13:36.004650 after 15.65 seconds
[0m15:13:36.007035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa814e8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa81244ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfa81244f50>]}
[0m15:13:36.008252 [debug] [MainThread]: Flushing usage events
[0m15:13:36.716656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:42.522241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767da5e2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767dc015090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767d9617b10>]}


============================== 15:14:42.526467 | 4328abb6-5083-4492-a307-1376d2b2b9b3 ==============================
[0m15:14:42.526467 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:14:42.527780 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'write_json': 'True', 'warn_error': 'None', 'quiet': 'False', 'partial_parse': 'True', 'log_format': 'default', 'target_path': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'no_print': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m15:14:42.786565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4328abb6-5083-4492-a307-1376d2b2b9b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767da303490>]}
[0m15:14:42.806067 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-77_ioc1w'
[0m15:14:42.806886 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:14:43.022286 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:14:43.024318 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m15:14:43.136328 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m15:14:43.139163 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m15:14:43.139938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4328abb6-5083-4492-a307-1376d2b2b9b3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767d9251bf0>]}
[0m15:14:43.147259 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:14:43.256575 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:14:43.263736 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m15:14:43.346913 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m15:14:43.363146 [info ] [MainThread]: Updating lock file in file path: /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/package-lock.yml
[0m15:14:43.392387 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-t93gjqn6'
[0m15:14:43.407258 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m15:14:44.876743 [info ] [MainThread]: Installed from version 0.8.0
[0m15:14:44.877386 [info ] [MainThread]: Updated version available: 0.10.4
[0m15:14:44.878035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4328abb6-5083-4492-a307-1376d2b2b9b3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767d9262950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767d9262d50>]}
[0m15:14:44.878942 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:14:45.286569 [info ] [MainThread]: Installed from version 1.1.1
[0m15:14:45.287290 [info ] [MainThread]: Updated version available: 1.3.3
[0m15:14:45.287979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4328abb6-5083-4492-a307-1376d2b2b9b3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767d948a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767d923f5b0>]}
[0m15:14:45.288523 [info ] [MainThread]: Installing calogica/dbt_date
[0m15:14:45.644949 [info ] [MainThread]: Installed from version 0.7.2
[0m15:14:45.647316 [info ] [MainThread]: Updated version available: 0.10.1
[0m15:14:45.649704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4328abb6-5083-4492-a307-1376d2b2b9b3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767d9173e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767d93dfa10>]}
[0m15:14:45.652080 [info ] [MainThread]: 
[0m15:14:45.654616 [info ] [MainThread]: Updates available for packages: ['calogica/dbt_expectations', 'dbt-labs/dbt_utils', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m15:14:45.662889 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:14:45.667870 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.2530212, "process_in_blocks": "0", "process_kernel_time": 0.428559, "process_mem_max_rss": "114452", "process_out_blocks": "22584", "process_user_time": 3.4055}
[0m15:14:45.670708 [debug] [MainThread]: Command `dbt deps` succeeded at 15:14:45.670107 after 3.26 seconds
[0m15:14:45.672954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767d927e0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767d927e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767d92d7bb0>]}
[0m15:14:45.675600 [debug] [MainThread]: Flushing usage events
[0m15:14:46.414444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:31.300528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf9485e2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf94a0651d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf947613d90>]}


============================== 15:15:31.305160 | 3a1821b9-a09d-4f99-b4cf-b570cb31bc73 ==============================
[0m15:15:31.305160 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:15:31.306085 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'warn_error': 'None', 'debug': 'False', 'quiet': 'False', 'printer_width': '80', 'use_colors': 'True', 'version_check': 'True', 'introspect': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'log_format': 'default', 'write_json': 'True', 'partial_parse': 'True', 'no_print': 'None', 'target_path': 'None'}
[0m15:15:31.692941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a1821b9-a09d-4f99-b4cf-b570cb31bc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf9482fb490>]}
[0m15:15:31.810658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a1821b9-a09d-4f99-b4cf-b570cb31bc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf9476c1480>]}
[0m15:15:31.812820 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:15:31.966525 [debug] [MainThread]: checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9, vars: {}, profile: , target: duck, version: 1.11.3
[0m15:15:32.112196 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:15:32.113866 [debug] [MainThread]: previous checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9, current checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6
[0m15:15:32.115064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a1821b9-a09d-4f99-b4cf-b570cb31bc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf9417b6150>]}
[0m15:15:34.911184 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_crypto_prices' in the 'models' section of file 'models/staging/__sources.yml'
[0m15:15:35.308369 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_crypto_symbol.557b2e9363' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:15:35.309246 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_crypto_timestamp.2224d82c9d' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:15:35.310248 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.unique_stg_crypto_prices_crypto_timestamp.e7619144f6' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:15:35.311272 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_price.b5a3d0d20b' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:15:35.507169 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m15:15:35.526658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a1821b9-a09d-4f99-b4cf-b570cb31bc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf9403033e0>]}
[0m15:15:35.782731 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:15:35.787071 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:15:35.838739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a1821b9-a09d-4f99-b4cf-b570cb31bc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf93bfe74d0>]}
[0m15:15:35.839566 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 805 macros
[0m15:15:35.843282 [info ] [MainThread]: 
[0m15:15:35.844033 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m15:15:35.845065 [info ] [MainThread]: 
[0m15:15:35.846510 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:15:35.849955 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m15:15:35.946740 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m15:15:35.947879 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m15:15:35.948793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:49.101332 [debug] [ThreadPool]: SQL status: OK in 13.152 seconds
[0m15:15:49.107626 [debug] [ThreadPool]: On list_crypto_database: Close
[0m15:15:49.110744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m15:15:49.113038 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m15:15:49.139178 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:15:49.140438 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:15:49.141444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:49.144701 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:15:49.148096 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:15:49.148872 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m15:15:49.150782 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:15:49.151524 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:15:49.152183 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m15:15:49.191719 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m15:15:49.196740 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:15:49.199541 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:15:49.201468 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:15:49.240186 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m15:15:49.242754 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m15:15:49.275799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m15:15:49.311577 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:15:49.314897 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m15:15:49.316868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:49.322029 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m15:15:49.324011 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:15:49.326058 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m15:15:49.356989 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m15:15:49.359121 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m15:15:49.360594 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m15:15:49.361412 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m15:15:49.363253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1821b9-a09d-4f99-b4cf-b570cb31bc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf93b47f040>]}
[0m15:15:49.364161 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:49.364934 [debug] [MainThread]: On master: BEGIN
[0m15:15:49.365832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:49.367709 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:15:49.368321 [debug] [MainThread]: On master: COMMIT
[0m15:15:49.368849 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:49.369349 [debug] [MainThread]: On master: COMMIT
[0m15:15:49.370372 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:15:49.370942 [debug] [MainThread]: On master: Close
[0m15:15:49.374108 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m15:15:49.374943 [info ] [Thread-1 (]: 1 of 2 START sql incremental model main.stg__prices ............................ [RUN]
[0m15:15:49.375708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m15:15:49.376715 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m15:15:49.391530 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m15:15:49.392443 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m15:15:49.406541 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.407700 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__34627e95ed36" cascade
    
[0m15:15:49.408826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:49.450084 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m15:15:49.530697 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.531560 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:15:49.533729 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:15:49.535591 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.536164 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m15:15:49.537636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:15:49.538253 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.538779 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    
    
        create schema if not exists "crypto_database"."dbt_temp"
    
[0m15:15:49.575506 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m15:15:49.576939 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.577673 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    

  
[0m15:15:49.578913 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:15:49.581510 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:15:49.582515 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.583098 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:15:49.617880 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m15:15:49.631956 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m15:15:49.633024 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.633639 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m15:15:49.635233 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:15:49.635878 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.636491 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

  
    
    

    create  table
      "crypto_database"."main"."stg__prices__dbt_tmp"
  
    as (
      /*
 old code before incremented it
with source as (
    select * from "crypto_database"."crypto_raw"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h as daily_change,
        
        -- The fix you made for the timestamp
        now() as ingested_at
    from source
)

select * from renamed

*/



WITH raw_data AS (
    SELECT *
    FROM "crypto_database"."crypto_raw"."raw_prices"
)

SELECT
    -- Use a surrogate key using existing columns
    md5(concat(cast(id as text), '-', cast(symbol as text))) as crypto_id_timestamp,
    id as coin_id,
    symbol as crypto_symbol,
    current_price as price_usd,
    market_cap,
    price_change_percentage_24h as daily_change,
    now() as ingested_at
FROM raw_data


    );
  
  
  
[0m15:15:49.693785 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m15:15:49.704677 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.705836 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg__prices'
  
[0m15:15:49.708652 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:15:49.711752 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.712838 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg__prices'
  
[0m15:15:49.718125 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:15:49.732512 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.733618 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */
alter view "crypto_database"."main"."stg__prices" rename to "stg__prices__dbt_backup"
[0m15:15:49.778124 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m15:15:49.785935 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.787067 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */
alter table "crypto_database"."main"."stg__prices__dbt_tmp" rename to "stg__prices"
[0m15:15:49.833944 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m15:15:49.869304 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:15:49.870030 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.870678 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:15:49.953528 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m15:15:49.957728 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:49.958561 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__34627e95ed36" cascade
    
[0m15:15:49.998776 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m15:15:50.007875 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:50.009310 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop view if exists "crypto_database"."main"."stg__prices__dbt_backup" cascade
    
[0m15:15:50.086599 [debug] [Thread-1 (]: SQL status: OK in 0.076 seconds
[0m15:15:50.090676 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:15:50.091320 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__34627e95ed36" cascade
    
[0m15:15:50.131346 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m15:15:50.137695 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m15:15:50.141086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1821b9-a09d-4f99-b4cf-b570cb31bc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf93b2d0890>]}
[0m15:15:50.142587 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model main.stg__prices ....................... [[32mOK[0m in 0.76s]
[0m15:15:50.144320 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m15:15:50.146562 [debug] [Thread-2 (]: Began running node test.crypto_analytics.assert_prices_are_not_negative
[0m15:15:50.147552 [info ] [Thread-2 (]: 2 of 2 START test assert_prices_are_not_negative ............................... [RUN]
[0m15:15:50.149139 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.crypto_analytics.assert_prices_are_not_negative'
[0m15:15:50.150740 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.assert_prices_are_not_negative
[0m15:15:50.156810 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:15:50.157801 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.assert_prices_are_not_negative
[0m15:15:50.195555 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:15:50.196954 [debug] [Thread-2 (]: Using duckdb connection "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:15:50.197896 [debug] [Thread-2 (]: On test.crypto_analytics.assert_prices_are_not_negative: BEGIN
[0m15:15:50.198794 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:15:50.202301 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:15:50.203481 [debug] [Thread-2 (]: Using duckdb connection "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:15:50.204442 [debug] [Thread-2 (]: On test.crypto_analytics.assert_prices_are_not_negative: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.assert_prices_are_not_negative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    coin_id,
    usd_price
from "crypto_database"."main"."stg__prices"
where usd_price < 0
  
  
      
    ) dbt_internal_test
[0m15:15:50.240632 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.assert_prices_are_not_negative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    coin_id,
    usd_price
from "crypto_database"."main"."stg__prices"
where usd_price < 0
  
  
      
    ) dbt_internal_test
[0m15:15:50.241636 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m15:15:50.242744 [debug] [Thread-2 (]: On test.crypto_analytics.assert_prices_are_not_negative: ROLLBACK
[0m15:15:50.253576 [debug] [Thread-2 (]: Failed to rollback 'test.crypto_analytics.assert_prices_are_not_negative'
[0m15:15:50.255056 [debug] [Thread-2 (]: On test.crypto_analytics.assert_prices_are_not_negative: Close
[0m15:15:50.263509 [debug] [Thread-2 (]: Runtime Error in test assert_prices_are_not_negative (tests/assert_prices_are_not_negative.sql)
  Binder Error: Referenced column "usd_price" not found in FROM clause!
  Candidate bindings: "crypto_id_timestamp", "daily_change", "coin_id"
  
  LINE 14: where usd_price < 0
                 ^
[0m15:15:50.264562 [error] [Thread-2 (]: 2 of 2 ERROR assert_prices_are_not_negative .................................... [[31mERROR[0m in 0.12s]
[0m15:15:50.265743 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.assert_prices_are_not_negative
[0m15:15:50.267024 [debug] [Thread-7 (]: Marking all children of 'test.crypto_analytics.assert_prices_are_not_negative' to be skipped because of status 'error'.  Reason: Runtime Error in test assert_prices_are_not_negative (tests/assert_prices_are_not_negative.sql)
  Binder Error: Referenced column "usd_price" not found in FROM clause!
  Candidate bindings: "crypto_id_timestamp", "daily_change", "coin_id"
  
  LINE 14: where usd_price < 0
                 ^.
[0m15:15:50.269784 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:50.270767 [debug] [MainThread]: On master: BEGIN
[0m15:15:50.271599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:50.273311 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:15:50.273933 [debug] [MainThread]: On master: COMMIT
[0m15:15:50.274533 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:50.275006 [debug] [MainThread]: On master: COMMIT
[0m15:15:50.276146 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:15:50.276722 [debug] [MainThread]: On master: Close
[0m15:15:50.277675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:50.278764 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m15:15:50.279665 [debug] [MainThread]: Connection 'test.crypto_analytics.assert_prices_are_not_negative' was properly closed.
[0m15:15:50.280461 [info ] [MainThread]: 
[0m15:15:50.281042 [info ] [MainThread]: Finished running 1 incremental model, 1 test in 0 hours 0 minutes and 14.43 seconds (14.43s).
[0m15:15:50.282902 [debug] [MainThread]: Command end result
[0m15:15:50.351057 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:15:50.354404 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:15:50.364419 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m15:15:50.365154 [info ] [MainThread]: 
[0m15:15:50.366098 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:15:50.367032 [info ] [MainThread]: 
[0m15:15:50.368315 [error] [MainThread]: [31mFailure in test assert_prices_are_not_negative (tests/assert_prices_are_not_negative.sql)[0m
[0m15:15:50.369610 [error] [MainThread]:   Runtime Error in test assert_prices_are_not_negative (tests/assert_prices_are_not_negative.sql)
  Binder Error: Referenced column "usd_price" not found in FROM clause!
  Candidate bindings: "crypto_id_timestamp", "daily_change", "coin_id"
  
  LINE 14: where usd_price < 0
                 ^
[0m15:15:50.370745 [info ] [MainThread]: 
[0m15:15:50.372146 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics/tests/assert_prices_are_not_negative.sql
[0m15:15:50.373816 [info ] [MainThread]: 
[0m15:15:50.374980 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m15:15:50.377181 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 19.174692, "process_in_blocks": "2984", "process_kernel_time": 0.529419, "process_mem_max_rss": "205696", "process_out_blocks": "5416", "process_user_time": 8.341095}
[0m15:15:50.378484 [debug] [MainThread]: Command `cli build` failed at 15:15:50.378230 after 19.18 seconds
[0m15:15:50.379520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf93b358aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf93b2ba530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf93b2ba710>]}
[0m15:15:50.380814 [debug] [MainThread]: Flushing usage events
[0m15:15:51.229922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:49.716019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70de889daa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70de8a485090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70de87a0fb10>]}


============================== 15:17:49.720135 | fa445fea-e5ee-47d2-af71-e26eb8067c4c ==============================
[0m15:17:49.720135 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:17:49.721335 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'False', 'printer_width': '80', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'log_format': 'default', 'fail_fast': 'False', 'static_parser': 'True', 'no_print': 'None', 'profiles_dir': '/home/bihitche/.dbt', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'write_json': 'True'}
[0m15:17:50.137996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa445fea-e5ee-47d2-af71-e26eb8067c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70de886f7820>]}
[0m15:17:50.269673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa445fea-e5ee-47d2-af71-e26eb8067c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70de87abd480>]}
[0m15:17:50.271960 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:17:50.484450 [debug] [MainThread]: checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9, vars: {}, profile: , target: duck, version: 1.11.3
[0m15:17:50.690558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:50.691414 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://tests/assert_prices_are_not_negative.sql
[0m15:17:51.098995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa445fea-e5ee-47d2-af71-e26eb8067c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70de81baad50>]}
[0m15:17:51.338166 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:17:51.342419 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:17:51.389938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa445fea-e5ee-47d2-af71-e26eb8067c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70de81b77d40>]}
[0m15:17:51.391034 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 805 macros
[0m15:17:51.394589 [info ] [MainThread]: 
[0m15:17:51.395406 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m15:17:51.396693 [info ] [MainThread]: 
[0m15:17:51.398901 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:17:51.410932 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database_main'
[0m15:17:51.502609 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:17:51.504064 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m15:17:51.506037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:04.545249 [debug] [ThreadPool]: SQL status: OK in 13.039 seconds
[0m15:18:04.545966 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:18:04.546707 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m15:18:04.581554 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m15:18:04.583690 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m15:18:04.585082 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m15:18:04.585744 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m15:18:04.588255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa445fea-e5ee-47d2-af71-e26eb8067c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70de8779b150>]}
[0m15:18:04.589447 [debug] [MainThread]: Using duckdb connection "master"
[0m15:18:04.590338 [debug] [MainThread]: On master: BEGIN
[0m15:18:04.591122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:04.593594 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:18:04.594510 [debug] [MainThread]: On master: COMMIT
[0m15:18:04.595438 [debug] [MainThread]: Using duckdb connection "master"
[0m15:18:04.596349 [debug] [MainThread]: On master: COMMIT
[0m15:18:04.597991 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:18:04.598937 [debug] [MainThread]: On master: Close
[0m15:18:04.603000 [debug] [Thread-1 (]: Began running node test.crypto_analytics.assert_prices_are_not_negative
[0m15:18:04.604068 [info ] [Thread-1 (]: 1 of 1 START test assert_prices_are_not_negative ............................... [RUN]
[0m15:18:04.605850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now test.crypto_analytics.assert_prices_are_not_negative)
[0m15:18:04.606913 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.assert_prices_are_not_negative
[0m15:18:04.630545 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:18:04.637504 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.assert_prices_are_not_negative
[0m15:18:04.689613 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:18:04.691679 [debug] [Thread-1 (]: Using duckdb connection "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:18:04.693412 [debug] [Thread-1 (]: On test.crypto_analytics.assert_prices_are_not_negative: BEGIN
[0m15:18:04.695939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:04.700554 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:18:04.701775 [debug] [Thread-1 (]: Using duckdb connection "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:18:04.703034 [debug] [Thread-1 (]: On test.crypto_analytics.assert_prices_are_not_negative: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.assert_prices_are_not_negative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    coin_id,
    usd_price
from "crypto_database"."main"."stg__prices"
where price_usd < 0
  
  
      
    ) dbt_internal_test
[0m15:18:04.743766 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.assert_prices_are_not_negative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    coin_id,
    usd_price
from "crypto_database"."main"."stg__prices"
where price_usd < 0
  
  
      
    ) dbt_internal_test
[0m15:18:04.745446 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:18:04.746939 [debug] [Thread-1 (]: On test.crypto_analytics.assert_prices_are_not_negative: ROLLBACK
[0m15:18:04.758439 [debug] [Thread-1 (]: Failed to rollback 'test.crypto_analytics.assert_prices_are_not_negative'
[0m15:18:04.759978 [debug] [Thread-1 (]: On test.crypto_analytics.assert_prices_are_not_negative: Close
[0m15:18:04.770046 [debug] [Thread-1 (]: Runtime Error in test assert_prices_are_not_negative (tests/assert_prices_are_not_negative.sql)
  Binder Error: Referenced column "usd_price" not found in FROM clause!
  Candidate bindings: "crypto_id_timestamp", "daily_change", "coin_id"
  
  LINE 12:     usd_price
               ^
[0m15:18:04.771698 [error] [Thread-1 (]: 1 of 1 ERROR assert_prices_are_not_negative .................................... [[31mERROR[0m in 0.17s]
[0m15:18:04.773748 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.assert_prices_are_not_negative
[0m15:18:04.775615 [debug] [Thread-7 (]: Marking all children of 'test.crypto_analytics.assert_prices_are_not_negative' to be skipped because of status 'error'.  Reason: Runtime Error in test assert_prices_are_not_negative (tests/assert_prices_are_not_negative.sql)
  Binder Error: Referenced column "usd_price" not found in FROM clause!
  Candidate bindings: "crypto_id_timestamp", "daily_change", "coin_id"
  
  LINE 12:     usd_price
               ^.
[0m15:18:04.779590 [debug] [MainThread]: Using duckdb connection "master"
[0m15:18:04.780666 [debug] [MainThread]: On master: BEGIN
[0m15:18:04.783226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:04.786793 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m15:18:04.787962 [debug] [MainThread]: On master: COMMIT
[0m15:18:04.789535 [debug] [MainThread]: Using duckdb connection "master"
[0m15:18:04.790479 [debug] [MainThread]: On master: COMMIT
[0m15:18:04.792366 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:18:04.793311 [debug] [MainThread]: On master: Close
[0m15:18:04.794364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:04.795192 [debug] [MainThread]: Connection 'test.crypto_analytics.assert_prices_are_not_negative' was properly closed.
[0m15:18:04.796241 [info ] [MainThread]: 
[0m15:18:04.797908 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 13.40 seconds (13.40s).
[0m15:18:04.800227 [debug] [MainThread]: Command end result
[0m15:18:04.942649 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:18:04.948011 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:18:04.959028 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m15:18:04.959860 [info ] [MainThread]: 
[0m15:18:04.960781 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:18:04.961721 [info ] [MainThread]: 
[0m15:18:04.962859 [error] [MainThread]: [31mFailure in test assert_prices_are_not_negative (tests/assert_prices_are_not_negative.sql)[0m
[0m15:18:04.963941 [error] [MainThread]:   Runtime Error in test assert_prices_are_not_negative (tests/assert_prices_are_not_negative.sql)
  Binder Error: Referenced column "usd_price" not found in FROM clause!
  Candidate bindings: "crypto_id_timestamp", "daily_change", "coin_id"
  
  LINE 12:     usd_price
               ^
[0m15:18:04.964718 [info ] [MainThread]: 
[0m15:18:04.965645 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics/tests/assert_prices_are_not_negative.sql
[0m15:18:04.966602 [info ] [MainThread]: 
[0m15:18:04.967478 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:18:04.969572 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 15.3508625, "process_in_blocks": "0", "process_kernel_time": 0.439875, "process_mem_max_rss": "192692", "process_out_blocks": "5352", "process_user_time": 4.906301}
[0m15:18:04.970774 [debug] [MainThread]: Command `cli build` failed at 15:18:04.970573 after 15.35 seconds
[0m15:18:04.971717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70de804edbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70de87831c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70de80084650>]}
[0m15:18:04.972694 [debug] [MainThread]: Flushing usage events
[0m15:18:05.708556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:26.894820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e9dc2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3eb881090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e8df7b10>]}


============================== 15:18:26.898974 | 87c51c3f-0b1e-4387-a58c-d68e2d44792f ==============================
[0m15:18:26.898974 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:18:26.900138 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select stg__prices', 'cache_selected_only': 'False', 'no_print': 'None', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'quiet': 'False', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'profiles_dir': '/home/bihitche/.dbt', 'fail_fast': 'False', 'log_format': 'default', 'partial_parse': 'True', 'write_json': 'True'}
[0m15:18:27.283476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87c51c3f-0b1e-4387-a58c-d68e2d44792f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e9ae3490>]}
[0m15:18:27.392783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87c51c3f-0b1e-4387-a58c-d68e2d44792f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e8ea96a0>]}
[0m15:18:27.394898 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:18:27.554667 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m15:18:27.690060 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:18:27.690838 [debug] [MainThread]: previous checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, current checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9
[0m15:18:27.691430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '87c51c3f-0b1e-4387-a58c-d68e2d44792f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e2fa9f50>]}
[0m15:18:30.401783 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_crypto_prices' in the 'models' section of file 'models/staging/__sources.yml'
[0m15:18:30.852221 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_crypto_symbol.557b2e9363' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:18:30.853075 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_crypto_timestamp.2224d82c9d' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:18:30.853934 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.unique_stg_crypto_prices_crypto_timestamp.e7619144f6' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:18:30.854834 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_price.b5a3d0d20b' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:18:31.074654 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m15:18:31.094532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87c51c3f-0b1e-4387-a58c-d68e2d44792f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e1b0f200>]}
[0m15:18:31.458769 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:18:31.463128 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:18:31.487922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87c51c3f-0b1e-4387-a58c-d68e2d44792f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e1a8f3f0>]}
[0m15:18:31.488950 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 805 macros
[0m15:18:31.490004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87c51c3f-0b1e-4387-a58c-d68e2d44792f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e183add0>]}
[0m15:18:31.493393 [info ] [MainThread]: 
[0m15:18:31.494036 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m15:18:31.494673 [info ] [MainThread]: 
[0m15:18:31.495781 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:18:31.497409 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m15:18:31.571583 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m15:18:31.572477 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m15:18:31.573462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:46.602671 [debug] [ThreadPool]: SQL status: OK in 15.029 seconds
[0m15:18:46.605355 [debug] [ThreadPool]: On list_crypto_database: Close
[0m15:18:46.606746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m15:18:46.607746 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m15:18:46.618649 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:18:46.619458 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:18:46.620135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:46.622600 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:18:46.624709 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:18:46.625317 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m15:18:46.626769 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:18:46.627348 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:18:46.627850 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m15:18:46.662914 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m15:18:46.664341 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:18:46.664936 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:18:46.665498 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:18:46.700435 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m15:18:46.703161 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m15:18:46.728891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m15:18:46.745841 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:18:46.746852 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m15:18:46.747776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:46.750721 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:18:46.751760 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:18:46.752774 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m15:18:46.780549 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m15:18:46.782454 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m15:18:46.783657 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m15:18:46.784153 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m15:18:46.785939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87c51c3f-0b1e-4387-a58c-d68e2d44792f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e18f1190>]}
[0m15:18:46.786588 [debug] [MainThread]: Using duckdb connection "master"
[0m15:18:46.787031 [debug] [MainThread]: On master: BEGIN
[0m15:18:46.787492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:46.789080 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:18:46.789628 [debug] [MainThread]: On master: COMMIT
[0m15:18:46.790062 [debug] [MainThread]: Using duckdb connection "master"
[0m15:18:46.790493 [debug] [MainThread]: On master: COMMIT
[0m15:18:46.791452 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:18:46.791946 [debug] [MainThread]: On master: Close
[0m15:18:46.795022 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m15:18:46.795838 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg__prices ............................ [RUN]
[0m15:18:46.796576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m15:18:46.797254 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m15:18:46.810407 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m15:18:46.811522 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m15:18:46.824863 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:46.825790 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__af6837f6ab0f" cascade
    
[0m15:18:46.826615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:46.866558 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m15:18:46.935125 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:46.936500 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:18:46.939976 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:18:46.943129 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:46.944154 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m15:18:46.946714 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:18:46.947694 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:46.948639 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    
    
        create schema if not exists "crypto_database"."dbt_temp"
    
[0m15:18:46.984846 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m15:18:46.987425 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:46.988553 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    

  
[0m15:18:46.989922 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:18:46.992747 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:18:46.993995 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:46.995081 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:18:47.031087 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m15:18:47.046917 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:47.047695 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    
  
    
    

    create  table
      "crypto_database"."dbt_temp"."stg__prices__af6837f6ab0f"
  
    as (
      /*
 old code before incremented it
with source as (
    select * from "crypto_database"."crypto_raw"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h as daily_change,
        
        -- The fix you made for the timestamp
        now() as ingested_at
    from source
)

select * from renamed

*/



WITH raw_data AS (
    SELECT *
    FROM "crypto_database"."crypto_raw"."raw_prices"
)

SELECT
    -- Use a surrogate key using existing columns
    md5(concat(cast(id as text), '-', cast(symbol as text))) as crypto_id_timestamp,
    id as coin_id,
    symbol as crypto_symbol,
    current_price as price_usd,
    market_cap,
    price_change_percentage_24h as daily_change,
    now() as ingested_at
FROM raw_data


    -- Only process new rows
    WHERE now() > (SELECT MAX(ingested_at) FROM "crypto_database"."main"."stg__prices")

    );
  
  
  
[0m15:18:47.149699 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m15:18:47.162061 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:47.162665 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m15:18:47.164212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:18:47.164811 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:47.165599 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__prices__af6837f6ab0f'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'crypto_database'
      
      order by ordinal_position

  
[0m15:18:47.180788 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m15:18:47.189953 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:47.190770 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__prices'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'crypto_database'
      
      order by ordinal_position

  
[0m15:18:47.200181 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:18:47.217468 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:47.218591 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__prices'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'crypto_database'
      
      order by ordinal_position

  
[0m15:18:47.232610 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m15:18:47.237741 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:47.239306 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */
SELECT version()
[0m15:18:47.242492 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:18:47.280942 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m15:18:47.282850 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:47.284340 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

        
            delete from "crypto_database"."main"."stg__prices"
            where (
                crypto_id_timestamp) in (
                select (crypto_id_timestamp)
                from "crypto_database"."dbt_temp"."stg__prices__af6837f6ab0f"
            );

        
    

    insert into "crypto_database"."main"."stg__prices" ("crypto_id_timestamp", "coin_id", "crypto_symbol", "price_usd", "market_cap", "daily_change", "ingested_at")
    (
        select "crypto_id_timestamp", "coin_id", "crypto_symbol", "price_usd", "market_cap", "daily_change", "ingested_at"
        from "crypto_database"."dbt_temp"."stg__prices__af6837f6ab0f"
    )
  
[0m15:18:47.365811 [debug] [Thread-1 (]: SQL status: OK in 0.080 seconds
[0m15:18:47.386162 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:18:47.387312 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:47.388247 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:18:47.449553 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m15:18:47.454675 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:47.455626 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__af6837f6ab0f" cascade
    
[0m15:18:47.539028 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m15:18:47.543592 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:18:47.544441 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__af6837f6ab0f" cascade
    
[0m15:18:47.581467 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m15:18:47.588185 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m15:18:47.592121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c51c3f-0b1e-4387-a58c-d68e2d44792f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e0ed5b20>]}
[0m15:18:47.593696 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.stg__prices ....................... [[32mOK[0m in 0.79s]
[0m15:18:47.595745 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m15:18:47.598675 [debug] [MainThread]: Using duckdb connection "master"
[0m15:18:47.599597 [debug] [MainThread]: On master: BEGIN
[0m15:18:47.601097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:47.604057 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m15:18:47.604938 [debug] [MainThread]: On master: COMMIT
[0m15:18:47.605817 [debug] [MainThread]: Using duckdb connection "master"
[0m15:18:47.606892 [debug] [MainThread]: On master: COMMIT
[0m15:18:47.609048 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:18:47.610051 [debug] [MainThread]: On master: Close
[0m15:18:47.611066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:47.611866 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m15:18:47.612645 [info ] [MainThread]: 
[0m15:18:47.613934 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 16.12 seconds (16.12s).
[0m15:18:47.615937 [debug] [MainThread]: Command end result
[0m15:18:47.705079 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:18:47.709327 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:18:47.723598 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m15:18:47.724507 [info ] [MainThread]: 
[0m15:18:47.725874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:47.727263 [info ] [MainThread]: 
[0m15:18:47.728359 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:18:47.730356 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.925058, "process_in_blocks": "3048", "process_kernel_time": 0.458937, "process_mem_max_rss": "203756", "process_out_blocks": "5384", "process_user_time": 7.843838}
[0m15:18:47.731542 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:47.731351 after 20.93 seconds
[0m15:18:47.732772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e0de91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e0ebbad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a3e19edd50>]}
[0m15:18:47.733858 [debug] [MainThread]: Flushing usage events
[0m15:18:48.593343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:36.230630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7249560d2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724957b39090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724955107b10>]}


============================== 15:23:36.234751 | d18b0244-a391-4a6b-9cbf-76d6de070cac ==============================
[0m15:23:36.234751 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:23:36.236012 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'debug': 'False', 'introspect': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/bihitche/.dbt'}
[0m15:23:36.601071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd18b0244-a391-4a6b-9cbf-76d6de070cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724955df3490>]}
[0m15:23:36.723007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd18b0244-a391-4a6b-9cbf-76d6de070cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7249551b96a0>]}
[0m15:23:36.725065 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:23:36.881775 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m15:23:37.043783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:37.044391 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:23:37.044838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:37.051855 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m15:23:37.128125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd18b0244-a391-4a6b-9cbf-76d6de070cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72495501ea50>]}
[0m15:23:37.368142 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:23:37.370883 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:23:37.401306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd18b0244-a391-4a6b-9cbf-76d6de070cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72494e7559a0>]}
[0m15:23:37.401967 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 805 macros
[0m15:23:37.402572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd18b0244-a391-4a6b-9cbf-76d6de070cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72494e90b070>]}
[0m15:23:37.404972 [info ] [MainThread]: 
[0m15:23:37.405612 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m15:23:37.406178 [info ] [MainThread]: 
[0m15:23:37.406976 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:23:37.416084 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database_main'
[0m15:23:37.484492 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:23:37.485110 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m15:23:37.485943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:50.332435 [debug] [ThreadPool]: SQL status: OK in 12.846 seconds
[0m15:23:50.333069 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:23:50.333979 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m15:23:50.366985 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m15:23:50.370547 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m15:23:50.371899 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m15:23:50.372682 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m15:23:50.375035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd18b0244-a391-4a6b-9cbf-76d6de070cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72494dd98600>]}
[0m15:23:50.375892 [debug] [MainThread]: Using duckdb connection "master"
[0m15:23:50.376470 [debug] [MainThread]: On master: BEGIN
[0m15:23:50.377068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:50.379464 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:23:50.380093 [debug] [MainThread]: On master: COMMIT
[0m15:23:50.380924 [debug] [MainThread]: Using duckdb connection "master"
[0m15:23:50.381812 [debug] [MainThread]: On master: COMMIT
[0m15:23:50.383324 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:23:50.383965 [debug] [MainThread]: On master: Close
[0m15:23:50.387372 [debug] [Thread-3 (]: Began running node test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d
[0m15:23:50.388561 [debug] [Thread-1 (]: Began running node test.crypto_analytics.assert_prices_are_not_negative
[0m15:23:50.389488 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3
[0m15:23:50.392918 [info ] [Thread-2 (]: 2 of 3 START test not_null_coin_trends_symbol .................................. [RUN]
[0m15:23:50.390492 [info ] [Thread-3 (]: 3 of 3 START test unique_coin_trends_symbol .................................... [RUN]
[0m15:23:50.391779 [info ] [Thread-1 (]: 1 of 3 START test assert_prices_are_not_negative ............................... [RUN]
[0m15:23:50.396095 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d'
[0m15:23:50.394661 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3'
[0m15:23:50.397337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now test.crypto_analytics.assert_prices_are_not_negative)
[0m15:23:50.400811 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.assert_prices_are_not_negative
[0m15:23:50.398559 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d
[0m15:23:50.399801 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3
[0m15:23:50.428026 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:23:50.462526 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.assert_prices_are_not_negative
[0m15:23:50.460835 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"
[0m15:23:50.454168 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"
[0m15:23:50.471767 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3
[0m15:23:50.540455 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:23:50.545085 [debug] [Thread-1 (]: Using duckdb connection "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:23:50.541502 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d
[0m15:23:50.543626 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"
[0m15:23:50.556133 [debug] [Thread-2 (]: Using duckdb connection "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"
[0m15:23:50.546171 [debug] [Thread-1 (]: On test.crypto_analytics.assert_prices_are_not_negative: BEGIN
[0m15:23:50.560777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:50.552800 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"
[0m15:23:50.563135 [debug] [Thread-3 (]: Using duckdb connection "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"
[0m15:23:50.559412 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3: BEGIN
[0m15:23:50.580332 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:23:50.565891 [debug] [Thread-3 (]: On test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d: BEGIN
[0m15:23:50.583149 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:23:50.588006 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:23:50.592353 [debug] [Thread-3 (]: Using duckdb connection "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"
[0m15:23:50.593592 [debug] [Thread-3 (]: On test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    symbol as unique_field,
    count(*) as n_records

from "crypto_database"."main"."coin_trends"
where symbol is not null
group by symbol
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:23:50.589500 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m15:23:50.591351 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m15:23:50.596417 [debug] [Thread-2 (]: Using duckdb connection "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"
[0m15:23:50.594970 [debug] [Thread-1 (]: Using duckdb connection "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:23:50.597680 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_database"."main"."coin_trends"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m15:23:50.599216 [debug] [Thread-1 (]: On test.crypto_analytics.assert_prices_are_not_negative: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.assert_prices_are_not_negative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    coin_id,
    usd_price
from "crypto_database"."main"."stg__prices"
where price_usd < 0
  
  
      
    ) dbt_internal_test
[0m15:23:50.638891 [debug] [Thread-3 (]: SQL status: OK in 0.044 seconds
[0m15:23:50.642805 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.assert_prices_are_not_negative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    coin_id,
    usd_price
from "crypto_database"."main"."stg__prices"
where price_usd < 0
  
  
      
    ) dbt_internal_test
[0m15:23:50.661341 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:23:50.663863 [debug] [Thread-3 (]: On test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d: ROLLBACK
[0m15:23:50.665293 [debug] [Thread-1 (]: On test.crypto_analytics.assert_prices_are_not_negative: ROLLBACK
[0m15:23:50.666372 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m15:23:50.668105 [debug] [Thread-3 (]: Failed to rollback 'test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d'
[0m15:23:50.679908 [debug] [Thread-3 (]: On test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d: Close
[0m15:23:50.685416 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3: ROLLBACK
[0m15:23:50.689691 [debug] [Thread-2 (]: Failed to rollback 'test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3'
[0m15:23:50.682008 [info ] [Thread-3 (]: 3 of 3 PASS unique_coin_trends_symbol .......................................... [[32mPASS[0m in 0.29s]
[0m15:23:50.687723 [debug] [Thread-1 (]: Failed to rollback 'test.crypto_analytics.assert_prices_are_not_negative'
[0m15:23:50.694001 [debug] [Thread-1 (]: On test.crypto_analytics.assert_prices_are_not_negative: Close
[0m15:23:50.692834 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d
[0m15:23:50.690960 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3: Close
[0m15:23:50.707526 [debug] [Thread-1 (]: Runtime Error in test assert_prices_are_not_negative (tests/assert_prices_are_not_negative.sql)
  Binder Error: Referenced column "usd_price" not found in FROM clause!
  Candidate bindings: "crypto_id_timestamp", "daily_change", "coin_id"
  
  LINE 12:     usd_price
               ^
[0m15:23:50.700245 [info ] [Thread-2 (]: 2 of 3 PASS not_null_coin_trends_symbol ........................................ [[32mPASS[0m in 0.31s]
[0m15:23:50.709167 [error] [Thread-1 (]: 1 of 3 ERROR assert_prices_are_not_negative .................................... [[31mERROR[0m in 0.31s]
[0m15:23:50.710876 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3
[0m15:23:50.712500 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.assert_prices_are_not_negative
[0m15:23:50.715119 [debug] [Thread-7 (]: Marking all children of 'test.crypto_analytics.assert_prices_are_not_negative' to be skipped because of status 'error'.  Reason: Runtime Error in test assert_prices_are_not_negative (tests/assert_prices_are_not_negative.sql)
  Binder Error: Referenced column "usd_price" not found in FROM clause!
  Candidate bindings: "crypto_id_timestamp", "daily_change", "coin_id"
  
  LINE 12:     usd_price
               ^.
[0m15:23:50.719798 [debug] [MainThread]: Using duckdb connection "master"
[0m15:23:50.720626 [debug] [MainThread]: On master: BEGIN
[0m15:23:50.721621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:50.724479 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m15:23:50.725484 [debug] [MainThread]: On master: COMMIT
[0m15:23:50.726527 [debug] [MainThread]: Using duckdb connection "master"
[0m15:23:50.727317 [debug] [MainThread]: On master: COMMIT
[0m15:23:50.729136 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:23:50.730191 [debug] [MainThread]: On master: Close
[0m15:23:50.731518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:50.732580 [debug] [MainThread]: Connection 'test.crypto_analytics.assert_prices_are_not_negative' was properly closed.
[0m15:23:50.733564 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3' was properly closed.
[0m15:23:50.734532 [debug] [MainThread]: Connection 'test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d' was properly closed.
[0m15:23:50.735658 [info ] [MainThread]: 
[0m15:23:50.736583 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 13.33 seconds (13.33s).
[0m15:23:50.739191 [debug] [MainThread]: Command end result
[0m15:23:50.848883 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:23:50.852127 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:23:50.863439 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m15:23:50.864191 [info ] [MainThread]: 
[0m15:23:50.865304 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:23:50.866247 [info ] [MainThread]: 
[0m15:23:50.867311 [error] [MainThread]: [31mFailure in test assert_prices_are_not_negative (tests/assert_prices_are_not_negative.sql)[0m
[0m15:23:50.868553 [error] [MainThread]:   Runtime Error in test assert_prices_are_not_negative (tests/assert_prices_are_not_negative.sql)
  Binder Error: Referenced column "usd_price" not found in FROM clause!
  Candidate bindings: "crypto_id_timestamp", "daily_change", "coin_id"
  
  LINE 12:     usd_price
               ^
[0m15:23:50.870702 [info ] [MainThread]: 
[0m15:23:50.873552 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics/tests/assert_prices_are_not_negative.sql
[0m15:23:50.874722 [info ] [MainThread]: 
[0m15:23:50.875661 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m15:23:50.878031 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 14.740584, "process_in_blocks": "1120", "process_kernel_time": 0.508284, "process_mem_max_rss": "192744", "process_out_blocks": "3600", "process_user_time": 5.196013}
[0m15:23:50.879862 [debug] [MainThread]: Command `dbt test` failed at 15:23:50.879643 after 14.74 seconds
[0m15:23:50.880690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724955109cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72494e716200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72494e714260>]}
[0m15:23:50.882240 [debug] [MainThread]: Flushing usage events
[0m15:23:51.535105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:38.195503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd380e6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd39b61090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd37113b10>]}


============================== 15:24:38.203263 | 4b894083-5b1c-4376-b926-eeb746346254 ==============================
[0m15:24:38.203263 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:24:38.205365 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'quiet': 'False', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/home/bihitche/.dbt', 'static_parser': 'True', 'log_format': 'default', 'fail_fast': 'False', 'invocation_command': 'dbt ', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'empty': 'False'}
[0m15:24:38.866568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b894083-5b1c-4376-b926-eeb746346254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd37dfb5c0>]}
[0m15:24:39.071962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b894083-5b1c-4376-b926-eeb746346254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd371c1480>]}
[0m15:24:39.075077 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:24:39.363732 [debug] [MainThread]: checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9, vars: {}, profile: , target: duck, version: 1.11.3
[0m15:24:39.640848 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:24:39.641965 [debug] [MainThread]: previous checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9, current checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6
[0m15:24:39.643943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b894083-5b1c-4376-b926-eeb746346254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd30bae150>]}
[0m15:24:42.793012 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_crypto_prices' in the 'models' section of file 'models/staging/__sources.yml'
[0m15:24:43.173781 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_crypto_symbol.557b2e9363' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:24:43.174615 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_crypto_timestamp.2224d82c9d' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:24:43.175620 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.unique_stg_crypto_prices_crypto_timestamp.e7619144f6' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:24:43.176680 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_price.b5a3d0d20b' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:24:43.386872 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m15:24:43.412559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b894083-5b1c-4376-b926-eeb746346254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd307ff3e0>]}
[0m15:24:43.705464 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:24:43.709792 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:24:43.747808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b894083-5b1c-4376-b926-eeb746346254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd1ba3b4d0>]}
[0m15:24:43.749158 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 805 macros
[0m15:24:43.754149 [info ] [MainThread]: 
[0m15:24:43.755837 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m15:24:43.757396 [info ] [MainThread]: 
[0m15:24:43.759864 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:24:43.762137 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database'
[0m15:24:43.851809 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database"
[0m15:24:43.853599 [debug] [ThreadPool]: On list_crypto_database: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_database"'
    
  
  
[0m15:24:43.855014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:02.482999 [debug] [ThreadPool]: SQL status: OK in 18.628 seconds
[0m15:25:02.491791 [debug] [ThreadPool]: On list_crypto_database: Close
[0m15:25:02.496156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_database, now create_crypto_database_main)
[0m15:25:02.500173 [debug] [ThreadPool]: Creating schema "database: "crypto_database"
schema: "main"
"
[0m15:25:02.529559 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:25:02.530862 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:25:02.532085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:02.535685 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:25:02.538977 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:25:02.540047 [debug] [ThreadPool]: On create_crypto_database_main: BEGIN
[0m15:25:02.542463 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:25:02.543539 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:25:02.544540 [debug] [ThreadPool]: On create_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "create_crypto_database_main"} */

    
    
        create schema if not exists "crypto_database"."main"
    
[0m15:25:02.578690 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m15:25:02.580221 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:25:02.580842 [debug] [ThreadPool]: Using duckdb connection "create_crypto_database_main"
[0m15:25:02.581427 [debug] [ThreadPool]: On create_crypto_database_main: COMMIT
[0m15:25:02.614691 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m15:25:02.615383 [debug] [ThreadPool]: On create_crypto_database_main: Close
[0m15:25:02.623022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_database_main, now list_crypto_database_main)
[0m15:25:02.631011 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:25:02.631602 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m15:25:02.632091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:02.633872 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:25:02.634441 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:25:02.634946 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m15:25:02.659240 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m15:25:02.661465 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m15:25:02.663139 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m15:25:02.663808 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m15:25:02.666776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b894083-5b1c-4376-b926-eeb746346254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd1af8f040>]}
[0m15:25:02.668527 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:02.669549 [debug] [MainThread]: On master: BEGIN
[0m15:25:02.670114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:02.672102 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:25:02.672761 [debug] [MainThread]: On master: COMMIT
[0m15:25:02.673375 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:02.673946 [debug] [MainThread]: On master: COMMIT
[0m15:25:02.675600 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:25:02.676641 [debug] [MainThread]: On master: Close
[0m15:25:02.680827 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg__prices
[0m15:25:02.682312 [info ] [Thread-1 (]: 1 of 2 START sql incremental model main.stg__prices ............................ [RUN]
[0m15:25:02.683603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now model.crypto_analytics.stg__prices)
[0m15:25:02.684804 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg__prices
[0m15:25:02.703601 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg__prices"
[0m15:25:02.704941 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg__prices
[0m15:25:02.720049 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:02.720996 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__8960ef24fb91" cascade
    
[0m15:25:02.721958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:02.760803 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m15:25:02.859030 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:02.860224 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_database'
        and type='sqlite'
    
  
[0m15:25:02.863790 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:25:02.867773 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:02.869027 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m15:25:02.871917 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:25:02.873238 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:02.874417 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    
    
        create schema if not exists "crypto_database"."dbt_temp"
    
[0m15:25:02.908859 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m15:25:02.911400 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:02.912978 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    

  
[0m15:25:02.914691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:25:02.918410 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:25:02.919547 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:02.920649 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:25:02.952713 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m15:25:02.968331 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:02.969145 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

    
  
    
    

    create  table
      "crypto_database"."dbt_temp"."stg__prices__8960ef24fb91"
  
    as (
      /*
 old code before incremented it
with source as (
    select * from "crypto_database"."crypto_raw"."raw_prices"
),

renamed as (
    select
        id as coin_id,
        symbol,
        current_price as usd_price,
        market_cap,
        price_change_percentage_24h as daily_change,
        
        -- The fix you made for the timestamp
        now() as ingested_at
    from source
)

select * from renamed

*/



WITH raw_data AS (
    SELECT *
    FROM "crypto_database"."crypto_raw"."raw_prices"
)

SELECT
    -- Use a surrogate key using existing columns
    md5(concat(cast(id as text), '-', cast(symbol as text))) as crypto_id_timestamp,
    id as coin_id,
    symbol as crypto_symbol,
    current_price as price_usd,
    market_cap,
    price_change_percentage_24h as daily_change,
    now() as ingested_at
FROM raw_data


    -- Only process new rows
    WHERE now() > (SELECT MAX(ingested_at) FROM "crypto_database"."main"."stg__prices")

    );
  
  
  
[0m15:25:03.074376 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m15:25:03.126544 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:03.130343 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: BEGIN
[0m15:25:03.138687 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:25:03.141862 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:03.145164 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__prices__8960ef24fb91'
      
      and lower(table_schema) = 'dbt_temp'
      
      
      and lower(table_catalog) = 'crypto_database'
      
      order by ordinal_position

  
[0m15:25:03.173121 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m15:25:03.186266 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:03.187837 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__prices'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'crypto_database'
      
      order by ordinal_position

  
[0m15:25:03.195773 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:25:03.210299 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:03.210990 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg__prices'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'crypto_database'
      
      order by ordinal_position

  
[0m15:25:03.218129 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:25:03.220386 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:03.221095 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */
SELECT version()
[0m15:25:03.222994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:25:03.245190 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg__prices"
[0m15:25:03.246140 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:03.246914 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

        
            delete from "crypto_database"."main"."stg__prices"
            where (
                crypto_id_timestamp) in (
                select (crypto_id_timestamp)
                from "crypto_database"."dbt_temp"."stg__prices__8960ef24fb91"
            );

        
    

    insert into "crypto_database"."main"."stg__prices" ("crypto_id_timestamp", "coin_id", "crypto_symbol", "price_usd", "market_cap", "daily_change", "ingested_at")
    (
        select "crypto_id_timestamp", "coin_id", "crypto_symbol", "price_usd", "market_cap", "daily_change", "ingested_at"
        from "crypto_database"."dbt_temp"."stg__prices__8960ef24fb91"
    )
  
[0m15:25:03.324506 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m15:25:03.338917 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:25:03.339959 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:03.340671 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: COMMIT
[0m15:25:03.405442 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m15:25:03.408296 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:03.408873 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__8960ef24fb91" cascade
    
[0m15:25:03.488862 [debug] [Thread-1 (]: SQL status: OK in 0.079 seconds
[0m15:25:03.501768 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_analytics.stg__prices"
[0m15:25:03.503623 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "model.crypto_analytics.stg__prices"} */

      drop table if exists "crypto_database"."dbt_temp"."stg__prices__8960ef24fb91" cascade
    
[0m15:25:03.544852 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m15:25:03.548229 [debug] [Thread-1 (]: On model.crypto_analytics.stg__prices: Close
[0m15:25:03.550548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b894083-5b1c-4376-b926-eeb746346254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd1addc590>]}
[0m15:25:03.551727 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model main.stg__prices ....................... [[32mOK[0m in 0.87s]
[0m15:25:03.553061 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg__prices
[0m15:25:03.554713 [debug] [Thread-2 (]: Began running node test.crypto_analytics.assert_prices_are_not_negative
[0m15:25:03.555982 [info ] [Thread-2 (]: 2 of 2 START test assert_prices_are_not_negative ............................... [RUN]
[0m15:25:03.558117 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.crypto_analytics.assert_prices_are_not_negative'
[0m15:25:03.559745 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.assert_prices_are_not_negative
[0m15:25:03.564004 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:25:03.565432 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.assert_prices_are_not_negative
[0m15:25:03.605295 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:25:03.606770 [debug] [Thread-2 (]: Using duckdb connection "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:25:03.607775 [debug] [Thread-2 (]: On test.crypto_analytics.assert_prices_are_not_negative: BEGIN
[0m15:25:03.608752 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:25:03.611421 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:25:03.612443 [debug] [Thread-2 (]: Using duckdb connection "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:25:03.613771 [debug] [Thread-2 (]: On test.crypto_analytics.assert_prices_are_not_negative: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.assert_prices_are_not_negative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    coin_id,
    price_usd
from "crypto_database"."main"."stg__prices"
where price_usd < 0
  
  
      
    ) dbt_internal_test
[0m15:25:03.656867 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m15:25:03.663418 [debug] [Thread-2 (]: On test.crypto_analytics.assert_prices_are_not_negative: ROLLBACK
[0m15:25:03.664576 [debug] [Thread-2 (]: Failed to rollback 'test.crypto_analytics.assert_prices_are_not_negative'
[0m15:25:03.665706 [debug] [Thread-2 (]: On test.crypto_analytics.assert_prices_are_not_negative: Close
[0m15:25:03.667740 [info ] [Thread-2 (]: 2 of 2 PASS assert_prices_are_not_negative ..................................... [[32mPASS[0m in 0.11s]
[0m15:25:03.669168 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.assert_prices_are_not_negative
[0m15:25:03.672261 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:03.673512 [debug] [MainThread]: On master: BEGIN
[0m15:25:03.674884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:25:03.677470 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m15:25:03.678293 [debug] [MainThread]: On master: COMMIT
[0m15:25:03.679279 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:03.681692 [debug] [MainThread]: On master: COMMIT
[0m15:25:03.687144 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m15:25:03.688093 [debug] [MainThread]: On master: Close
[0m15:25:03.689155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:03.697040 [debug] [MainThread]: Connection 'model.crypto_analytics.stg__prices' was properly closed.
[0m15:25:03.700389 [debug] [MainThread]: Connection 'test.crypto_analytics.assert_prices_are_not_negative' was properly closed.
[0m15:25:03.707781 [info ] [MainThread]: 
[0m15:25:03.708774 [info ] [MainThread]: Finished running 1 incremental model, 1 test in 0 hours 0 minutes and 19.95 seconds (19.95s).
[0m15:25:03.722952 [debug] [MainThread]: Command end result
[0m15:25:04.005529 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:25:04.008902 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:25:04.020790 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m15:25:04.021634 [info ] [MainThread]: 
[0m15:25:04.022531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:04.023326 [info ] [MainThread]: 
[0m15:25:04.024231 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:25:04.026034 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 25.9994, "process_in_blocks": "384", "process_kernel_time": 0.588386, "process_mem_max_rss": "206156", "process_out_blocks": "5424", "process_user_time": 9.772197}
[0m15:25:04.027122 [debug] [MainThread]: Command `cli build` succeeded at 15:25:04.026903 after 26.00 seconds
[0m15:25:04.027980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd1ad18100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd180a20d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd180a3250>]}
[0m15:25:04.028888 [debug] [MainThread]: Flushing usage events
[0m15:25:05.012993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:22.557239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70789e8ceba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7078a038d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70789d903b10>]}


============================== 15:25:22.561868 | 7814cf65-d575-4562-8cf2-c3720966c2cb ==============================
[0m15:25:22.561868 [info ] [MainThread]: Running with dbt=1.11.3
[0m15:25:22.563049 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'profiles_dir': '/home/bihitche/.dbt', 'log_path': '/home/bihitche/Desktop/crypto_pipeline_sprint/analytics/logs', 'cache_selected_only': 'False', 'empty': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test', 'partial_parse': 'True', 'write_json': 'True'}
[0m15:25:23.030414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7814cf65-d575-4562-8cf2-c3720966c2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70789e5ef490>]}
[0m15:25:23.242624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7814cf65-d575-4562-8cf2-c3720966c2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70789d9b56a0>]}
[0m15:25:23.246033 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:25:23.444692 [debug] [MainThread]: checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, vars: {}, profile: , target: , version: 1.11.3
[0m15:25:23.629879 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:25:23.630865 [debug] [MainThread]: previous checksum: 97dbd983c77ef3cec7304d97135f72c53ee20ea7ab68d67bae8e0876ff0fcdb6, current checksum: ba0f3d264086af688758d829412b703940bf7602dd7485431960e36eb55b3cb9
[0m15:25:23.631831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7814cf65-d575-4562-8cf2-c3720966c2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7078973b6050>]}
[0m15:25:26.895333 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_crypto_prices' in the 'models' section of file 'models/staging/__sources.yml'
[0m15:25:27.324222 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_crypto_symbol.557b2e9363' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:25:27.325128 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_crypto_timestamp.2224d82c9d' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:25:27.326002 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.unique_stg_crypto_prices_crypto_timestamp.e7619144f6' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:25:27.327067 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_analytics.not_null_stg_crypto_prices_price.b5a3d0d20b' (models/staging/__sources.yml) depends on a node named 'stg_crypto_prices' in package '' which was not found
[0m15:25:27.543562 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.crypto_analytics
[0m15:25:27.561719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7814cf65-d575-4562-8cf2-c3720966c2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707896617200>]}
[0m15:25:27.778274 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:25:27.782114 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:25:27.815001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7814cf65-d575-4562-8cf2-c3720966c2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7078963e3a10>]}
[0m15:25:27.816076 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 805 macros
[0m15:25:27.816914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7814cf65-d575-4562-8cf2-c3720966c2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707896275570>]}
[0m15:25:27.819834 [info ] [MainThread]: 
[0m15:25:27.820626 [info ] [MainThread]: Concurrency: 4 threads (target='duck')
[0m15:25:27.821376 [info ] [MainThread]: 
[0m15:25:27.822699 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:25:27.832525 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_database_main'
[0m15:25:27.921852 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:25:27.922636 [debug] [ThreadPool]: On list_crypto_database_main: BEGIN
[0m15:25:27.923522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:40.843500 [debug] [ThreadPool]: SQL status: OK in 12.920 seconds
[0m15:25:40.844089 [debug] [ThreadPool]: Using duckdb connection "list_crypto_database_main"
[0m15:25:40.844671 [debug] [ThreadPool]: On list_crypto_database_main: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "connection_name": "list_crypto_database_main"} */
select
      'crypto_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_database'
  
[0m15:25:40.874074 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m15:25:40.876004 [debug] [ThreadPool]: On list_crypto_database_main: ROLLBACK
[0m15:25:40.877252 [debug] [ThreadPool]: Failed to rollback 'list_crypto_database_main'
[0m15:25:40.877777 [debug] [ThreadPool]: On list_crypto_database_main: Close
[0m15:25:40.879583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7814cf65-d575-4562-8cf2-c3720966c2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7078963faf90>]}
[0m15:25:40.880323 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:40.880832 [debug] [MainThread]: On master: BEGIN
[0m15:25:40.881327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:40.883074 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:25:40.884019 [debug] [MainThread]: On master: COMMIT
[0m15:25:40.884616 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:40.885098 [debug] [MainThread]: On master: COMMIT
[0m15:25:40.886144 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:25:40.886721 [debug] [MainThread]: On master: Close
[0m15:25:40.889984 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3
[0m15:25:40.891084 [debug] [Thread-3 (]: Began running node test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d
[0m15:25:40.891784 [debug] [Thread-1 (]: Began running node test.crypto_analytics.assert_prices_are_not_negative
[0m15:25:40.892350 [info ] [Thread-2 (]: 2 of 3 START test not_null_coin_trends_symbol .................................. [RUN]
[0m15:25:40.893274 [info ] [Thread-3 (]: 3 of 3 START test unique_coin_trends_symbol .................................... [RUN]
[0m15:25:40.894337 [info ] [Thread-1 (]: 1 of 3 START test assert_prices_are_not_negative ............................... [RUN]
[0m15:25:40.895347 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3'
[0m15:25:40.896415 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d'
[0m15:25:40.897117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_database_main, now test.crypto_analytics.assert_prices_are_not_negative)
[0m15:25:40.897906 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3
[0m15:25:40.898754 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d
[0m15:25:40.899765 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.assert_prices_are_not_negative
[0m15:25:40.932177 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:25:40.949754 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.assert_prices_are_not_negative
[0m15:25:40.958785 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"
[0m15:25:40.964963 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d
[0m15:25:40.963658 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"
[0m15:25:40.980970 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3
[0m15:25:41.024949 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"
[0m15:25:41.026266 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:25:41.028613 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"
[0m15:25:41.029736 [debug] [Thread-1 (]: Using duckdb connection "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:25:41.030682 [debug] [Thread-3 (]: Using duckdb connection "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"
[0m15:25:41.031603 [debug] [Thread-1 (]: On test.crypto_analytics.assert_prices_are_not_negative: BEGIN
[0m15:25:41.032275 [debug] [Thread-2 (]: Using duckdb connection "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"
[0m15:25:41.033118 [debug] [Thread-3 (]: On test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d: BEGIN
[0m15:25:41.033702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:41.034292 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3: BEGIN
[0m15:25:41.034900 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:25:41.035889 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:25:41.037533 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:25:41.038498 [debug] [Thread-1 (]: Using duckdb connection "test.crypto_analytics.assert_prices_are_not_negative"
[0m15:25:41.039082 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:25:41.039763 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:25:41.040540 [debug] [Thread-1 (]: On test.crypto_analytics.assert_prices_are_not_negative: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.assert_prices_are_not_negative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select
    coin_id,
    price_usd
from "crypto_database"."main"."stg__prices"
where price_usd < 0
  
  
      
    ) dbt_internal_test
[0m15:25:41.041255 [debug] [Thread-2 (]: Using duckdb connection "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"
[0m15:25:41.041796 [debug] [Thread-3 (]: Using duckdb connection "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"
[0m15:25:41.042693 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from "crypto_database"."main"."coin_trends"
where symbol is null



  
  
      
    ) dbt_internal_test
[0m15:25:41.043579 [debug] [Thread-3 (]: On test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d: /* {"app": "dbt", "dbt_version": "1.11.3", "profile_name": "brahim", "target_name": "duck", "node_id": "test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    symbol as unique_field,
    count(*) as n_records

from "crypto_database"."main"."coin_trends"
where symbol is not null
group by symbol
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:25:41.077574 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m15:25:41.085876 [debug] [Thread-1 (]: On test.crypto_analytics.assert_prices_are_not_negative: ROLLBACK
[0m15:25:41.087227 [debug] [Thread-1 (]: Failed to rollback 'test.crypto_analytics.assert_prices_are_not_negative'
[0m15:25:41.088274 [debug] [Thread-3 (]: SQL status: OK in 0.043 seconds
[0m15:25:41.089174 [debug] [Thread-2 (]: SQL status: OK in 0.044 seconds
[0m15:25:41.089962 [debug] [Thread-1 (]: On test.crypto_analytics.assert_prices_are_not_negative: Close
[0m15:25:41.094287 [debug] [Thread-3 (]: On test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d: ROLLBACK
[0m15:25:41.097408 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3: ROLLBACK
[0m15:25:41.098950 [debug] [Thread-3 (]: Failed to rollback 'test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d'
[0m15:25:41.100161 [info ] [Thread-1 (]: 1 of 3 PASS assert_prices_are_not_negative ..................................... [[32mPASS[0m in 0.20s]
[0m15:25:41.101703 [debug] [Thread-2 (]: Failed to rollback 'test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3'
[0m15:25:41.102957 [debug] [Thread-3 (]: On test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d: Close
[0m15:25:41.104409 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.assert_prices_are_not_negative
[0m15:25:41.105769 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3: Close
[0m15:25:41.107967 [info ] [Thread-3 (]: 3 of 3 PASS unique_coin_trends_symbol .......................................... [[32mPASS[0m in 0.21s]
[0m15:25:41.109478 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d
[0m15:25:41.110752 [info ] [Thread-2 (]: 2 of 3 PASS not_null_coin_trends_symbol ........................................ [[32mPASS[0m in 0.22s]
[0m15:25:41.112186 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3
[0m15:25:41.115322 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:41.116232 [debug] [MainThread]: On master: BEGIN
[0m15:25:41.117046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:25:41.119478 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:25:41.120257 [debug] [MainThread]: On master: COMMIT
[0m15:25:41.120985 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:41.121856 [debug] [MainThread]: On master: COMMIT
[0m15:25:41.125790 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m15:25:41.126614 [debug] [MainThread]: On master: Close
[0m15:25:41.127509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:41.128175 [debug] [MainThread]: Connection 'test.crypto_analytics.assert_prices_are_not_negative' was properly closed.
[0m15:25:41.128816 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_coin_trends_symbol.a210310fa3' was properly closed.
[0m15:25:41.132491 [debug] [MainThread]: Connection 'test.crypto_analytics.unique_coin_trends_symbol.9d1ad4b33d' was properly closed.
[0m15:25:41.133429 [info ] [MainThread]: 
[0m15:25:41.134359 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 13.31 seconds (13.31s).
[0m15:25:41.137074 [debug] [MainThread]: Command end result
[0m15:25:41.226614 [debug] [MainThread]: Wrote artifact WritableManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/manifest.json
[0m15:25:41.229839 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/semantic_manifest.json
[0m15:25:41.242270 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/bihitche/Desktop/crypto_pipeline_sprint/analytics/target/run_results.json
[0m15:25:41.243040 [info ] [MainThread]: 
[0m15:25:41.244105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:41.244830 [info ] [MainThread]: 
[0m15:25:41.245595 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:25:41.247653 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 18.808178, "process_in_blocks": "0", "process_kernel_time": 0.496195, "process_mem_max_rss": "204064", "process_out_blocks": "5416", "process_user_time": 8.570282}
[0m15:25:41.249527 [debug] [MainThread]: Command `dbt test` succeeded at 15:25:41.248453 after 18.81 seconds
[0m15:25:41.250648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7078963df750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7078956cbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7078956cbf70>]}
[0m15:25:41.251513 [debug] [MainThread]: Flushing usage events
[0m15:25:42.186642 [debug] [MainThread]: An error was encountered while trying to flush usage events
